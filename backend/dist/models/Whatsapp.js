'use strict';const a2=b,a5=b;(function(c,d){const a0=b,a1=b,e=c();while(!![]){try{const f=-parseInt(a0(0xc5))/0x1*(-parseInt(a0(0xd0))/0x2)+-parseInt(a1(0xb5))/0x3+parseInt(a0(0xf0))/0x4+parseInt(a1(0x91))/0x5+-parseInt(a1(0xea))/0x6+parseInt(a0(0x8d))/0x7*(-parseInt(a0(0xed))/0x8)+-parseInt(a0(0x90))/0x9;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xe99a6));var __decorate=this&&this[a2(0x9e)]||function(e,f,g,h){const a3=a2,a4=a2;var j=arguments[a3(0xab)],k=j<0x3?f:h===null?h=Object['getOwnPropertyDescriptor'](f,g):h,l;if(typeof Reflect===a4(0xe0)&&typeof Reflect[a3(0x9d)]===a3(0xc9))k=Reflect[a3(0x9d)](e,f,g,h);else{for(var m=e['length']-0x1;m>=0x0;m--)if(l=e[m])k=(j<0x3?l(k):j>0x3?l(f,g,k):l(f,g))||k;}return j>0x3&&k&&Object[a4(0xc6)](f,g,k),k;},__metadata=this&&this[a5(0xe6)]||function(c,d){const a6=a5,a7=a5;if(typeof Reflect===a6(0xe0)&&typeof Reflect['metadata']===a6(0xc9))return Reflect[a6(0xc8)](c,d);},__importDefault=this&&this['__importDefault']||function(c){const a8=a2;return c&&c[a8(0xcf)]?c:{'default':c};};function b(c,d){const e=a();return b=function(f,g){f=f-0x8c;let h=e[f];return h;},b(c,d);}function a(){const ak=['360','now','chatFlowId','CreateTokenWebHook','BelongsTo','instagramKey','sign','instagramUser','JSONB','Default','WPQKN','length','TdHLl','AutoIncrement','queue_transf','urlServiceStatus','../libs/Queue','createdAt','WebHooksAPI','type','tenant','3680379noNUrk','authToken','status','updatedAt','PrimaryKey','./Tenant','farewellMessage','all','Column','10000d','getDataValue','whatsapp','fbObject','PfPPF','tickets','color','334171VAIgpE','defineProperty','/fb-messenger-hooks/','metadata','function','UrlMessengerWebHook','phone','name','BeforeCreate','/wabahooks/','__esModule','10Prwxqk','BACKEND_URL','VIRTUAL','plugged','ENUM','messenger','getstatus','ForeignKey','../config/webHooks.dev.json','../config/auth','session','Method\x20not\x20implemented.','HasMany','./Ticket','Unique','sequelize-typescript','object','Table','design:returntype','default','instagram','./ApiConfig','__metadata','TEXT','HookStatus','prototype','745080fKnMeM','tokenHook','wabaBSP','2168oHJaEn','design:type','chatFlow','5330656bzdpuL','urlWabahooks','AllowNull','7063CjCbLN','DataType','tenantId','8589816WyZDWP','2660775EEFSCi','gupshup','design:paramtypes','env','dev','is_open_ia','qrcode','UrlWabaWebHook','BeforeUpdate','battery','retries','CreatedAt','decorate','__decorate','number'];a=function(){return ak;};return a();}Object[a5(0xc6)](exports,a2(0xcf),{'value':!![]});const jsonwebtoken_1=require('jsonwebtoken'),sequelize_typescript_1=require(a2(0xdf)),webHooks_dev_json_1=__importDefault(require(a5(0xd8))),auth_1=__importDefault(require(a2(0xd9))),Queue_1=__importDefault(require(a2(0xb0))),ApiConfig_1=__importDefault(require(a5(0xe5))),Tenant_1=__importDefault(require(a2(0xba))),Ticket_1=__importDefault(require(a2(0xdd))),ChatFlow_1=__importDefault(require('./ChatFlow'));let Whatsapp=class Whatsapp extends sequelize_typescript_1['Model']{static[a5(0xd6)](){const a9=a2;throw new Error(a9(0xdb));}get[a2(0x98)](){const aa=a5,ab=a2,c=this[aa(0xbf)](aa(0xeb)),d=this['getDataValue']('wabaBSP');let e;return e=process[aa(0x94)][ab(0xd1)],process[aa(0x94)]['NODE_ENV']===ab(0x95)&&('TdHLl'!==aa(0xac)?e=f['default'][ab(0xf1)]:e=webHooks_dev_json_1[aa(0xe3)][ab(0xf1)]),e+aa(0xce)+d+'/'+c;}get[a5(0xca)](){const ac=a5,ad=a5,c=this[ac(0xbf)](ad(0xeb));let d;return d=process['env'][ad(0xd1)],process[ad(0x94)]['NODE_ENV']===ac(0x95)&&(ad(0xaa)!=='DufWs'?d=webHooks_dev_json_1[ad(0xe3)][ac(0xf1)]:e['authToken']=f['authToken']),d+ac(0xc7)+c;}static async[a5(0xe8)](c){const ae=a5,af=a5,{status:d,name:e,qrcode:f,number:g,tenantId:h,id:i}=c,j={'name':e,'number':g,'status':d,'qrcode':f,'timestamp':Date[ae(0xa1)](),'type':'hookSessionStatus'},k=await ApiConfig_1[ae(0xe3)]['findAll']({'where':{'tenantId':h,'sessionId':i}});if(!k)return;await Promise[af(0xbc)](k['map'](l=>{const ag=af,ah=af;if(l[ag(0xaf)])return l[ah(0xb6)]&&(j[ag(0xb6)]=l[ah(0xb6)]),Queue_1['default']['add'](ag(0xb2),{'url':l['urlServiceStatus'],'type':j['type'],'payload':j});}));}static async[a5(0xa3)](c){const ai=a2,aj=a5,{secret:d}=auth_1[ai(0xe3)];if(!c?.[ai(0xeb)]&&(c[aj(0xb3)]==='waba'||c[ai(0xb3)]===aj(0xd5))){if('vxxQA'!==ai(0xc2)){const e=(0x0,jsonwebtoken_1[aj(0xa6)])({'tenantId':c[aj(0x8f)],'whatsappId':c['id']},d,{'expiresIn':ai(0xbe)});c[aj(0xeb)]=e;}else{if(typeof h===ai(0xe0)&&typeof i['metadata']===ai(0xc9))return j[ai(0xc8)](k,l);}}}};__decorate([sequelize_typescript_1[a2(0xb9)],sequelize_typescript_1[a2(0xad)],sequelize_typescript_1['Column'],__metadata(a5(0xee),Number)],Whatsapp[a2(0xe9)],'id',void 0x0),__decorate([sequelize_typescript_1[a5(0x8c)],sequelize_typescript_1[a2(0xde)],(0x0,sequelize_typescript_1[a5(0xbd)])(sequelize_typescript_1[a5(0x8e)][a5(0xe7)]),__metadata(a5(0xee),String)],Whatsapp[a2(0xe9)],a5(0xcc),void 0x0),__decorate([(0x0,sequelize_typescript_1[a5(0xbd)])(sequelize_typescript_1[a2(0x8e)]['TEXT']),__metadata('design:type',String)],Whatsapp[a5(0xe9)],a5(0xda),void 0x0),__decorate([(0x0,sequelize_typescript_1[a2(0xbd)])(sequelize_typescript_1[a2(0x8e)][a5(0xe7)]),__metadata(a2(0xee),String)],Whatsapp[a2(0xe9)],a2(0x97),void 0x0),__decorate([sequelize_typescript_1[a2(0xbd)],__metadata(a5(0xee),String)],Whatsapp[a5(0xe9)],a2(0xb7),void 0x0),__decorate([sequelize_typescript_1['Column'],__metadata(a5(0xee),String)],Whatsapp[a5(0xe9)],a2(0x9a),void 0x0),__decorate([sequelize_typescript_1[a5(0xbd)],__metadata('design:type',Boolean)],Whatsapp[a2(0xe9)],a5(0xd3),void 0x0),__decorate([(0x0,sequelize_typescript_1[a2(0xa9)])(!![]),sequelize_typescript_1[a5(0xbd)],__metadata(a2(0xee),Boolean)],Whatsapp[a5(0xe9)],'isActive',void 0x0),__decorate([(0x0,sequelize_typescript_1[a2(0xa9)])(![]),sequelize_typescript_1[a2(0xbd)],__metadata(a2(0xee),Boolean)],Whatsapp[a5(0xe9)],'isDeleted',void 0x0),__decorate([sequelize_typescript_1[a5(0xbd)],__metadata(a2(0xee),Number)],Whatsapp[a5(0xe9)],a2(0x9b),void 0x0),__decorate([(0x0,sequelize_typescript_1[a5(0xa9)])(![]),sequelize_typescript_1[a5(0x8c)],sequelize_typescript_1[a2(0xbd)],__metadata(a5(0xee),Boolean)],Whatsapp[a5(0xe9)],'isDefault',void 0x0),__decorate([(0x0,sequelize_typescript_1[a5(0xa9)])(null),sequelize_typescript_1[a5(0x8c)],sequelize_typescript_1[a5(0xbd)],__metadata('design:type',String)],Whatsapp[a2(0xe9)],'tokenTelegram',void 0x0),__decorate([(0x0,sequelize_typescript_1['Default'])(null),sequelize_typescript_1['AllowNull'],sequelize_typescript_1[a5(0xbd)],__metadata('design:type',String)],Whatsapp['prototype'],a5(0xa7),void 0x0),__decorate([(0x0,sequelize_typescript_1[a2(0xa9)])(null),sequelize_typescript_1[a2(0x8c)],sequelize_typescript_1[a2(0xbd)],__metadata('design:type',String)],Whatsapp['prototype'],a5(0xa5),void 0x0),__decorate([(0x0,sequelize_typescript_1[a5(0xa9)])(null),sequelize_typescript_1[a5(0x8c)],sequelize_typescript_1[a5(0xbd)],__metadata(a2(0xee),String)],Whatsapp[a5(0xe9)],'fbPageId',void 0x0),__decorate([(0x0,sequelize_typescript_1[a2(0xa9)])(null),sequelize_typescript_1[a5(0x8c)],(0x0,sequelize_typescript_1[a2(0xbd)])(sequelize_typescript_1[a2(0x8e)][a2(0xa8)]),__metadata('design:type',Object)],Whatsapp[a5(0xe9)],a2(0xc1),void 0x0),__decorate([(0x0,sequelize_typescript_1[a5(0xa9)])(a2(0xc0)),(0x0,sequelize_typescript_1[a2(0xbd)])(sequelize_typescript_1[a5(0x8e)][a2(0xd4)](a5(0xc0),'telegram',a5(0xe4),a2(0xd5))),__metadata(a2(0xee),String)],Whatsapp[a5(0xe9)],'type',void 0x0),__decorate([sequelize_typescript_1[a5(0x9c)],__metadata(a2(0xee),Date)],Whatsapp[a2(0xe9)],a5(0xb1),void 0x0),__decorate([sequelize_typescript_1['UpdatedAt'],__metadata(a5(0xee),Date)],Whatsapp[a2(0xe9)],a2(0xb8),void 0x0),__decorate([sequelize_typescript_1[a2(0xbd)],__metadata(a2(0xee),Boolean)],Whatsapp[a5(0xe9)],a5(0x96),void 0x0),__decorate([sequelize_typescript_1['Column'],__metadata(a5(0xee),Number)],Whatsapp[a5(0xe9)],a5(0xae),void 0x0),__decorate([sequelize_typescript_1[a2(0xbd)],__metadata(a5(0xee),String)],Whatsapp[a5(0xe9)],a5(0xc4),void 0x0),__decorate([sequelize_typescript_1[a5(0xbd)],__metadata(a5(0xee),String)],Whatsapp[a5(0xe9)],a2(0x9f),void 0x0),__decorate([(0x0,sequelize_typescript_1[a5(0xbd)])(sequelize_typescript_1[a5(0x8e)][a2(0xa8)]),__metadata(a5(0xee),Object)],Whatsapp[a5(0xe9)],a2(0xcb),void 0x0),__decorate([(0x0,sequelize_typescript_1[a2(0xdc)])(()=>Ticket_1[a5(0xe3)]),__metadata(a2(0xee),Array)],Whatsapp[a2(0xe9)],a5(0xc3),void 0x0),__decorate([(0x0,sequelize_typescript_1[a2(0xd7)])(()=>Tenant_1['default']),sequelize_typescript_1['Column'],__metadata(a5(0xee),Number)],Whatsapp['prototype'],a2(0x8f),void 0x0),__decorate([(0x0,sequelize_typescript_1[a2(0xa4)])(()=>Tenant_1['default']),__metadata(a2(0xee),Tenant_1['default'])],Whatsapp[a5(0xe9)],a2(0xb4),void 0x0),__decorate([(0x0,sequelize_typescript_1[a5(0xd7)])(()=>ChatFlow_1[a5(0xe3)]),sequelize_typescript_1['Column'],__metadata(a5(0xee),Number)],Whatsapp[a2(0xe9)],a5(0xa2),void 0x0),__decorate([(0x0,sequelize_typescript_1['BelongsTo'])(()=>ChatFlow_1[a5(0xe3)]),__metadata(a2(0xee),ChatFlow_1[a5(0xe3)])],Whatsapp[a2(0xe9)],a2(0xef),void 0x0),__decorate([(0x0,sequelize_typescript_1[a5(0xa9)])(null),sequelize_typescript_1['AllowNull'],(0x0,sequelize_typescript_1[a2(0xbd)])(sequelize_typescript_1[a2(0x8e)][a2(0xd4)](a2(0xa0),a2(0x92))),__metadata(a2(0xee),String)],Whatsapp[a2(0xe9)],a2(0xec),void 0x0),__decorate([(0x0,sequelize_typescript_1[a5(0xa9)])(null),sequelize_typescript_1[a2(0x8c)],(0x0,sequelize_typescript_1[a2(0xbd)])(sequelize_typescript_1[a2(0x8e)]['TEXT']),__metadata('design:type',String)],Whatsapp[a5(0xe9)],'tokenAPI',void 0x0),__decorate([(0x0,sequelize_typescript_1[a2(0xa9)])(null),sequelize_typescript_1[a5(0x8c)],(0x0,sequelize_typescript_1['Column'])(sequelize_typescript_1[a5(0x8e)][a2(0xe7)]),__metadata(a2(0xee),String)],Whatsapp[a2(0xe9)],a2(0xeb),void 0x0),__decorate([(0x0,sequelize_typescript_1[a5(0xa9)])(null),sequelize_typescript_1[a5(0x8c)],(0x0,sequelize_typescript_1[a5(0xbd)])(sequelize_typescript_1['DataType'][a5(0xe7)]),__metadata(a2(0xee),String)],Whatsapp[a2(0xe9)],a5(0xbb),void 0x0),__decorate([(0x0,sequelize_typescript_1[a2(0xbd)])(sequelize_typescript_1[a5(0x8e)][a2(0xd2)]),__metadata('design:type',String),__metadata(a5(0x93),[])],Whatsapp[a5(0xe9)],a5(0x98),null),__decorate([(0x0,sequelize_typescript_1[a2(0xbd)])(sequelize_typescript_1[a5(0x8e)]['VIRTUAL']),__metadata(a5(0xee),String),__metadata(a2(0x93),[])],Whatsapp[a2(0xe9)],a5(0xca),null),__decorate([sequelize_typescript_1['AfterUpdate'],__metadata('design:type',Function),__metadata('design:paramtypes',[Object]),__metadata(a2(0xe2),Promise)],Whatsapp,a5(0xe8),null),__decorate([sequelize_typescript_1[a5(0x99)],sequelize_typescript_1[a5(0xcd)],__metadata(a5(0xee),Function),__metadata(a5(0x93),[Whatsapp]),__metadata(a5(0xe2),Promise)],Whatsapp,a2(0xa3),null),Whatsapp=__decorate([sequelize_typescript_1[a5(0xe1)]],Whatsapp),exports['default']=Whatsapp;