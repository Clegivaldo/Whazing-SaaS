'use strict';const A=b,B=b;(function(c,d){const x=b,y=b,e=c();while(!![]){try{const f=parseInt(x(0x102))/0x1+-parseInt(y(0xfd))/0x2+-parseInt(y(0x110))/0x3+-parseInt(x(0x108))/0x4+parseInt(y(0xf7))/0x5*(parseInt(x(0x105))/0x6)+-parseInt(x(0x106))/0x7*(parseInt(y(0xed))/0x8)+parseInt(x(0x10e))/0x9;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xec3d4));var __importDefault=this&&this['__importDefault']||function(c){const z=b;return c&&c[z(0xff)]?c:{'default':c};};function b(c,d){const e=a();return b=function(f,g){f=f-0xec;let h=e[f];return h;},b(c,d);}Object['defineProperty'](exports,A(0xff),{'value':!![]});const Queue_1=__importDefault(require(B(0x104))),FindOrCreateTicketService_1=__importDefault(require(B(0xfc))),CreateMessageSystemService_1=__importDefault(require(A(0xee))),wbot_baileys_1=require(A(0xec)),Contact_1=__importDefault(require(A(0x10f))),CreateContactService_1=__importDefault(require(A(0xfb))),AppError_1=__importDefault(require('../errors/AppError'));function a(){const E=['@$s.whatsapp.net','49863780XeHjHD','../models/Contact','2506866bDRrvY','../libs/wbot-baileys','12080392lMNduJ','../services/MessageServices/CreateMessageSystemService','hookMessageStatus','exists','jid','sessionId','number','SendMessageAPI','error\x20session','body','185PSZQeR','NUMBER_NOT_FOUND','authToken','whatsapp','./../services/ContactServices/CreateContactService','../services/TicketServices/FindOrCreateTicketService','3116126zAONmt','API','__esModule','externalKey','default','427285nZwRaf','getWbot','../libs/Queue','33690oOQkIX','7CgUjOH','pending','5216360oldblE','apiConfig','urlMessageStatus','onWhatsApp','tenantId'];a=function(){return E;};return a();}exports[A(0x101)]={'key':B(0xf4),'options':{'delay':0x1f4,'attempts':0x1,'removeOnComplete':!![],'removeOnFail':![]},async 'handle'({data:c}){const C=A,D=A,d=(0x0,wbot_baileys_1[C(0x103)])(c[D(0xf2)]);try{const e=c[C(0xf3)]+C(0x10d),f=await d[D(0x10b)](e);if(f[0x0][C(0xf0)]==![])throw new AppError_1[(D(0x101))](C(0xf8),0x194);c[C(0xf3)]=f[0x0][C(0xf1)]['split']('@')[0x0];let g=await Contact_1[C(0x101)]['findOne']({'where':{'number':c['number'],'tenantId':c['tenantId']}});!g&&(g=await(0x0,CreateContactService_1[C(0x101)])({'name':c['number'],'number':c['number'],'tenantId':c[D(0x10c)]}));const h=await(0x0,FindOrCreateTicketService_1[D(0x101)])({'contact':g,'whatsappId':d['id'],'unreadMessages':0x0,'tenantId':c[D(0x10c)],'groupContact':undefined,'channel':C(0xfa)});await(0x0,CreateMessageSystemService_1[D(0x101)])({'msg':c,'tenantId':c[D(0x10c)],'ticket':h,'sendType':C(0xfe),'status':D(0x107)}),await h['update']({'apiConfig':{...c[D(0x109)],'externalKey':c[C(0x100)]}});}catch(i){const j={'ack':-0x2,'body':c[D(0xf6)],'messageId':'','number':c[D(0xf3)],'externalKey':c['externalKey'],'error':D(0xf5),'type':C(0xef),'authToken':c[C(0xf9)]};c?.[C(0x109)]?.[C(0x10a)]&&Queue_1[C(0x101)]['add']('WebHooksAPI',{'url':c['apiConfig'][D(0x10a)],'type':j['type'],'payload':j});throw new Error(i);}}};