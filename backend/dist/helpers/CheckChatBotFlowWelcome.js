'use strict';const o=b,p=b;(function(c,d){const m=b,n=b,e=c();while(!![]){try{const f=-parseInt(m(0xaa))/0x1*(parseInt(m(0xb9))/0x2)+-parseInt(m(0xb1))/0x3*(-parseInt(m(0xb6))/0x4)+-parseInt(m(0xae))/0x5+parseInt(m(0xa3))/0x6*(parseInt(n(0xa9))/0x7)+parseInt(n(0xb8))/0x8*(-parseInt(m(0xbb))/0x9)+parseInt(n(0xb0))/0xa*(parseInt(m(0xba))/0xb)+-parseInt(m(0xa1))/0xc;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x85501));function a(){const s=['../services/WhatsappService/ShowWhatsAppService','start','../services/TicketServices/CreateLogTicketService','contactId','botTicketActive','tenantId','userId','1165692QPpLcU','findOne','6UJiFiZ','__esModule','chatBot','defineProperty','update','findByPk','6727728VJGiXr','26OxSVts','value','../models/ChatFlow','default','1029965GEcXUo','chatFlowId','1192350GhJZKW','37371uzyrje','number','whatsappId','flow','find','92yeHmRB','../models/Contact','8Nopmre','24176XgMeOw','22rThpGK','2903526kEoUly'];a=function(){return s;};return a();}var __importDefault=this&&this['__importDefault']||function(c){return c&&c['__esModule']?c:{'default':c};};Object[o(0xa6)](exports,p(0xa4),{'value':!![]});function b(c,d){const e=a();return b=function(f,g){f=f-0x9d;let h=e[f];return h;},b(c,d);}const Contact_1=__importDefault(require(o(0xb7))),Setting_1=__importDefault(require('../models/Setting')),ChatFlow_1=__importDefault(require(p(0xac))),CreateLogTicketService_1=__importDefault(require(p(0xbe))),IsContactTest_1=__importDefault(require('../services/ChatFlowServices/IsContactTest')),ShowWhatsAppService_1=__importDefault(require(p(0xbc))),CheckChatBotFlowWelcome=async c=>{const q=o,r=o;if(c[q(0xa0)]||c['isGroup'])return;const d=await Setting_1[r(0xad)][q(0xa2)]({'where':{'key':q(0x9e),'tenantId':c[r(0x9f)]}}),e=await(0x0,ShowWhatsAppService_1[q(0xad)])({'id':c[r(0xb3)],'tenantId':c[q(0x9f)]}),f=e?.[q(0xaf)]||d?.[q(0xab)];if(!f)return;const g=await ChatFlow_1[r(0xad)][r(0xa2)]({'where':{'id':+f,'tenantId':c[q(0x9f)],'isActive':!![],'isDeleted':![]}});if(!g)return;const h=await Contact_1[r(0xad)][q(0xa8)](c[q(0x9d)]),{celularTeste:i}=g,j=h?.[q(0xb2)];if(await(0x0,IsContactTest_1[r(0xad)])(j,i,c['channel']))return;const k=g[q(0xb4)]['lineList'][r(0xb5)](l=>l['from']===q(0xbd));await c[r(0xa7)]({'chatFlowId':g['id'],'stepChatFlow':k['to'],'lastInteractionBot':new Date()}),await(0x0,CreateLogTicketService_1['default'])({'ticketId':c['id'],'type':q(0xa5)});};exports['default']=CheckChatBotFlowWelcome;