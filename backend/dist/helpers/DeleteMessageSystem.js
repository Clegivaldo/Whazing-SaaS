'use strict';function a(){const v=['../errors/AppError','createdAt','messenger','180144EkqAwq','telegramId','28XRqvri','getTbot','whatsapp','No\x20delete\x20message\x20afeter\x202h\x20sended','15132MiNMXF','8nEFPTK','telegram','376318AJlkXQ','getWbot','emit','whatsappId','2137581mnbvom','../libs/tbot','2838649YYWUSG','channel','differenceInHours','../models/Ticket','update','No\x20message\x20found\x20with\x20this\x20ID.','parse','tenant:','ticket','2448710UPCrIW','36iDZOpt','key','../libs/socket','messageId',':appMessage','3PclJyk','defineProperty','87745kYdNTr','__esModule','getIO','../models/Message','217XTdypz','contact'];a=function(){return v;};return a();}function b(c,d){const e=a();return b=function(f,g){f=f-0xb1;let h=e[f];return h;},b(c,d);}const r=b,s=b;(function(c,d){const o=b,p=b,e=c();while(!![]){try{const f=-parseInt(o(0xd9))/0x1+parseInt(o(0xb9))/0x2*(-parseInt(o(0xce))/0x3)+-parseInt(o(0xb2))/0x4*(parseInt(o(0xd0))/0x5)+-parseInt(p(0xb6))/0x6*(parseInt(o(0xd4))/0x7)+-parseInt(p(0xb7))/0x8*(-parseInt(p(0xbd))/0x9)+-parseInt(o(0xc8))/0xa+parseInt(p(0xbf))/0xb*(parseInt(p(0xc9))/0xc);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x3036f));var __importDefault=this&&this['__importDefault']||function(c){const q=b;return c&&c[q(0xd1)]?c:{'default':c};};Object[r(0xcf)](exports,s(0xd1),{'value':!![]});const date_fns_1=require('date-fns'),Message_1=__importDefault(require(r(0xd3))),Ticket_1=__importDefault(require(s(0xc2))),tbot_1=require(r(0xbe)),AppError_1=__importDefault(require(r(0xd6))),socket_1=require(s(0xcb)),wbot_baileys_1=require('../libs/wbot-baileys'),DeleteMessageSystem=async(c,d,e)=>{const t=s,u=r,f=await Message_1['default']['findOne']({'where':{'id':c},'include':[{'model':Ticket_1['default'],'as':t(0xc7),'include':[t(0xd5)],'where':{'tenantId':e}}]});if(f){const i=(0x0,date_fns_1[t(0xc1)])(new Date(),(0x0,date_fns_1['parseJSON'])(f?.[u(0xd7)]));if(i>0x2)throw new AppError_1['default'](u(0xb5));}if(!f)throw new AppError_1['default'](t(0xc4));const {ticket:g}=f;if(g[t(0xc0)]===u(0xb4)){const j=await(0x0,wbot_baileys_1[u(0xba)])(g[t(0xbc)]),k=JSON[u(0xc5)](f['dataJson']);await j['sendMessage'](k['key']['remoteJid'],{'delete':k[t(0xca)]});}if(g[t(0xc0)]===t(0xb8)){const l=await(0x0,tbot_1[u(0xb3)])(g[t(0xbc)]);await l['telegram']['deleteMessage'](g['contact'][u(0xb1)],+f[u(0xcc)]);}if(g[t(0xc0)]==='instagram')return;if(g[t(0xc0)]===t(0xd8))return;await f[t(0xc3)]({'isDeleted':!![]});const h=(0x0,socket_1[u(0xd2)])();h['to']('tenant:'+e+':'+g['id'])[u(0xbb)](t(0xc6)+e+t(0xcd),{'action':u(0xc3),'message':f,'ticket':g,'contact':g[t(0xd5)]});};exports['default']=DeleteMessageSystem;