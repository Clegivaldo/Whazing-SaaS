'use strict';const o=b,q=b;(function(c,d){const m=b,n=b,e=c();while(!![]){try{const f=-parseInt(m(0xdc))/0x1+parseInt(n(0xf2))/0x2*(parseInt(m(0xe4))/0x3)+parseInt(n(0xd6))/0x4+parseInt(n(0xe8))/0x5*(-parseInt(m(0xf8))/0x6)+parseInt(m(0xe1))/0x7*(parseInt(m(0xdd))/0x8)+-parseInt(n(0xe3))/0x9*(parseInt(m(0xdb))/0xa)+parseInt(m(0xea))/0xb;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xd1b46));function a(){const x=['../libs/socket','jrt','configs','10468040JJrNIp','1567637xjnYhc','8DLDRtg',':users','../helpers/SendRefreshToken','ERR_SESSION_EXPIRED','3132101FuqQgx','status','9SEZEQw','10047sUbgsy','store','body','default','280MJwcHA','findByPk','26249234jqFoAx','../errors/AppError','defineProperty','tenantId','__importDefault','ERR_USER_NOT_FOUND','json','cookies','120uKsOqb','queues','name','../models/User','emit','../services/AuthServices/RefreshTokenService','68934hHSIIp','email','RefreshTokenService','update','../services/UserServices/AuthUserSerice','SendRefreshToken','getIO','__esModule','4328392fNIMIk','logout'];a=function(){return x;};return a();}function b(c,d){const e=a();return b=function(f,g){f=f-0xd4;let h=e[f];return h;},b(c,d);}var __importDefault=this&&this[o(0xee)]||function(c){const p=o;return c&&c[p(0xd5)]?c:{'default':c};};Object[q(0xec)](exports,q(0xd5),{'value':!![]}),exports[q(0xd7)]=exports[q(0xfb)]=exports[o(0xe5)]=void 0x0;const AppError_1=__importDefault(require(q(0xeb))),AuthUserSerice_1=__importDefault(require(q(0xfc))),SendRefreshToken_1=require(q(0xdf)),RefreshTokenService_1=require(o(0xf7)),socket_1=require(q(0xd8)),User_1=__importDefault(require(q(0xf5))),store=async(c,d)=>{const r=q,s=q,e=(0x0,socket_1[r(0xd4)])(),{email:f,password:g}=c[r(0xe6)],{token:h,user:i,refreshToken:j,usuariosOnline:k}=await(0x0,AuthUserSerice_1[s(0xe7)])({'email':f,'password':g});(0x0,SendRefreshToken_1[s(0xfd)])(d,j);const l={'token':h,'username':i[s(0xf4)],'email':i[r(0xf9)],'profile':i['profile'],'status':i[s(0xe2)],'userId':i['id'],'tenantId':i[s(0xed)],'queues':i[s(0xf3)],'usuariosOnline':k,'configs':i[r(0xda)]};return e['emit'](l[s(0xed)]+r(0xde),{'action':'update','data':{'username':l['username'],'email':l[s(0xf9)],'isOnline':!![],'lastLogin':new Date()}}),d[s(0xe2)](0xc8)['json'](l);};exports['store']=store;const update=async(c,d)=>{const t=o,u=q,e=c[t(0xf1)][u(0xd9)];if(!e)throw new AppError_1[(u(0xe7))](t(0xe0),0x191);const {newToken:f,refreshToken:g}=await(0x0,RefreshTokenService_1[u(0xfa)])(e);return(0x0,SendRefreshToken_1[u(0xfd)])(d,g),d[u(0xf0)]({'token':f});};exports[o(0xfb)]=update;const logout=async(c,d)=>{const v=q,w=o,{userId:e}=c[v(0xe6)];if(!e)throw new AppError_1[(w(0xe7))](w(0xef),0x194);const f=(0x0,socket_1[w(0xd4)])(),g=await User_1[v(0xe7)][w(0xe9)](e);return g&&g[v(0xfb)]({'isOnline':![],'lastLogout':new Date()}),f[w(0xf6)](g?.[w(0xed)]+w(0xde),{'action':v(0xfb),'data':{'username':g?.['name'],'email':g?.['email'],'isOnline':![],'lastLogout':new Date()}}),d[w(0xf0)]({'message':'USER_LOGOUT'});};exports[q(0xd7)]=logout;