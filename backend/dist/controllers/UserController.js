'use strict';const u=b,v=b;(function(c,d){const r=b,s=b,e=c();while(!![]){try{const f=parseInt(r(0x1a9))/0x1+-parseInt(r(0x1bd))/0x2+parseInt(s(0x1dc))/0x3*(parseInt(s(0x1b6))/0x4)+parseInt(s(0x1c1))/0x5+parseInt(r(0x1c0))/0x6*(parseInt(s(0x1be))/0x7)+parseInt(s(0x1a7))/0x8*(-parseInt(s(0x1a6))/0x9)+-parseInt(s(0x1da))/0xa*(-parseInt(s(0x1ca))/0xb);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x210d8));var __importDefault=this&&this['__importDefault']||function(c){const t=b;return c&&c[t(0x1c5)]?c:{'default':c};};Object[u(0x1d4)](exports,v(0x1c5),{'value':!![]}),exports[v(0x1c9)]=exports['chatInterno']=exports[v(0x1b5)]=exports['updateConfigs']=exports[u(0x1b4)]=exports['show']=exports['store']=exports[u(0x1cb)]=void 0x0;const socket_1=require(u(0x1ae)),CheckSettingstenant1_1=__importDefault(require('../helpers/CheckSettingstenant1')),CheckSettings_1=__importDefault(require(u(0x1b9))),AppError_1=__importDefault(require('../errors/AppError')),CreateUserService_1=__importDefault(require(v(0x1bf))),ListUsersService_1=__importDefault(require(v(0x1cf))),UpdateUserService_1=__importDefault(require(v(0x1c3))),ShowUserService_1=__importDefault(require(u(0x1a3))),DeleteUserService_1=__importDefault(require(v(0x1a4))),UpdateUserConfigsService_1=__importDefault(require('../services/UserServices/UpdateUserConfigsService')),Tenant_1=__importDefault(require(v(0x1b1))),ListUserChatInterno_1=__importDefault(require(v(0x1bc))),ListGroupsByUserId_1=__importDefault(require(u(0x1a2))),ListTotalUsersService_1=__importDefault(require('../services/UserServices/ListTotalUsersService')),index=async(c,d)=>{const w=v,x=u,e=await(0x0,CheckSettingstenant1_1[w(0x1b3)])('userCreation');if(e!==x(0x1aa)){const l=await(0x0,ListTotalUsersService_1[w(0x1b3)])();if(l>=0xb){if(x(0x1c6)!==x(0x1cd))throw new AppError_1['default'](x(0x1d5),0x190);else throw new d['default'](w(0x1b7),0x193);}}const {tenantId:f}=c[w(0x1d9)],{searchParam:g,pageNumber:h}=c[x(0x1ac)],{users:i,count:j,hasMore:k}=await(0x0,ListUsersService_1['default'])({'searchParam':g,'pageNumber':h,'tenantId':f});return d[x(0x1d2)]({'users':i,'count':j,'hasMore':k});};exports[v(0x1cb)]=index;const store=async(c,d)=>{const y=v,z=u,{tenantId:e}=c[y(0x1d9)],{email:f,password:g,name:h,profile:i}=c[z(0x1d6)],{users:j}=await(0x0,ListUsersService_1['default'])({'tenantId':e}),k=await Tenant_1['default'][y(0x1db)](e),l=await(0x0,CheckSettingstenant1_1[z(0x1b3)])('userCreation');if(l!==z(0x1aa)){const o=await(0x0,ListTotalUsersService_1[z(0x1b3)])();if(o>=0xa){if(y(0x1a5)===y(0x1af))throw new d[(y(0x1b3))]('ERR_USER_CREATION_DISABLED',0x193);else throw new AppError_1[(z(0x1b3))](z(0x1d5),0x190);}}if(j[y(0x1bb)]>=k?.[z(0x1d3)])throw new AppError_1['default']('ERR_USER_LIMIT_USER_CREATION',0x190);else{if(c[y(0x1ce)]===z(0x1d0)&&await(0x0,CheckSettings_1[y(0x1b3)])(z(0x1ab))===y(0x1aa))throw new AppError_1[(z(0x1b3))]('ERR_USER_CREATION_DISABLED',0x193);else{if(c[y(0x1ce)]!==z(0x1d0)&&c[z(0x1d9)]['profile']!==y(0x1c2)){if(z(0x1a8)!==y(0x1c4))throw new AppError_1[(z(0x1b3))](y(0x1b7),0x193);else throw new d[(y(0x1b3))](z(0x1b7),0x193);}}}const m=await(0x0,CreateUserService_1['default'])({'email':f,'password':g,'name':h,'profile':i,'tenantId':e}),n=(0x0,socket_1[y(0x1b8)])();return n[z(0x1d8)](e+':user',{'action':'create','user':m}),d[z(0x1cc)](0xc8)[z(0x1d2)](m);};exports[u(0x1c7)]=store;const show=async(c,d)=>{const A=u,B=u,{userId:e}=c[A(0x1d7)],{tenantId:f}=c[B(0x1d9)],g=await(0x0,ShowUserService_1[A(0x1b3)])(e,f);return d[A(0x1cc)](0xc8)[B(0x1d2)](g);};exports[u(0x1d1)]=show;const update=async(c,d)=>{const C=v,D=v,{userId:e}=c['params'],f=c['body'],{tenantId:g}=c[C(0x1d9)],h=await(0x0,UpdateUserService_1['default'])({'userData':f,'userId':e,'tenantId':g}),i=(0x0,socket_1[D(0x1b8)])();return i[D(0x1d8)](g+D(0x1ad),{'action':D(0x1b4),'user':h}),d[D(0x1cc)](0xc8)[D(0x1d2)](h);};exports[v(0x1b4)]=update;const updateConfigs=async(c,d)=>{const E=v,F=v,{userId:e}=c[E(0x1d7)],f=c['body'],{tenantId:g}=c[E(0x1d9)];return await(0x0,UpdateUserConfigsService_1[E(0x1b3)])({'userConfigs':f,'userId':e,'tenantId':g}),d['status'](0xc8)[E(0x1d2)]();};exports[u(0x1b2)]=updateConfigs;const remove=async(c,d)=>{const G=v,H=v,{userId:e}=c[G(0x1d7)],{tenantId:f}=c[G(0x1d9)],g=c[H(0x1d9)]['id'];if(c[G(0x1d9)]['profile']!==H(0x1c2))throw new AppError_1[(G(0x1b3))](G(0x1b7),0x193);await(0x0,DeleteUserService_1[H(0x1b3)])(e,f,g);const h=(0x0,socket_1[G(0x1b8)])();return h['emit'](f+G(0x1ad),{'action':H(0x1c8),'userId':e}),d[G(0x1cc)](0xc8)[G(0x1d2)]({'message':G(0x1b0)});};function a(){const L=['151240svdttY','disabled','userCreation','query',':user','../libs/socket','ozTkr','User\x20deleted','../models/Tenant','updateConfigs','default','update','remove','69188zyQTAS','ERR_NO_PERMISSION','getIO','../helpers/CheckSettings','chatInterno','length','../services/UserServices/ListUserChatInterno','516762qmPdqF','41447zHzRkt','../services/UserServices/CreateUserService','42uBVqjw','998020AimiIb','admin','../services/UserServices/UpdateUserService','GnTur','__esModule','cSIjM','store','delete','showGroups','235114Lyfaoq','index','status','PVtkm','url','../services/UserServices/ListUsersService','/signup','show','json','maxUsers','defineProperty','ERR_USER_LIMIT_USER_CREATION','body','params','emit','user','60AJnbsC','findByPk','3LYYRdg','../services/GroupServices/ListGroupsByUserId','../services/UserServices/ShowUserService','../services/UserServices/DeleteUserService','PEhuf','117873xmpmYI','88TSgIqQ','AoVEG'];a=function(){return L;};return a();}exports[v(0x1b5)]=remove;const chatInterno=async(c,d)=>{const I=v,{tenantId:e,id:f}=c['user'],g=await(0x0,ListUserChatInterno_1['default'])(Number(f),Number(e));return d[I(0x1d2)]({'users':g});};function b(c,d){const e=a();return b=function(f,g){f=f-0x1a2;let h=e[f];return h;},b(c,d);}exports[v(0x1ba)]=chatInterno;const showGroups=async(c,d)=>{const J=v,K=u,{userId:e}=c[J(0x1d7)],f=await(0x0,ListGroupsByUserId_1[J(0x1b3)])(Number(e));return d['status'](0xc8)['json'](f);};exports[u(0x1c9)]=showGroups;