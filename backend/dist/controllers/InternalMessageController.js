'use strict';
const _0x58c5d4 = _0x12ed;
(function (_0x4dbbb6, _0x145215) {
    const _0x19a99d = _0x12ed, _0x352979 = _0x4dbbb6();
    while (!![]) {
        try {
            const _0x339223 = parseInt(_0x19a99d(0x10f)) / (-0x22af + -0x101 * -0x23 + -0x73) * (parseInt(_0x19a99d(0x11b)) / (0xf * -0xbf + 0x1edf + -0x13ac)) + parseInt(_0x19a99d(0x140)) / (-0x105a + 0x4c6 + -0x3dd * -0x3) * (-parseInt(_0x19a99d(0x15c)) / (0x153 * -0xe + 0x11 * 0x1 + 0x127d)) + -parseInt(_0x19a99d(0xfa)) / (0x1668 + 0xffc + -0x37d * 0xb) + -parseInt(_0x19a99d(0x100)) / (-0x84a * -0x2 + -0xf9e * -0x1 + -0x202c) + parseInt(_0x19a99d(0xef)) / (0x1c34 + 0x9 * 0x257 + -0x1 * 0x313c) + -parseInt(_0x19a99d(0x146)) / (-0x248e + -0xaad + -0x6f * -0x6d) * (parseInt(_0x19a99d(0x10c)) / (-0xd * -0x14b + 0x149f * -0x1 + 0x1 * 0x3d9)) + parseInt(_0x19a99d(0x153)) / (0x3 * 0x967 + 0x877 * 0x3 + -0x3590);
            if (_0x339223 === _0x145215)
                break;
            else
                _0x352979['push'](_0x352979['shift']());
        } catch (_0x4b7b4f) {
            _0x352979['push'](_0x352979['shift']());
        }
    }
}(_0x1034, 0xc1ae2 + 0x5d212 + -0x89 * 0x132d));
var __importDefault = this && this[_0x58c5d4(0xff) + _0x58c5d4(0x14f)] || function (_0x4253c5) {
    const _0x5c2d22 = _0x58c5d4;
    return _0x4253c5 && _0x4253c5[_0x5c2d22(0x108)] ? _0x4253c5 : { 'default': _0x4253c5 };
};
const _0x367fe2 = {};
_0x367fe2[_0x58c5d4(0xe5)] = !![], Object[_0x58c5d4(0x159) + _0x58c5d4(0x13d)](exports, _0x58c5d4(0x108), _0x367fe2), exports[_0x58c5d4(0xe9) + _0x58c5d4(0xee) + 'ge'] = exports[_0x58c5d4(0x110) + _0x58c5d4(0x10a) + 'a'] = exports[_0x58c5d4(0x12f) + _0x58c5d4(0xd8)] = exports[_0x58c5d4(0xe4) + _0x58c5d4(0x107)] = void (0x45 * 0x14 + -0x1 * -0xf75 + 0x3 * -0x6f3);
const socket_1 = require(_0x58c5d4(0x130) + _0x58c5d4(0x129)), InternalMessage_1 = __importDefault(require(_0x58c5d4(0xe8) + _0x58c5d4(0x151) + _0x58c5d4(0x139))), User_1 = __importDefault(require(_0x58c5d4(0xe8) + _0x58c5d4(0xf3))), ListCountUnreadMessage_1 = __importDefault(require(_0x58c5d4(0x148) + _0x58c5d4(0xe1) + _0x58c5d4(0xf4) + _0x58c5d4(0x13a) + _0x58c5d4(0xdf))), MessageService_1 = __importDefault(require(_0x58c5d4(0x148) + _0x58c5d4(0xe1) + _0x58c5d4(0x106) + _0x58c5d4(0x10b) + 'ce')), ReadMessageService_1 = __importDefault(require(_0x58c5d4(0x148) + _0x58c5d4(0xe1) + _0x58c5d4(0x118) + _0x58c5d4(0xdb) + _0x58c5d4(0x112))), logger_1 = require(_0x58c5d4(0x12b) + _0x58c5d4(0x132)), listarMensagens = async (_0x3869a2, _0x1be488) => {
        const _0x12cc08 = _0x58c5d4, _0x118b07 = {};
        _0x118b07[_0x12cc08(0x128)] = _0x12cc08(0x145) + _0x12cc08(0x154) + _0x12cc08(0x11a) + _0x12cc08(0x115);
        const _0x48ba9e = _0x118b07;
        try {
            const {id: _0xcde8b7} = _0x3869a2[_0x12cc08(0x136)], {userId: _0x11a662} = _0x3869a2[_0x12cc08(0xfc)], {isGroup: _0x5901bb} = _0x3869a2[_0x12cc08(0x12e)], _0x2ca52d = await MessageService_1[_0x12cc08(0x127)][_0x12cc08(0xe4) + _0x12cc08(0x107)](_0xcde8b7, _0x11a662, _0x5901bb), _0x22d791 = {};
            return _0x22d791[_0x12cc08(0xed)] = _0x2ca52d, _0x1be488[_0x12cc08(0x125)](0x5e0 + -0x1 * 0x11d7 + -0xcbf * -0x1)[_0x12cc08(0x10d)](_0x22d791);
        } catch (_0x27bc75) {
            console[_0x12cc08(0x13b)](_0x27bc75);
            const _0x502356 = {};
            return _0x502356[_0x12cc08(0x13b)] = _0x48ba9e[_0x12cc08(0x128)], _0x1be488[_0x12cc08(0x125)](0x1675 + -0x265c + -0x28d * -0x7)[_0x12cc08(0x10d)](_0x502356);
        }
    };
exports[_0x58c5d4(0xe4) + _0x58c5d4(0x107)] = listarMensagens;
const criarMensagem = async (_0x56a8b6, _0x3f462a) => {
    const _0x35faa8 = _0x58c5d4, _0x22738d = {};
    _0x22738d[_0x35faa8(0x14b)] = _0x35faa8(0x155) + _0x35faa8(0xf1) + _0x35faa8(0xea), _0x22738d[_0x35faa8(0xd9)] = _0x35faa8(0x131), _0x22738d[_0x35faa8(0x111)] = function (_0x2aebe1, _0x3cd5b1) {
        return _0x2aebe1 === _0x3cd5b1;
    }, _0x22738d[_0x35faa8(0xfb)] = function (_0x32dd62, _0x4965eb) {
        return _0x32dd62 === _0x4965eb;
    }, _0x22738d[_0x35faa8(0x102)] = _0x35faa8(0x114), _0x22738d[_0x35faa8(0x135)] = function (_0x17ed1a, _0x477cb5) {
        return _0x17ed1a > _0x477cb5;
    }, _0x22738d[_0x35faa8(0xf6)] = _0x35faa8(0x122), _0x22738d[_0x35faa8(0x15d)] = _0x35faa8(0x123), _0x22738d[_0x35faa8(0xf8)] = _0x35faa8(0xfd), _0x22738d[_0x35faa8(0x15a)] = _0x35faa8(0xe3), _0x22738d[_0x35faa8(0x142)] = _0x35faa8(0x145) + _0x35faa8(0x15e) + _0x35faa8(0x120) + _0x35faa8(0x11e);
    const _0x3f926e = _0x22738d;
    try {
        const {
                text: _0x6ef26f,
                timestamp: _0x1706b9,
                receiverId: _0x1b8cd6,
                isGroup: _0x242179
            } = _0x56a8b6[_0x35faa8(0xf0)], {
                id: _0x3ad23a,
                tenantId: _0x5eb29e
            } = _0x56a8b6[_0x35faa8(0x136)], _0xb06d52 = _0x56a8b6[_0x35faa8(0xf7)], _0x921dc2 = (0x706 * 0x5 + -0x201b + -0x3 * 0x101, socket_1[_0x35faa8(0x124)])(), _0x26e812 = {
                'text': _0x6ef26f,
                'timestamp': _0x1706b9,
                'receiverId': _0x1b8cd6,
                'senderId': _0x3ad23a,
                'tenantId': _0x5eb29e,
                'groupId': null,
                'mediaType': _0x3f926e[_0x35faa8(0xd9)],
                'mediaUrl': undefined,
                'createdAt': new Date(),
                'updatedAt': new Date()
            };
        (_0x3f926e[_0x35faa8(0x111)](_0x242179, !![]) || _0x3f926e[_0x35faa8(0xfb)](_0x242179, _0x3f926e[_0x35faa8(0x102)])) && (_0x26e812[_0x35faa8(0x119)] = undefined, _0x26e812[_0x35faa8(0x158)] = _0x1b8cd6);
        let _0x55402d = {};
        _0xb06d52 && _0x3f926e[_0x35faa8(0x135)](_0xb06d52[_0x35faa8(0x14e)], 0xad * -0x1 + -0xf1a + -0x1 * -0xfc7) ? await Promise[_0x35faa8(0xe0)](_0xb06d52[_0x35faa8(0x14a)](async _0x36065d => {
            const _0x5ef132 = _0x35faa8;
            try {
                if (!_0x36065d[_0x5ef132(0x10e)]) {
                    const _0x1b5445 = _0x36065d[_0x5ef132(0x137)][_0x5ef132(0xe2)]('/')[-0x20d1 * -0x1 + 0x81f + 0x1 * -0x28ef][_0x5ef132(0xe2)](';')[-0x91d * -0x1 + -0xcfd * -0x1 + -0x161a];
                    _0x36065d[_0x5ef132(0x10e)] = new Date()[_0x5ef132(0x143)]() + '.' + _0x1b5445;
                }
            } catch (_0x4e8736) {
                logger_1[_0x5ef132(0x149)][_0x5ef132(0x13b)](_0x4e8736);
            }
            const _0x1f92c8 = {
                    ..._0x26e812,
                    'text': _0x36065d[_0x5ef132(0x156) + 'me'],
                    'mediaUrl': _0x36065d[_0x5ef132(0x10e)],
                    'mediaType': _0x36065d[_0x5ef132(0x103)] || _0x36065d[_0x5ef132(0x137)][_0x5ef132(0xdd)](-0x1987 * -0x1 + -0x46d + 0xa8d * -0x2, _0x36065d[_0x5ef132(0x137)][_0x5ef132(0x11d)]('/'))
                }, _0x5cc76b = await MessageService_1[_0x5ef132(0x127)][_0x5ef132(0x12f) + _0x5ef132(0xd8)](_0x1f92c8);
            _0x55402d = await InternalMessage_1[_0x5ef132(0x127)][_0x5ef132(0x14c)](_0x5cc76b['id']);
            if (!_0x55402d)
                throw new Error(_0x3f926e[_0x5ef132(0x14b)]);
        })) : _0x55402d = await MessageService_1[_0x35faa8(0x127)][_0x35faa8(0x12f) + _0x35faa8(0xd8)](_0x26e812);
        const _0x109404 = {};
        _0x109404['id'] = _0x55402d['id'];
        const _0x275375 = {};
        _0x275375[_0x35faa8(0x133)] = User_1[_0x35faa8(0x127)], _0x275375['as'] = _0x3f926e[_0x35faa8(0xf6)], _0x275375[_0x35faa8(0x144)] = [
            'id',
            _0x3f926e[_0x35faa8(0x15d)]
        ];
        const _0x2ab89d = {};
        _0x2ab89d[_0x35faa8(0x133)] = User_1[_0x35faa8(0x127)], _0x2ab89d['as'] = _0x3f926e[_0x35faa8(0xf8)], _0x2ab89d[_0x35faa8(0x144)] = [
            'id',
            _0x3f926e[_0x35faa8(0x15d)]
        ];
        const _0x4ed274 = {};
        _0x4ed274[_0x35faa8(0x13c)] = _0x109404, _0x4ed274[_0x35faa8(0xde)] = [
            _0x275375,
            _0x2ab89d
        ];
        const _0x2f4761 = await InternalMessage_1[_0x35faa8(0x127)][_0x35faa8(0x15b)](_0x4ed274), _0x5dd1a1 = {};
        _0x5dd1a1['id'] = _0x2f4761['id'], _0x5dd1a1[_0x35faa8(0x119)] = _0x2f4761[_0x35faa8(0x119)], _0x5dd1a1[_0x35faa8(0x103)] = _0x2f4761[_0x35faa8(0x103)], _0x5dd1a1[_0x35faa8(0xe6)] = _0x2f4761[_0x35faa8(0xe6)], _0x5dd1a1[_0x35faa8(0x134)] = _0x2f4761[_0x35faa8(0x134)], _0x5dd1a1[_0x35faa8(0xf9)] = _0x3ad23a, _0x5dd1a1[_0x35faa8(0x150)] = _0x2f4761[_0x35faa8(0x150)], _0x5dd1a1[_0x35faa8(0x122)] = _0x2f4761[_0x35faa8(0x122)], _0x5dd1a1[_0x35faa8(0x158)] = _0x2f4761[_0x35faa8(0x158)], _0x5dd1a1[_0x35faa8(0xfd)] = _0x2f4761[_0x35faa8(0xfd)], _0x5dd1a1[_0x35faa8(0x104)] = _0x6ef26f;
        const _0xcdb510 = {};
        _0xcdb510[_0x35faa8(0x113)] = _0x3f926e[_0x35faa8(0x15a)], _0xcdb510[_0x35faa8(0xdc)] = _0x5dd1a1, _0x921dc2[_0x35faa8(0x12c)](_0x5eb29e + (_0x35faa8(0x157) + _0x35faa8(0x152) + 'no'), _0xcdb510);
        const _0x37b709 = {};
        _0x37b709['id'] = _0x2f4761['id'], _0x37b709[_0x35faa8(0x119)] = _0x1b8cd6, _0x37b709[_0x35faa8(0xf9)] = _0x3ad23a, _0x37b709[_0x35faa8(0x103)] = _0x2f4761[_0x35faa8(0x103)], _0x37b709[_0x35faa8(0x150)] = _0x2f4761[_0x35faa8(0x150)], _0x37b709[_0x35faa8(0x122)] = _0x2f4761[_0x35faa8(0x122)], _0x37b709[_0x35faa8(0x158)] = _0x2f4761[_0x35faa8(0x158)], _0x37b709[_0x35faa8(0xfd)] = _0x2f4761[_0x35faa8(0xfd)], _0x37b709[_0x35faa8(0x104)] = _0x6ef26f;
        const _0x20a410 = {};
        _0x20a410[_0x35faa8(0x113)] = _0x3f926e[_0x35faa8(0x15a)], _0x20a410[_0x35faa8(0xdc)] = _0x37b709, _0x921dc2[_0x35faa8(0x12c)](_0x5eb29e + (_0x35faa8(0x157) + _0x35faa8(0x152) + _0x35faa8(0xfe) + _0x35faa8(0x105)), _0x20a410);
        const _0x552eb5 = {};
        return _0x552eb5[_0x35faa8(0x101)] = _0x2f4761, _0x3f462a[_0x35faa8(0x125)](0x3 * 0x101 + 0x247 * -0x8 + 0xffe)[_0x35faa8(0x10d)](_0x552eb5);
    } catch (_0x46e8f0) {
        console[_0x35faa8(0x13b)](_0x46e8f0);
        const _0x1e0c4b = {};
        return _0x1e0c4b[_0x35faa8(0x13b)] = _0x3f926e[_0x35faa8(0x142)], _0x3f462a[_0x35faa8(0x125)](0xc * -0x245 + 0x23ca + -0x69a)[_0x35faa8(0x10d)](_0x1e0c4b);
    }
};
function _0x12ed(_0x580478, _0x30db58) {
    const _0x48273a = _0x1034();
    return _0x12ed = function (_0x3b4870, _0x48a2ed) {
        _0x3b4870 = _0x3b4870 - (0x256f + -0x15bd + -0xedb);
        let _0x4dc13f = _0x48273a[_0x3b4870];
        return _0x4dc13f;
    }, _0x12ed(_0x580478, _0x30db58);
}
exports[_0x58c5d4(0x12f) + _0x58c5d4(0xd8)] = criarMensagem;
const marcarMensagemNaoLida = async (_0x251fae, _0x34fb94) => {
    const _0x38ec75 = _0x58c5d4, _0x3fb58f = {
            'IUTEa': _0x38ec75(0xe3),
            'kMhgE': function (_0x228110, _0x591216) {
                return _0x228110(_0x591216);
            },
            'Fikxl': _0x38ec75(0xd7) + _0x38ec75(0x12a) + _0x38ec75(0xf5),
            'GTixL': _0x38ec75(0x145) + _0x38ec75(0x109) + _0x38ec75(0x147) + _0x38ec75(0x12d) + _0x38ec75(0x141)
        };
    try {
        const {contactId: _0x453f23} = _0x251fae[_0x38ec75(0xfc)], {
                id: _0x1d1cbd,
                tenantId: _0x4e8143
            } = _0x251fae[_0x38ec75(0x136)], {isGroup: _0x43aec9} = _0x251fae[_0x38ec75(0xf0)], _0x153987 = (0x1 * 0x83e + 0x100 * 0x2 + 0x51f * -0x2, socket_1[_0x38ec75(0x124)])(), _0x168209 = {};
        _0x168209[_0x38ec75(0x14d)] = _0x1d1cbd, _0x168209[_0x38ec75(0xf9)] = _0x453f23, _0x168209[_0x38ec75(0x117)] = _0x43aec9, await (0x17e * 0x8 + -0x1 * -0x1c8d + 0x5 * -0x819, ReadMessageService_1[_0x38ec75(0x127)])(_0x168209), _0x153987[_0x38ec75(0x12c)](_0x4e8143 + (_0x38ec75(0x126) + _0x38ec75(0xec) + _0x38ec75(0xda)), {
            'action': _0x3fb58f[_0x38ec75(0x13e)],
            'data': {
                'receiverId': _0x1d1cbd,
                'isGroup': _0x43aec9,
                'senderId': _0x3fb58f[_0x38ec75(0xe7)](Number, _0x453f23)
            }
        });
        const _0x5a16d4 = {};
        return _0x5a16d4[_0x38ec75(0x138)] = _0x3fb58f[_0x38ec75(0x116)], _0x34fb94[_0x38ec75(0x125)](-0x655 + 0x5ac * 0x2 + 0x43b * -0x1)[_0x38ec75(0x10d)](_0x5a16d4);
    } catch (_0x2a02d6) {
        console[_0x38ec75(0x13b)](_0x2a02d6);
        const _0x51d1d9 = {};
        return _0x51d1d9[_0x38ec75(0x13b)] = _0x3fb58f[_0x38ec75(0x11c)], _0x34fb94[_0x38ec75(0x125)](0x20de + -0x1a94 + -0x456)[_0x38ec75(0x10d)](_0x51d1d9);
    }
};
exports[_0x58c5d4(0x110) + _0x58c5d4(0x10a) + 'a'] = marcarMensagemNaoLida;
const listCountUnreadMessage = async (_0x40bb10, _0x308226) => {
    const _0x4c2b45 = _0x58c5d4, _0x3c51d0 = {};
    _0x3c51d0[_0x4c2b45(0x13f)] = _0x4c2b45(0x145) + _0x4c2b45(0x15e) + _0x4c2b45(0x121) + _0x4c2b45(0xeb) + _0x4c2b45(0x11f);
    const _0x48ec46 = _0x3c51d0;
    try {
        const {id: _0x11ebcb} = _0x40bb10[_0x4c2b45(0x136)], _0x43b9ad = await (0x2e5 + 0x20d5 + -0x23ba, ListCountUnreadMessage_1[_0x4c2b45(0x127)])(_0x11ebcb), _0x222b77 = {};
        return _0x222b77[_0x4c2b45(0xf2)] = _0x43b9ad, _0x308226[_0x4c2b45(0x125)](0xc37 * -0x1 + -0xb * 0x239 + 0x12b9 * 0x2)[_0x4c2b45(0x10d)](_0x222b77);
    } catch (_0x1ba94f) {
        console[_0x4c2b45(0x13b)](_0x1ba94f);
        const _0x4d0150 = {};
        return _0x4d0150[_0x4c2b45(0x13b)] = _0x48ec46[_0x4c2b45(0x13f)], _0x308226[_0x4c2b45(0x125)](0x1 * 0x1bc5 + 0x2 * 0x1357 + 0xb * -0x5dd)[_0x4c2b45(0x10d)](_0x4d0150);
    }
};
exports[_0x58c5d4(0xe9) + _0x58c5d4(0xee) + 'ge'] = listCountUnreadMessage;
function _0x1034() {
    const _0x19b4db = [
        'DNfBv',
        'cket',
        'marcadas\x20c',
        '../utils/l',
        'emit',
        'nsagens\x20co',
        'query',
        'criarMensa',
        '../libs/so',
        'chat',
        'ogger',
        'model',
        'mediaUrl',
        'miYbG',
        'user',
        'mimetype',
        'message',
        'ssage',
        'stCountUnr',
        'error',
        'where',
        'erty',
        'IUTEa',
        'sdZOr',
        '51081MwkbbT',
        'mo\x20lida.',
        'wjIbx',
        'getTime',
        'attributes',
        'Ocorreu\x20um',
        '776XNVelj',
        'arcar\x20a\x20me',
        '../service',
        'logger',
        'map',
        'tCxgi',
        'findByPk',
        'userId',
        'length',
        'fault',
        'timestamp',
        'InternalMe',
        'chat-inter',
        '16061860bNnQvc',
        '\x20erro\x20ao\x20l',
        'ERR_CREATI',
        'originalna',
        ':mensagem-',
        'groupId',
        'defineProp',
        'bMbUa',
        'findOne',
        '136LiIfrt',
        'sJqyS',
        '\x20erro\x20ao\x20c',
        'Mensagems\x20',
        'gem',
        'ufTuA',
        't-interno',
        'adMessageS',
        'data',
        'substr',
        'include',
        'eadMessage',
        'all',
        's/Internal',
        'split',
        'update',
        'listarMens',
        'value',
        'mediaName',
        'kMhgE',
        '../models/',
        'listCountU',
        '_SYSTEM',
        'ensagens\x20n',
        'nsagem-cha',
        'mensagens',
        'nreadMessa',
        '5537903wmrkUY',
        'body',
        'NG_MESSAGE',
        'count',
        'User',
        'Message/Li',
        'omo\x20lida.',
        'EPZtt',
        'files',
        'BAfhi',
        'senderId',
        '1230755BNyEps',
        'qLcrt',
        'params',
        'receiver',
        'no-notific',
        '__importDe',
        '3606228lXZTGL',
        'mensagem',
        'kqYhZ',
        'mediaType',
        'text',
        'acao',
        'Message/Me',
        'agens',
        '__esModule',
        '\x20erro\x20ao\x20m',
        'agemNaoLid',
        'ssageServi',
        '60975tqGWNU',
        'json',
        'filename',
        '188206GSYQdT',
        'marcarMens',
        'kbLyv',
        'ervice',
        'action',
        'true',
        'ensagens.',
        'Fikxl',
        'isGroup',
        'Message/Re',
        'receiverId',
        'istar\x20as\x20m',
        '2IulvKn',
        'GTixL',
        'indexOf',
        'sagem.',
        'ão\x20lidas.',
        'riar\x20a\x20men',
        'ontar\x20as\x20m',
        'sender',
        'name',
        'getIO',
        'status',
        ':unread-me',
        'default'
    ];
    _0x1034 = function () {
        return _0x19b4db;
    };
    return _0x1034();
}