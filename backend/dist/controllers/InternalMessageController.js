'use strict';
function a() {
    const af = [
        'jXsOm',
        'Message/Re',
        'ieESV',
        'findByPk',
        'mediaUrl',
        'ssage',
        'ogger',
        'arcar\x20a\x20me',
        'userId',
        'omo\x20lida.',
        'wPBbo',
        'text',
        'yUwRD',
        'listarMens',
        'jsSkj',
        'mGjpX',
        'defineProp',
        '8eRXnlK',
        'KMFPA',
        '11927304RuvmqI',
        'UvIJU',
        'filename',
        '../utils/l',
        's/Internal',
        '\x20erro\x20ao\x20m',
        '\x20erro\x20ao\x20c',
        'logger',
        'json',
        '10989391kpelbU',
        'DSwMk',
        '8dWukmR',
        'timestamp',
        'dZhmO',
        'getTime',
        '__importDe',
        'model',
        't-interno',
        'ensagens.',
        'where',
        '../models/',
        'NG_MESSAGE',
        'user',
        'findOne',
        'ervice',
        'jhyil',
        'User',
        'GgxSM',
        'pOeQD',
        'cket',
        'chat',
        'riar\x20a\x20men',
        'marcadas\x20c',
        'receiverId',
        '6jUTPNM',
        'mo\x20lida.',
        'nsagens\x20co',
        'files',
        'status',
        'fCLep',
        'length',
        'mensagens',
        '1353508iMFXSc',
        'Imlnr',
        'body',
        'mediaType',
        'include',
        '18843740vRPSWX',
        'agemNaoLid',
        'cRXEX',
        'attributes',
        '1712849zSAlfr',
        '../libs/so',
        'senderId',
        'substr',
        'adMessageS',
        'OidKv',
        'sITAI',
        'originalna',
        ':mensagem-',
        'true',
        'acao',
        'dfXHD',
        'UznnX',
        'ssageServi',
        'all',
        'nKLbZ',
        'gJpmQ',
        'ERR_CREATI',
        'ontar\x20as\x20m',
        'dLacO',
        'groupId',
        'mimetype',
        'IYYEW',
        'criarMensa',
        'AgIjP',
        'Message/Li',
        'value',
        '../service',
        'chat-inter',
        'Ujqrf',
        'Ã£o\x20lidas.',
        'ZGOmc',
        'Mensagems\x20',
        'EkeEO',
        'bXSVs',
        '4471415AGTiaV',
        'message',
        'eadMessage',
        'SqfjK',
        'mwbit',
        'nsagem-cha',
        'split',
        'bqDtR',
        'default',
        'yTtKx',
        'TReRe',
        'error',
        'YtucF',
        'IPNhH',
        'GOcJr',
        'Ocorreu\x20um',
        'sNzPX',
        'FYykm',
        'KwkPa',
        'name',
        'action',
        'data',
        'ghQhD',
        'InternalMe',
        'count',
        'ZXPXL',
        'marcarMens',
        'listCountU',
        'XKXtQ',
        'mensagem',
        'gem',
        'no-notific',
        'sagem.',
        'vSBva',
        'RjpEO',
        'dvlgN',
        'sender',
        'update',
        'nreadMessa',
        'bPORR',
        'indexOf',
        'vsWPv',
        'getIO',
        'LUYUP',
        'DArxJ',
        'isGroup',
        'bPgYk',
        ':unread-me',
        'receiver',
        'map',
        '3977181tWQsUF',
        'rKeoZ',
        'istar\x20as\x20m',
        'LSTQE',
        'stCountUnr',
        'mediaName',
        'query',
        'fault',
        '\x20erro\x20ao\x20l',
        'EfvnL',
        'vckBe',
        'params',
        'Message/Me',
        'emit',
        'erty',
        '_SYSTEM',
        'wvxMF',
        'SGyga',
        '__esModule',
        'sAriy',
        'agens',
        'uDCQo',
        'ensagens\x20n'
    ];
    a = function () {
        return af;
    };
    return a();
}
const a2 = b, a3 = b;
(function (c, d) {
    const a0 = b, a1 = b, e = c();
    while (!![]) {
        try {
            const f = parseInt(a0(0x174)) / (-0x2317 * -0x1 + 0xa15 * 0x3 + 0xd11 * -0x5) + parseInt(a1(0x16b)) / (0x2651 + 0xf37 * -0x1 + -0x1718) + parseInt(a1(0x117)) / (0x1b3 * 0x6 + -0x2255 + -0x16 * -0x119) + parseInt(a1(0x14c)) / (0x22a3 + -0x5a2 * 0x4 + -0x5 * 0x26b) * (-parseInt(a0(0xe5)) / (0xdc * 0x2b + -0x23ed + -0x6 * 0x2b)) + parseInt(a1(0x163)) / (0x29 * 0x81 + -0x1 * 0xb8d + 0x2 * -0x48b) * (-parseInt(a1(0x14a)) / (0x1 * -0x1b11 + -0x19d5 + -0x11 * -0x31d)) + -parseInt(a1(0x13f)) / (0x73 * -0x23 + 0x2201 * 0x1 + -0x92 * 0x20) * (parseInt(a0(0x141)) / (0x54 * -0x21 + -0x1b0b + -0x2 * -0x12f4)) + parseInt(a0(0x170)) / (0xb85 * 0x3 + -0x11 * 0xd9 + -0x141c);
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, -0xb4555 * 0x2 + 0x1 * -0xa4775 + 0x2ecc20));
var __importDefault = this && this[a2(0x150) + a3(0x11e)] || function (c) {
    const a4 = a3;
    return c && c[a4(0x129)] ? c : { 'default': c };
};
const o = {};
o[a2(0xdc)] = !![], Object[a2(0x13e) + a3(0x125)](exports, a2(0x129), o), exports[a2(0x100) + a2(0x10b) + 'ge'] = exports[a2(0xff) + a3(0x171) + 'a'] = exports[a2(0xd9) + a3(0x103)] = exports[a3(0x13b) + a3(0x12b)] = void (0x2b3 * 0x1 + -0x436 + 0x183);
const socket_1 = require(a2(0x175) + a3(0x15e)), InternalMessage_1 = __importDefault(require(a2(0x155) + a3(0xfc) + a2(0x133))), User_1 = __importDefault(require(a3(0x155) + a3(0x15b))), ListCountUnreadMessage_1 = __importDefault(require(a3(0xdd) + a3(0x145) + a3(0xdb) + a2(0x11b) + a3(0xe7))), MessageService_1 = __importDefault(require(a3(0xdd) + a3(0x145) + a2(0x123) + a3(0xcf) + 'ce')), ReadMessageService_1 = __importDefault(require(a3(0xdd) + a3(0x145) + a2(0x12f) + a3(0x178) + a2(0x159))), logger_1 = require(a2(0x144) + a3(0x134)), listarMensagens = async (f, g) => {
        const a5 = a3, a6 = a2, h = {};
        h[a5(0xf2)] = function (j, k) {
            return j !== k;
        }, h[a5(0x108)] = a5(0x13d), h[a5(0x138)] = a5(0x15c), h[a6(0x121)] = function (j, k) {
            return j === k;
        }, h[a5(0xf1)] = a6(0xf6), h[a6(0x120)] = a5(0xee), h[a6(0x11a)] = a6(0xf4) + a5(0x11f) + a6(0x119) + a6(0x153);
        const i = h;
        try {
            if (i[a5(0xf2)](i[a5(0x108)], i[a6(0x138)])) {
                const {id: j} = f[a5(0x157)], {userId: k} = f[a5(0x122)], {isGroup: l} = f[a5(0x11d)], m = await MessageService_1[a6(0xed)][a5(0x13b) + a5(0x12b)](j, k, l), n = {};
                return n[a5(0x16a)] = m, g[a6(0x167)](-0x2656 + -0xfc0 + 0x36de)[a6(0x149)](n);
            } else {
                const q = {};
                return q[a6(0xed)] = j, g && h[a5(0x129)] ? i : q;
            }
        } catch (q) {
            if (i[a5(0x121)](i[a5(0xf1)], i[a6(0x120)]))
                e[a6(0x148)][a6(0xf0)](f);
            else {
                console[a5(0xf0)](q);
                const s = {};
                return s[a5(0xf0)] = i[a6(0x11a)], g[a6(0x167)](0x1726 + 0x7 * -0x365 + 0x291 * 0x1)[a6(0x149)](s);
            }
        }
    };
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (0x19a9 + -0x4a * -0x81 + -0xc6f * 0x5);
        let h = e[f];
        return h;
    }, b(c, d);
}
exports[a2(0x13b) + a3(0x12b)] = listarMensagens;
const criarMensagem = async (n, p) => {
    const a7 = a3, a8 = a3, q = {};
    q[a7(0x168)] = a8(0xf4) + a8(0x11f) + a8(0x119) + a8(0x153), q[a7(0xd8)] = a7(0xf4) + a8(0x146) + a8(0x135) + a7(0x165) + a8(0x164), q[a7(0xd5)] = a7(0xf4) + a8(0x147) + a7(0xd4) + a8(0x12d) + a8(0xe0), q[a7(0xf7)] = a8(0xf4) + a8(0x147) + a8(0x160) + a8(0x105), q[a8(0xcd)] = function (s, t) {
        return s === t;
    }, q[a8(0x15a)] = a8(0x107), q[a8(0xe1)] = a8(0xc8), q[a7(0x106)] = a8(0x13a), q[a8(0x15d)] = a7(0xda), q[a8(0x130)] = a7(0x127), q[a8(0xd1)] = a7(0x110), q[a8(0x12a)] = a7(0xe3), q[a7(0x128)] = a8(0xd3) + a7(0x156) + a8(0x126), q[a7(0xf3)] = a7(0x140), q[a8(0x172)] = a8(0xdf), q[a8(0xfb)] = a7(0x15f), q[a7(0xf5)] = function (s, t) {
        return s === t;
    }, q[a7(0x10c)] = function (s, t) {
        return s === t;
    }, q[a7(0x111)] = a8(0xcb), q[a7(0x13c)] = function (s, t) {
        return s !== t;
    }, q[a8(0xef)] = a8(0x118), q[a7(0x101)] = function (s, t) {
        return s > t;
    }, q[a8(0x16c)] = a7(0x109), q[a8(0xe8)] = a7(0xf8), q[a8(0x12c)] = a8(0x115), q[a7(0x179)] = a7(0x10a);
    const r = q;
    try {
        if (r[a7(0xcd)](r[a7(0xf3)], r[a7(0x172)])) {
            f[a8(0xf0)](g);
            const t = {};
            return t[a7(0xf0)] = r[a8(0x168)], h[a8(0x167)](-0x1daa + -0x1936 + 0x38d4)[a7(0x149)](t);
        } else {
            const {
                    text: t,
                    timestamp: u,
                    receiverId: v,
                    isGroup: w
                } = n[a8(0x16d)], {
                    id: x,
                    tenantId: y
                } = n[a7(0x157)], z = n[a7(0x166)], A = (-0x13b * 0x4 + 0x15b6 + 0x10ca * -0x1, socket_1[a7(0x10f)])(), B = {
                    'text': t,
                    'timestamp': u,
                    'receiverId': v,
                    'senderId': x,
                    'tenantId': y,
                    'groupId': null,
                    'mediaType': r[a8(0xfb)],
                    'mediaUrl': undefined,
                    'createdAt': new Date(),
                    'updatedAt': new Date()
                };
            if (r[a7(0xf5)](w, !![]) || r[a8(0x10c)](w, r[a8(0x111)])) {
                if (r[a8(0x13c)](r[a7(0xef)], r[a8(0xef)])) {
                    if (!G[a8(0x143)]) {
                        const O = L[a7(0xd7)][a7(0xeb)]('/')[0xaf7 + -0x343 + -0x7b3][a8(0xeb)](';')[-0x128 + -0x8ef * -0x3 + -0x1 * 0x19a5];
                        M[a8(0x143)] = new m()[a7(0x14f)]() + '.' + O;
                    }
                } else
                    B[a7(0x162)] = undefined, B[a8(0xd6)] = v;
            }
            let C = {};
            z && r[a7(0x101)](z[a8(0x169)], 0x2243 + -0x1de + -0x2065 * 0x1) ? await Promise[a8(0xd0)](z[a8(0x116)](async O => {
                const a9 = a7, aa = a8, P = {};
                P[a9(0xe9)] = r[a9(0xf7)];
                const Q = P;
                if (r[aa(0xcd)](r[a9(0x15a)], r[a9(0x15a)])) {
                    try {
                        if (r[a9(0xcd)](r[a9(0xe1)], r[a9(0x106)])) {
                            F[a9(0xf0)](G);
                            const U = {};
                            return U[a9(0xf0)] = Q[a9(0xe9)], I[a9(0x167)](-0x1 * -0x1f57 + -0x2026 + 0x2c3)[a9(0x149)](U);
                        } else {
                            if (!O[a9(0x143)]) {
                                if (r[a9(0xcd)](r[a9(0x15d)], r[aa(0x130)])) {
                                    const V = F[a9(0xd7)][aa(0xeb)]('/')[0x1b88 + -0x157c + 0x77 * -0xd][aa(0xeb)](';')[-0x71 * 0x6 + 0x2683 + -0x23dd];
                                    G[aa(0x143)] = new I()[aa(0x14f)]() + '.' + V;
                                } else {
                                    const V = O[a9(0xd7)][aa(0xeb)]('/')[-0x1300 * -0x2 + -0x1f3 * -0x4 + -0x2dcb][aa(0xeb)](';')[0x6 * -0xad + 0x3e * -0x1f + -0xa * -0x128];
                                    O[a9(0x143)] = new Date()[aa(0x14f)]() + '.' + V;
                                }
                            }
                        }
                    } catch (W) {
                        if (r[aa(0xcd)](r[aa(0xd1)], r[aa(0x12a)])) {
                            F[a9(0xf0)](G);
                            const Y = {};
                            return Y[a9(0xf0)] = r[a9(0xd8)], I[a9(0x167)](0x7 * -0x115 + 0x2 * 0x112d + -0x18d3)[a9(0x149)](Y);
                        } else
                            logger_1[a9(0x148)][a9(0xf0)](W);
                    }
                    const R = {
                            ...B,
                            'text': O[aa(0xc9) + 'me'],
                            'mediaUrl': O[aa(0x143)],
                            'mediaType': O[a9(0x16e)] || O[aa(0xd7)][a9(0x177)](0xa5d * -0x1 + -0x9e * -0x33 + -0x151d, O[a9(0xd7)][aa(0x10d)]('/'))
                        }, S = await MessageService_1[a9(0xed)][a9(0xd9) + aa(0x103)](R);
                    C = await InternalMessage_1[a9(0xed)][a9(0x131)](S['id']);
                    if (!C)
                        throw new Error(r[a9(0x128)]);
                } else {
                    F[aa(0xf0)](G);
                    const Z = {};
                    return Z[aa(0xf0)] = r[aa(0xd5)], I[a9(0x167)](0x935 + -0x1aee + 0x13ad)[aa(0x149)](Z);
                }
            })) : C = await MessageService_1[a8(0xed)][a8(0xd9) + a7(0x103)](B);
            const D = {};
            D['id'] = C['id'];
            const E = {};
            E[a7(0x151)] = User_1[a8(0xed)], E['as'] = r[a7(0x16c)], E[a7(0x173)] = [
                'id',
                r[a7(0xe8)]
            ];
            const F = {};
            F[a8(0x151)] = User_1[a7(0xed)], F['as'] = r[a8(0x12c)], F[a7(0x173)] = [
                'id',
                r[a8(0xe8)]
            ];
            const G = {};
            G[a8(0x154)] = D, G[a7(0x16f)] = [
                E,
                F
            ];
            const H = await InternalMessage_1[a8(0xed)][a7(0x158)](G), I = {};
            I['id'] = H['id'], I[a8(0x162)] = H[a7(0x162)], I[a8(0x16e)] = H[a8(0x16e)], I[a8(0x11c)] = H[a8(0x11c)], I[a8(0x132)] = H[a8(0x132)], I[a7(0x176)] = x, I[a7(0x14d)] = H[a8(0x14d)], I[a8(0x109)] = H[a8(0x109)], I[a7(0xd6)] = H[a8(0xd6)], I[a8(0x115)] = H[a7(0x115)], I[a7(0x139)] = t;
            const J = {};
            J[a7(0xf9)] = r[a7(0x179)], J[a7(0xfa)] = I, A[a7(0x124)](y + (a8(0xca) + a7(0xde) + 'no'), J);
            const K = {};
            K['id'] = H['id'], K[a7(0x162)] = v, K[a8(0x176)] = x, K[a8(0x16e)] = H[a8(0x16e)], K[a7(0x14d)] = H[a7(0x14d)], K[a7(0x109)] = H[a7(0x109)], K[a8(0xd6)] = H[a8(0xd6)], K[a8(0x115)] = H[a7(0x115)], K[a7(0x139)] = t;
            const L = {};
            L[a7(0xf9)] = r[a8(0x179)], L[a7(0xfa)] = K, A[a8(0x124)](y + (a8(0xca) + a8(0xde) + a7(0x104) + a8(0xcc)), L);
            const M = {};
            return M[a8(0x102)] = H, p[a8(0x167)](-0x148e + -0x1c01 + 0x3158)[a8(0x149)](M);
        }
    } catch (O) {
        console[a8(0xf0)](O);
        const P = {};
        return P[a8(0xf0)] = r[a7(0xf7)], p[a7(0x167)](-0xad0 + -0x2 * 0xb2a + 0x2318)[a8(0x149)](P);
    }
};
exports[a3(0xd9) + a2(0x103)] = criarMensagem;
const marcarMensagemNaoLida = async (f, g) => {
    const ab = a2, ac = a2, h = {
            'ZXPXL': ab(0x10a),
            'jXsOm': function (i, j) {
                return i(j);
            },
            'DSwMk': ac(0xe2) + ac(0x161) + ac(0x137),
            'bXSVs': ab(0xf4) + ac(0x146) + ab(0x135) + ab(0x165) + ac(0x164)
        };
    try {
        const {contactId: i} = f[ac(0x122)], {
                id: j,
                tenantId: k
            } = f[ab(0x157)], {isGroup: l} = f[ab(0x16d)], m = (-0x27 * -0xb1 + 0xc7 * -0x10 + -0x1 * 0xe87, socket_1[ab(0x10f)])(), n = {};
        n[ac(0x136)] = j, n[ac(0x176)] = i, n[ac(0x112)] = l, await (0x5c5 + 0x6 * 0x287 + -0x17 * 0xe9, ReadMessageService_1[ab(0xed)])(n), m[ac(0x124)](k + (ac(0x114) + ac(0xea) + ab(0x152)), {
            'action': h[ac(0xfe)],
            'data': {
                'receiverId': j,
                'isGroup': l,
                'senderId': h[ab(0x12e)](Number, i)
            }
        });
        const p = {};
        return p[ab(0xe6)] = h[ac(0x14b)], g[ac(0x167)](0x5ec * -0x1 + -0x1 * -0x139d + -0xce9)[ac(0x149)](p);
    } catch (q) {
        console[ac(0xf0)](q);
        const r = {};
        return r[ab(0xf0)] = h[ab(0xe4)], g[ac(0x167)](-0xcef + -0x29a + 0x117d)[ac(0x149)](r);
    }
};
exports[a2(0xff) + a2(0x171) + 'a'] = marcarMensagemNaoLida;
const listCountUnreadMessage = async (f, g) => {
    const ad = a2, ae = a2, h = {};
    h[ad(0xd2)] = ad(0xd3) + ae(0x156) + ad(0x126), h[ae(0xec)] = function (j, k) {
        return j !== k;
    }, h[ae(0xce)] = ad(0x113), h[ae(0x142)] = ad(0x14e), h[ae(0x10e)] = ad(0xf4) + ae(0x147) + ae(0xd4) + ae(0x12d) + ad(0xe0);
    const i = h;
    try {
        const {id: j} = f[ae(0x157)], k = await (0xc03 * 0x1 + -0x1 * -0xa4f + -0x1652, ListCountUnreadMessage_1[ae(0xed)])(j), l = {};
        return l[ae(0xfd)] = k, g[ae(0x167)](0xe7d * -0x2 + -0x20c0 + -0xfe * -0x3f)[ad(0x149)](l);
    } catch (m) {
        if (i[ae(0xec)](i[ad(0xce)], i[ae(0x142)])) {
            console[ad(0xf0)](m);
            const n = {};
            return n[ae(0xf0)] = i[ae(0x10e)], g[ad(0x167)](-0x6dc * 0x4 + 0x81 * -0x3d + 0x2dd * 0x15)[ad(0x149)](n);
        } else
            throw new d(i[ad(0xd2)]);
    }
};
exports[a3(0x100) + a2(0x10b) + 'ge'] = listCountUnreadMessage;