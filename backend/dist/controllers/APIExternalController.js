'use strict';function a(){const W=['defineProperty','__setModuleDefault','yup','validate','bczeY','bbGQN','getOwnPropertyDescriptor','32821260BUEDhL','1944936cASMBq','url','shape','__esModule','5CJVeCa','JYiXA','__importDefault','configurable','65778jmzzVL','__createBinding','file','body','sendMessageAPI','string','call','Message\x20add\x20queue','uklFV','status','1538496gWgbNf','hasOwnProperty','params','7286181PNRRrG','../models/ApiConfig','4wczfii','number','message','writable','json','ERR_SESSION_NOT_AUTH_TOKEN','121275cYqXoH','24YvVkFX','add','default','object','prototype','required','TKvmq','__importStar','get','../errors/AppError','findOne','create','6019914crKqmH'];a=function(){return W;};return a();}function b(c,d){const e=a();return b=function(f,g){f=f-0x11b;let h=e[f];return h;},b(c,d);}const I=b,J=b;(function(c,d){const G=b,H=b,e=c();while(!![]){try{const f=-parseInt(G(0x130))/0x1*(parseInt(H(0x14d))/0x2)+parseInt(H(0x12f))/0x3*(parseInt(H(0x129))/0x4)+-parseInt(H(0x149))/0x5*(parseInt(G(0x13c))/0x6)+-parseInt(H(0x127))/0x7+parseInt(H(0x145))/0x8+-parseInt(H(0x124))/0x9+parseInt(H(0x144))/0xa;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x89022));var __createBinding=this&&this[I(0x11b)]||(Object[J(0x13b)]?function(c,d,e,f){const K=I,L=J;if(f===undefined)f=e;var g=Object[K(0x143)](d,e);(!g||(L(0x138)in g?!d['__esModule']:g[K(0x12c)]||g[L(0x14c)]))&&(g={'enumerable':!![],'get':function(){const M=K,N=K;if(M(0x141)!==N(0x142))return d[e];else throw new d[(M(0x132))](M(0x12e),0x193);}}),Object[K(0x13d)](c,f,g);}:function(c,d,e,f){if(f===undefined)f=e;c[f]=d[e];}),__setModuleDefault=this&&this[J(0x13e)]||(Object['create']?function(c,d){const O=I,P=J;Object[O(0x13d)](c,O(0x132),{'enumerable':!![],'value':d});}:function(c,d){const Q=J;c[Q(0x132)]=d;}),__importStar=this&&this[J(0x137)]||function(c){const R=J,S=I;if(c&&c[R(0x148)])return c;var d={};if(c!=null){for(var e in c)if(e!==S(0x132)&&Object[S(0x134)][R(0x125)][S(0x120)](c,e))__createBinding(d,c,e);}return __setModuleDefault(d,c),d;},__importDefault=this&&this[I(0x14b)]||function(c){const T=J;return c&&c[T(0x148)]?c:{'default':c};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[I(0x11e)]=void 0x0;const Yup=__importStar(require(I(0x13f))),AppError_1=__importDefault(require(J(0x139))),ApiConfig_1=__importDefault(require(I(0x128))),Queue_1=__importDefault(require('../libs/Queue')),sendMessageAPI=async(c,d)=>{const U=I,V=J,{tenantId:e,sessionId:f}=c['APIAuth'],{apiId:g}=c[U(0x126)],h=c[V(0x11c)],i=await ApiConfig_1[U(0x132)][U(0x13a)]({'where':{'id':g,'tenantId':e}});if(i?.['sessionId']!==f){if(V(0x122)!==U(0x122)){if(p===q)r=s;var m=t[V(0x143)](u,v);(!m||('get'in m?!w[V(0x148)]:m[U(0x12c)]||m[U(0x14c)]))&&(m={'enumerable':!![],'get':function(){return m[F];}}),z[U(0x13d)](A,B,m);}else throw new AppError_1[(U(0x132))](U(0x12e),0x193);}const j={...c[V(0x11d)],'apiId':g,'sessionId':f,'tenantId':e,'apiConfig':i,'media':h},k=Yup[U(0x133)]()[U(0x147)]({'apiId':Yup[U(0x11f)](),'sessionId':Yup[V(0x12a)](),'body':Yup[V(0x11f)]()['required'](),'number':Yup['string']()[U(0x135)](),'mediaUrl':Yup[V(0x11f)]()[U(0x146)]()['nullable']()||Yup[U(0x133)]()[V(0x147)]({'destination':Yup['string']()[V(0x135)](),'encoding':Yup[V(0x11f)]()[U(0x135)](),'fieldname':Yup[V(0x11f)]()[V(0x135)](),'filename':Yup[U(0x11f)]()['required'](),'mimetype':Yup[V(0x11f)]()['required'](),'originalname':Yup['string']()[V(0x135)](),'path':Yup[U(0x11f)]()[V(0x135)](),'size':Yup[V(0x12a)]()[U(0x135)]()}),'externalKey':Yup[U(0x11f)]()['required'](),'tenantId':Yup[V(0x12a)]()[V(0x135)]()});try{await k[U(0x140)](j);}catch(m){if(U(0x14a)!==V(0x136))throw new AppError_1['default'](m[V(0x12b)]);else{if(n&&o[V(0x148)])return p;var o={};if(q!=null){for(var p in r)if(p!==V(0x132)&&s[V(0x134)][V(0x125)][U(0x120)](t,p))u(o,v,p);}return w(o,x),o;}}return Queue_1[U(0x132)][V(0x131)]('SendMessageAPI',j),d[U(0x123)](0xc8)[U(0x12d)]({'message':V(0x121)});};exports[I(0x11e)]=sendMessageAPI;