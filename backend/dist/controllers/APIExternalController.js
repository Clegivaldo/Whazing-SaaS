'use strict';const I=b,Q=b;(function(c,d){const G=b,H=b,e=c();while(!![]){try{const f=parseInt(G(0x1bd))/0x1+-parseInt(H(0x1bb))/0x2+parseInt(G(0x1b9))/0x3+-parseInt(G(0x1ad))/0x4+-parseInt(G(0x1b4))/0x5+-parseInt(G(0x1ca))/0x6+parseInt(G(0x1c6))/0x7;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x90fb4));function b(c,d){const e=a();return b=function(f,g){f=f-0x1a3;let h=e[f];return h;},b(c,d);}var __createBinding=this&&this[I(0x1c4)]||(Object['create']?function(c,d,e,f){const J=I,K=I;if(f===undefined)f=e;var g=Object[J(0x1c2)](d,e);(!g||(J(0x1be)in g?!d[K(0x1a7)]:g[K(0x1a9)]||g[J(0x1ac)]))&&(K(0x1c7)!==J(0x1b6)?g={'enumerable':!![],'get':function(){const L=J,M=J;return L(0x1cc)===M(0x1a5)?g&&h['__esModule']?i:{'default':j}:d[e];}}:f={'enumerable':!![],'get':function(){return i[j];}}),Object['defineProperty'](c,f,g);}:function(c,d,e,f){if(f===undefined)f=e;c[f]=d[e];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(c,d){const N=I,O=I;Object[N(0x1b3)](c,N(0x1b2),{'enumerable':!![],'value':d});}:function(c,d){const P=I;c[P(0x1b2)]=d;}),__importStar=this&&this[Q(0x1b8)]||function(c){const R=Q,S=Q;if(c&&c['__esModule'])return c;var d={};if(c!=null){for(var e in c)if(e!==R(0x1b2)&&Object[R(0x1c5)][S(0x1b7)][S(0x1af)](c,e))__createBinding(d,c,e);}return __setModuleDefault(d,c),d;},__importDefault=this&&this['__importDefault']||function(c){const T=I;return c&&c[T(0x1a7)]?c:{'default':c};};Object[Q(0x1b3)](exports,I(0x1a7),{'value':!![]}),exports[Q(0x1c0)]=void 0x0;function a(){const W=['getOwnPropertyDescriptor','json','__createBinding','prototype','10927749LWBfGo','NvnxE','required','string','3865890ZudRHf','status','NfwAM','sessionId','../errors/AppError','../libs/Queue','body','yKnwC','params','__esModule','tUatY','writable','SendMessageAPI','shape','configurable','2574632WhrSEZ','object','call','APIAuth','number','default','defineProperty','5907720JLVIJQ','message','jCRKp','hasOwnProperty','__importStar','1671861hbVAKX','Message\x20add\x20queue','125650oVLEdl','url','1007792oyVxIt','get','../models/ApiConfig','sendMessageAPI','validate'];a=function(){return W;};return a();}const Yup=__importStar(require('yup')),AppError_1=__importDefault(require(I(0x1ce))),ApiConfig_1=__importDefault(require(I(0x1bf))),Queue_1=__importDefault(require(I(0x1a3))),sendMessageAPI=async(c,d)=>{const U=I,V=I,{tenantId:e,sessionId:f}=c[U(0x1b0)],{apiId:g}=c[U(0x1a6)],h=c['file'],i=await ApiConfig_1['default']['findOne']({'where':{'id':g,'tenantId':e}});if(i?.[U(0x1cd)]!==f)throw new AppError_1[(V(0x1b2))]('ERR_SESSION_NOT_AUTH_TOKEN',0x193);const j={...c[U(0x1a4)],'apiId':g,'sessionId':f,'tenantId':e,'apiConfig':i,'media':h},k=Yup[V(0x1ae)]()['shape']({'apiId':Yup[V(0x1c9)](),'sessionId':Yup[U(0x1b1)](),'body':Yup[U(0x1c9)]()[U(0x1c8)](),'number':Yup[U(0x1c9)]()[V(0x1c8)](),'mediaUrl':Yup[V(0x1c9)]()[U(0x1bc)]()['nullable']()||Yup[U(0x1ae)]()[U(0x1ab)]({'destination':Yup['string']()[V(0x1c8)](),'encoding':Yup[U(0x1c9)]()[U(0x1c8)](),'fieldname':Yup[U(0x1c9)]()['required'](),'filename':Yup['string']()['required'](),'mimetype':Yup[V(0x1c9)]()['required'](),'originalname':Yup['string']()['required'](),'path':Yup[U(0x1c9)]()[U(0x1c8)](),'size':Yup['number']()[V(0x1c8)]()}),'externalKey':Yup['string']()[U(0x1c8)](),'tenantId':Yup[V(0x1b1)]()['required']()});try{await k[U(0x1c1)](j);}catch(l){if(U(0x1a8)==='tUatY')throw new AppError_1['default'](l[U(0x1b5)]);else{if(p===q)r=s;var n=t[V(0x1c2)](u,v);(!n||(U(0x1be)in n?!w[U(0x1a7)]:n['writable']||n[V(0x1ac)]))&&(n={'enumerable':!![],'get':function(){return n[F];}}),z['defineProperty'](A,B,n);}}return Queue_1[U(0x1b2)]['add'](U(0x1aa),j),d[V(0x1cb)](0xc8)[V(0x1c3)]({'message':V(0x1ba)});};exports[I(0x1c0)]=sendMessageAPI;