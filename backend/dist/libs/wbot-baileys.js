'use strict';function a(){const Y=['makeCacheableSignalKeyStore','findIndex','qrcode','hasOwnProperty','__setModuleDefault','getIO','fetchLatestBaileysVersion','Socket\x20\x20',',\x20isLatest:\x20','readySession','__createBinding','initWASocket','3WPSqbc','join','emit','30JjWVCt','DSwvN','Browsers','close','./socket','Desktop','split','set','output','kiQVU','14098XTmRmU','__esModule','8811846yLXNCp','CONNECTED','getWbot','loggedOut','statusCode','oncqT','StartWhatsAppSession','143561txuBGZ','update','logout','../helpers/useMultiFileAuthState','connection.update','captureException','xzHwh','sessions:','isJidBroadcast','level','\x20Connection\x20Update\x20','__importDefault','../models/Whatsapp',':whatsappSession','550212qXtVim','removeWbot','ERR_WAPP_NOT_INITIALIZED','get','513868zIWNTF','tenantId','info','defineProperty','endsWith','@newsletter','splice','getOwnPropertyDescriptor','writable','lypJG','869078tMGJaA','push','2264arokGj','SJVdk','@whiskeysockets/baileys','findOne','user','node-cache','child','appropriate','DISCONNECTED','prototype','delFromPattern','log','creds.update','configurable','default','53768nADEIN','1580hMZvpW','cacheLayer','@sentry/node','error','Session\x20QRCode\x20Generate\x20','create'];a=function(){return Y;};return a();}const I=b,J=b;(function(c,d){const G=b,H=b,e=c();while(!![]){try{const f=parseInt(G(0x146))/0x1+-parseInt(H(0x13c))/0x2*(parseInt(H(0x16a))/0x3)+parseInt(G(0x157))/0x4+-parseInt(H(0x16d))/0x5*(parseInt(H(0x18e))/0x6)+-parseInt(G(0x177))/0x7*(parseInt(H(0x148))/0x8)+-parseInt(H(0x179))/0x9+-parseInt(H(0x158))/0xa*(-parseInt(G(0x180))/0xb);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x8fa58));function b(c,d){const e=a();return b=function(f,g){f=f-0x13a;let h=e[f];return h;},b(c,d);}var __createBinding=this&&this[I(0x168)]||(Object[I(0x15d)]?function(c,d,e,f){const K=I,L=J;if(f===undefined)f=e;var g=Object[K(0x143)](d,e);(!g||(L(0x13b)in g?!d[L(0x178)]:g[L(0x144)]||g[K(0x155)]))&&(L(0x17e)==='FjtFg'?(i['captureException'](j),e[K(0x153)](l),d(n)):g={'enumerable':!![],'get':function(){return d[e];}}),Object['defineProperty'](c,f,g);}:function(c,d,e,f){if(f===undefined)f=e;c[f]=d[e];}),__setModuleDefault=this&&this[I(0x162)]||(Object[I(0x15d)]?function(c,d){Object['defineProperty'](c,'default',{'enumerable':!![],'value':d});}:function(c,d){const M=J;c[M(0x156)]=d;}),__importStar=this&&this['__importStar']||function(c){const N=I,O=J;if(c&&c[N(0x178)])return c;var d={};if(c!=null){for(var e in c)if(e!==N(0x156)&&Object[N(0x151)][O(0x161)]['call'](c,e))__createBinding(d,c,e);}return __setModuleDefault(d,c),d;},__importDefault=this&&this[I(0x18b)]||function(c){return c&&c['__esModule']?c:{'default':c};};Object['defineProperty'](exports,J(0x178),{'value':!![]}),exports[J(0x169)]=exports[I(0x18f)]=exports['getWbot']=void 0x0;const Sentry=__importStar(require(I(0x15a))),baileys_1=__importStar(require(I(0x14a))),Whatsapp_1=__importDefault(require(I(0x18c))),logger_1=__importDefault(require('@whiskeysockets/baileys/lib/Utils/logger')),useMultiFileAuthState_1=require(J(0x183)),AppError_1=__importDefault(require('../errors/AppError')),node_cache_1=__importDefault(require(J(0x14d))),socket_1=require(I(0x171)),StartWhatsAppSession_1=require('../services/WbotServices/StartWhatsAppSession'),cache_1=require('./cache'),loggerBaileys=logger_1[I(0x156)][I(0x14e)]({}),logger=logger_1[I(0x156)][J(0x14e)]({});loggerBaileys[J(0x189)]='error';const sessions=[],retriesQrCodeMap=new Map(),getWbot=c=>{const P=J,Q=I,d=sessions['findIndex'](e=>e['id']===c);if(d===-0x1)throw new AppError_1[(P(0x156))](Q(0x13a));return sessions[d];};exports[I(0x17b)]=getWbot;const removeWbot=async(c,d=!![])=>{const R=I,S=I;try{const e=sessions[R(0x15f)](f=>f['id']===c);if(e!==-0x1){if(S(0x149)!=='SJVdk'){if(p===q)r=s;var g=t[R(0x143)](u,v);(!g||(S(0x13b)in g?!w['__esModule']:g[R(0x144)]||g[S(0x155)]))&&(g={'enumerable':!![],'get':function(){return g[F];}}),z[R(0x13f)](A,B,g);}else d&&(sessions[e][S(0x182)](),sessions[e]['ws'][R(0x170)]()),sessions[S(0x142)](e,0x1);}}catch(g){logger[R(0x15b)](g);}};exports['removeWbot']=removeWbot;const initWASocket=async c=>{return new Promise(async(d,e)=>{const X=b;try{((async()=>{const T=b,U=b;if(T(0x176)==='SVRlE'){if(k===l)m=n;o[p]=q[r];}else{const g=(0x0,socket_1[U(0x163)])(),h=await Whatsapp_1[T(0x156)][T(0x14b)]({'where':{'id':c['id']}});if(!h)return;const {id:i,name:j}=h,{version:k,isLatest:l}=await(0x0,baileys_1[U(0x164)])();logger[U(0x13e)]('using\x20WA\x20v'+k[T(0x16b)]('.')+T(0x166)+l),logger[T(0x13e)]('Starting\x20session\x20'+j);let m=0x0,n=null;const {state:o,saveCreds:p}=await(0x0,useMultiFileAuthState_1['useMultiFileAuthState'])(c),q=new node_cache_1[(T(0x156))](),r=new node_cache_1['default']();n=(0x0,baileys_1[T(0x156)])({'logger':loggerBaileys,'printQRInTerminal':![],'browser':baileys_1[U(0x16f)][T(0x14f)](T(0x172)),'auth':{'creds':o['creds'],'keys':(0x0,baileys_1[T(0x15e)])(o['keys'],loggerBaileys)},'version':k,'defaultQueryTimeoutMs':0xea60,'msgRetryCounterCache':q,'generateHighQualityLinkPreview':!![],'userDevicesCache':r,'shouldIgnoreJid':s=>(0x0,baileys_1[T(0x188)])(s)||s?.[U(0x140)](T(0x141)),'transactionOpts':{'maxCommitRetries':0x1,'delayBetweenTriesMs':0xa}}),n['ev']['on'](T(0x184),async({connection:s,lastDisconnect:t,qr:u})=>{const V=U,W=U;if(V(0x186)===W(0x186)){logger['info'](V(0x165)+j+V(0x18a)+(s||'')+'\x20'+(t||''));s===W(0x170)&&(t?.[W(0x15b)]?.[V(0x175)]?.['statusCode']===0x193&&(await c[V(0x181)]({'status':'PENDING','session':''}),await cache_1[W(0x159)][W(0x152)]('sessions:'+c['id']+':*'),g[V(0x16c)](c[W(0x13d)]+W(0x18d),{'action':W(0x181),'session':c}),(0x0,exports[V(0x18f)])(i,![])),t?.['error']?.[V(0x175)]?.[V(0x17d)]!==baileys_1['DisconnectReason'][W(0x17c)]?((0x0,exports['removeWbot'])(i,![]),setTimeout(()=>(0x0,StartWhatsAppSession_1['StartWhatsAppSession'])(c),0x7d0)):(await c[W(0x181)]({'status':'PENDING','session':''}),await cache_1[W(0x159)][V(0x152)](V(0x187)+c['id']+':*'),g[V(0x16c)](c[V(0x13d)]+':whatsappSession',{'action':W(0x181),'session':c}),(0x0,exports[V(0x18f)])(i,![]),setTimeout(()=>(0x0,StartWhatsAppSession_1[V(0x17f)])(c),0x7d0)));if(s==='open'){const v=n[W(0x14c)];let w=v['id'][W(0x173)]('@')[0x0];w=w[V(0x173)](':')[0x0],await c[W(0x181)]({'status':W(0x17a),'qrcode':'','number':w,'retries':0x0}),g[V(0x16c)](c[W(0x13d)]+W(0x18d),{'action':W(0x181),'session':c}),g[V(0x16c)](c[V(0x13d)]+':whatsappSession',{'action':V(0x167),'session':c});const x=sessions[W(0x15f)](y=>y['id']===c['id']);x===-0x1&&(n['id']=c['id'],sessions[W(0x147)](n)),d(n);}if(u!==undefined){if(retriesQrCodeMap[V(0x13b)](i)&&retriesQrCodeMap[V(0x13b)](i)>=0x3)await h['update']({'status':W(0x150),'qrcode':''}),await cache_1['cacheLayer'][V(0x152)]('sessions:'+c['id']+':*'),g[W(0x16c)](c[V(0x13d)]+W(0x18d),{'action':W(0x181),'session':h}),n['ev']['removeAllListeners'](V(0x184)),n['ws'][V(0x170)](),n=null,retriesQrCodeMap['delete'](i);else{logger[W(0x13e)](V(0x15c)+j),retriesQrCodeMap[W(0x174)](i,m+=0x1),await c['update']({'qrcode':u,'status':V(0x160),'retries':0x0});const y=sessions[V(0x15f)](z=>z['id']===c['id']);y===-0x1&&(W(0x16e)===V(0x145)?f={'enumerable':!![],'get':function(){return i[j];}}:(n['id']=c['id'],sessions['push'](n))),g['emit'](c[V(0x13d)]+W(0x18d),{'action':V(0x181),'session':c});}}}else g[h][W(0x182)](),i[j]['ws'][W(0x170)]();}),n['ev']['on'](T(0x154),p);}})());}catch(f){Sentry[X(0x185)](f),console['log'](f),e(f);}});};exports[I(0x169)]=initWASocket;