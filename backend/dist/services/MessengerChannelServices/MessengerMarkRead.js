'use strict';const n=b,o=b;(function(c,d){const k=b,l=b,e=c();while(!![]){try{const f=-parseInt(k(0x1c7))/0x1+parseInt(k(0x1c1))/0x2+parseInt(l(0x1bf))/0x3*(-parseInt(k(0x1cc))/0x4)+-parseInt(k(0x1d0))/0x5+parseInt(k(0x1cd))/0x6+-parseInt(l(0x1c0))/0x7*(-parseInt(k(0x1c4))/0x8)+parseInt(l(0x1c6))/0x9;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x6abe4));function b(c,d){const e=a();return b=function(f,g){f=f-0x1bc;let h=e[f];return h;},b(c,d);}var __importDefault=this&&this['__importDefault']||function(c){const m=b;return c&&c[m(0x1c8)]?c:{'default':c};};Object[n(0x1cb)](exports,n(0x1c8),{'value':!![]});const sequelize_1=require(o(0x1bc)),socketEmit_1=__importDefault(require(o(0x1be))),Contact_1=__importDefault(require('../../models/Contact')),Message_1=__importDefault(require(n(0x1c5))),Ticket_1=__importDefault(require(o(0x1d2))),MessengerMarkRead=async(c,d)=>{const p=n,q=n,e=await Message_1[p(0x1d1)][p(0x1ca)]({'where':{'tenantId':d,'createdAt':{[sequelize_1['Op'][q(0x1bd)]]:new Date(c[p(0x1cf)][p(0x1c2)])},'fromMe':!![],'ack':{[sequelize_1['Op']['in']]:[0x1,0x2]}},'include':[{'model':Ticket_1[p(0x1d1)],'where':{'tenantId':d},'include':[{'model':Contact_1['default'],'where':{'tenantId':d,'messengerId':c['sender']['id']}}]}]});await Promise['all'](e['map'](async f=>{const r=p,s=q;await f[r(0x1ce)]({'ack':0x3}),(0x0,socketEmit_1[s(0x1d1)])({'tenantId':d,'type':'chat:ack','payload':{...f['dataValues'],'mediaUrl':f['mediaUrl'],'id':f['id'],'timestamp':f[s(0x1c9)],'messageId':f[r(0x1c3)],'status':'sended','ack':0x3}});}));};function a(){const t=['watermark','messageId','2136alvduA','../../models/Message','4288896xxvpAP','686476HrbDgN','__esModule','timestamp','findAll','defineProperty','15476HXbKES','1837758HTLEPm','update','read','619530PJAqTe','default','../../models/Ticket','sequelize','lte','../../helpers/socketEmit','219xixkOt','16436WVTmgU','240572cnxsll'];a=function(){return t;};return a();}exports['default']=MessengerMarkRead;