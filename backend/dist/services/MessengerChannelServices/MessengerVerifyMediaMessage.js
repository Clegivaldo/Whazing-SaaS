'use strict';
function a() {
    const S = [
        'GfBTj',
        'GET',
        'zXgJD',
        'vgeLY',
        'url',
        'cZXpr',
        'all',
        'pipe',
        'message_id',
        'finish',
        'VpRMU',
        'method',
        '__esModule',
        'path',
        'tenantId',
        'public',
        'feXdC',
        'EqURL',
        'createWrit',
        'erty',
        'type',
        '185616neGKZD',
        'axios',
        'split',
        'reply_to',
        'wciMQ',
        'mid',
        '__importDe',
        'messageDat',
        'update',
        'EuTlK',
        'message',
        '708548nnIdXE',
        'content-di',
        '15732mYPMPF',
        'NEoTK',
        'kpTTF',
        'fuSOT',
        '1337fCkXqO',
        '1139109qsDbez',
        'parameters',
        'error',
        'join',
        'MwOMH',
        'text',
        'DPmnz',
        'fromMe',
        'LOAD',
        'IlFZZ',
        'ageId',
        'rKfmI',
        'EuDkP',
        'sposition',
        'timestamp',
        'stream',
        '../../help',
        'DMREZ',
        'received',
        'vQuHt',
        'reateMessa',
        'gCRxx',
        'attachment',
        'TwplS',
        'geService',
        'data',
        '278280CVJWWo',
        'BizAc',
        '../Message',
        '1671428vkJvvO',
        'map',
        'tedForMess',
        'filename',
        'payload',
        'defineProp',
        'fault',
        'headers',
        'YpZBd',
        'qrNLK',
        'default',
        'parse',
        'BMTEX',
        'MvFte',
        'eKMsl',
        'avRVa',
        'VWjgV',
        'Services/C',
        'value',
        'hXfUe',
        'content-ty',
        'ERROR\x20DONW',
        'eStream',
        'getTime',
        'dLWwB',
        'RzQnt',
        '1545750vRLKdm',
        'ers/getQuo',
        'responseTy'
    ];
    a = function () {
        return S;
    };
    return a();
}
const C = b, D = b;
(function (c, d) {
    const A = b, B = b, e = c();
    while (!![]) {
        try {
            const f = -parseInt(A(0x228)) / (0x1b * 0x4a + -0x86 * -0x47 + -0x2cf7) + parseInt(B(0x207)) / (0x9 * 0x239 + -0x397 * -0x2 + -0x1b2d) + parseInt(A(0x20e)) / (0xd5c + -0x6a + -0xcef) + -parseInt(B(0x22b)) / (0x45 * -0x7a + -0xc09 + 0x2cef) + -parseInt(A(0x1e4)) / (0x2628 + 0x336 + -0x2959) + parseInt(A(0x209)) / (-0x8d0 + -0x1aaf + -0x3 * -0xbd7) * (parseInt(A(0x20d)) / (-0x22aa + -0x2 * -0x3ac + 0x1b59)) + parseInt(B(0x1fc)) / (-0x6c6 + -0xec6 + 0x1594);
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, 0x7544d + 0x1f83d + -0x57174));
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (-0x1b91 + 0x115b * 0x1 + 0xc13);
        let h = e[f];
        return h;
    }, b(c, d);
}
var __importDefault = this && this[C(0x202) + D(0x231)] || function (c) {
    const E = D;
    return c && c[E(0x1f3)] ? c : { 'default': c };
};
const w = {};
w[D(0x23d)] = !![], Object[C(0x230) + C(0x1fa)](exports, C(0x1f3), w);
const path_1 = require(D(0x1f4)), axios_1 = __importDefault(require(C(0x1fd))), fs_1 = require('fs'), content_disposition_1 = __importDefault(require(C(0x208) + C(0x21b))), CreateMessageService_1 = __importDefault(require(D(0x22a) + D(0x23c) + C(0x222) + C(0x226))), getQuotedForMessageId_1 = __importDefault(require(C(0x21e) + C(0x1e5) + D(0x22d) + D(0x218))), downloadFile = async (e, f) => {
        const F = D, G = D, g = {
                'MvFte': F(0x1df) + F(0x216),
                'DPmnz': function (o, p) {
                    return o(p);
                },
                'cZXpr': F(0x1f0),
                'BizAc': F(0x210),
                'EqURL': F(0x1de) + 'pe',
                'qrNLK': function (o, p) {
                    return o === p;
                },
                'gCRxx': G(0x1e9),
                'vgeLY': function (o, p) {
                    return o(p);
                },
                'TwplS': function (o, p) {
                    return o !== p;
                },
                'MwOMH': G(0x217),
                'DMREZ': F(0x1e8),
                'fuSOT': G(0x21d),
                'dLWwB': G(0x208) + F(0x21b),
                'avRVa': function (o, p) {
                    return o === p;
                },
                'EuTlK': F(0x237),
                'feXdC': F(0x1dd),
                'GfBTj': function (o, p) {
                    return o !== p;
                },
                'eKMsl': G(0x219),
                'NEoTK': F(0x1f6)
            }, h = {};
        h[G(0x1eb)] = e, h[G(0x1f2)] = g[G(0x21f)], h[G(0x1e6) + 'pe'] = g[G(0x20c)];
        const i = await (0x2289 + 0x23f * 0x1 + -0x24c8, axios_1[G(0x235)])(h), j = {};
        j[G(0x20f)] = {};
        const k = i[F(0x232)][g[F(0x1e2)]] ? content_disposition_1[G(0x235)][G(0x236)](i[G(0x232)][g[G(0x1e2)]] || '') : j;
        let l = '';
        const m = k?.[F(0x20f)]?.[F(0x22e)];
        if (m) {
            if (g[F(0x23a)](g[F(0x205)], g[F(0x1f7)])) {
                const p = {};
                return p[G(0x235)] = j, g && h[G(0x1f3)] ? i : p;
            } else {
                const p = k[G(0x20f)][G(0x22e)];
                l = new Date()[G(0x1e1)]() + '-' + p;
            }
        } else {
            if (g[F(0x1e7)](g[G(0x239)], g[G(0x239)]))
                k[G(0x227)][F(0x1ee)]((-0x2e * 0x97 + -0x323 * -0x1 + -0x1 * -0x17ff, l[G(0x1f9) + G(0x1e0)])(m))['on'](g[G(0x1ec)], async () => s(t))['on'](g[F(0x229)], x => {
                    const H = F, I = G;
                    s[H(0x210)](g[H(0x238)], x), g[I(0x214)](t, new u(x));
                });
            else {
                const r = i[G(0x232)][g[F(0x1f8)]], s = r[F(0x1fe)]('/')[-0x2ee * 0xa + 0x1 * -0x24fa + -0x37d * -0x13];
                l = f + '-' + new Date()[F(0x1e1)]() + '.' + s;
            }
        }
        const n = (0x29 * -0x99 + 0x53 * 0x10 + 0x1351, path_1[G(0x211)])(__dirname, '..', '..', '..', g[G(0x20a)], l);
        return await new Promise((t, u) => {
            const J = G, L = G, v = {
                    'VpRMU': g[J(0x238)],
                    'kpTTF': function (x, y) {
                        const K = J;
                        return g[K(0x1ea)](x, y);
                    }
                };
            if (g[J(0x225)](g[J(0x212)], g[L(0x212)])) {
                const y = g[L(0x232)][g[J(0x1f8)]], z = y[L(0x1fe)]('/')[-0x6ac + -0x887 + -0x8b * -0x1c];
                h = i + '-' + new j()[L(0x1e1)]() + '.' + z;
            } else
                i[L(0x227)][J(0x1ee)]((0x11dd * 0x2 + -0x1 * -0x207b + -0x4435, fs_1[J(0x1f9) + J(0x1e0)])(n))['on'](g[L(0x1ec)], async () => t(l))['on'](g[L(0x229)], y => {
                    const M = J, N = L;
                    g[M(0x234)](g[M(0x223)], g[M(0x223)]) ? (console[M(0x210)](g[M(0x238)], y), g[M(0x214)](u, new Error(y))) : (h[M(0x210)](v[N(0x1f1)], i), v[N(0x20b)](j, new k(l)));
                });
        }), l;
    }, MessengerVerifyMediaMessage = async (c, d, e, f) => {
        const O = D, P = D, g = {
                'RzQnt': function (i, j, k) {
                    return i(j, k);
                },
                'YpZBd': function (i, j) {
                    return i === j;
                },
                'wciMQ': O(0x23b),
                'vQuHt': function (i, j) {
                    return i > j;
                },
                'EuDkP': O(0x220)
            };
        let h;
        await Promise[P(0x1ed)](d[P(0x206)][O(0x224) + 's'][O(0x22c)](async (i, j) => {
            const Q = O, R = P, k = e['id'] + '_' + d[Q(0x1ef)];
            h = await g[Q(0x1e3)](downloadFile, i[Q(0x22f)][R(0x1eb)], k);
            let l;
            if (d?.[R(0x206)]?.[Q(0x1ff)]?.[Q(0x201)]) {
                if (g[Q(0x233)](g[R(0x200)], g[Q(0x200)])) {
                    const o = await (-0x115e + 0x5 * 0x6e6 + 0x4 * -0x448, getQuotedForMessageId_1[Q(0x235)])(d[Q(0x206)][R(0x1ff)][R(0x201)], e[Q(0x1f5)]);
                    l = o?.['id'] || undefined;
                } else {
                    const q = f[R(0x20f)][Q(0x22e)];
                    g = new h()[R(0x1e1)]() + '-' + q;
                }
            }
            const m = {
                'messageId': g[Q(0x221)](j, -0xb31 + 0x2464 + 0x1933 * -0x1) ? d[R(0x1ef)] + '__' + j : d[Q(0x1ef)] || '',
                'ticketId': e['id'],
                'contactId': f['id'],
                'body': d[R(0x206)]?.[R(0x213)] || '',
                'fromMe': d[Q(0x215)],
                'read': ![],
                'mediaUrl': h,
                'mediaType': d[R(0x1fb)],
                'quotedMsgId': l,
                'timestamp': +d[R(0x21c)],
                'status': g[R(0x21a)]
            };
            await e[R(0x204)]({
                'lastMessage': d[Q(0x206)]?.[R(0x213)] || h || '',
                'lastMessageAt': new Date()[Q(0x1e1)](),
                'answered': ![]
            });
            const n = {};
            n[R(0x203) + 'a'] = m, n[R(0x1f5)] = e[Q(0x1f5)], await (0x2467 * -0x1 + -0xb8c + 0x2ff3, CreateMessageService_1[Q(0x235)])(n);
        }));
    };
exports[C(0x235)] = MessengerVerifyMediaMessage;