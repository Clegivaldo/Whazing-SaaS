'use strict';
const _0x5f5687 = _0x3a02;
(function (_0x2e4783, _0x14ff57) {
    const _0x1bae46 = _0x3a02, _0x1566c2 = _0x2e4783();
    while (!![]) {
        try {
            const _0x170242 = -parseInt(_0x1bae46(0x93)) / (-0x976 + -0x1b79 + 0x6 * 0x628) + -parseInt(_0x1bae46(0x7b)) / (0x881 * -0x4 + -0x31d * -0x5 + 0x1 * 0x1275) * (parseInt(_0x1bae46(0x76)) / (-0x998 * 0x1 + 0x234d + 0x12b * -0x16)) + -parseInt(_0x1bae46(0x95)) / (-0x6b * -0x29 + -0x141 * -0x2 + -0x13a1) + parseInt(_0x1bae46(0xaf)) / (-0x8f9 + 0x1 * -0x17 + 0x915) * (parseInt(_0x1bae46(0x9c)) / (-0xb8d * 0x1 + 0xa60 + 0x133 * 0x1)) + -parseInt(_0x1bae46(0xb6)) / (-0x23d4 + -0xc65 + 0x3040) + parseInt(_0x1bae46(0xa2)) / (0x1dca + 0x108f + -0x2e51) * (-parseInt(_0x1bae46(0xa1)) / (-0x1 * -0x1c06 + -0x1df * -0x3 + -0x219a)) + parseInt(_0x1bae46(0x9b)) / (-0x94f + -0x1352 + 0x1cab);
            if (_0x170242 === _0x14ff57)
                break;
            else
                _0x1566c2['push'](_0x1566c2['shift']());
        } catch (_0x17e6b7) {
            _0x1566c2['push'](_0x1566c2['shift']());
        }
    }
}(_0x4006, -0x9240f + -0x6853b + 0x4 * 0x51dfd));
var __importDefault = this && this[_0x5f5687(0xbc) + _0x5f5687(0x8c)] || function (_0xf4a7e3) {
    const _0x3aa738 = _0x5f5687;
    return _0xf4a7e3 && _0xf4a7e3[_0x3aa738(0xa4)] ? _0xf4a7e3 : { 'default': _0xf4a7e3 };
};
const _0x51c82e = {};
_0x51c82e[_0x5f5687(0xbe)] = !![], Object[_0x5f5687(0xc0) + _0x5f5687(0x8a)](exports, _0x5f5687(0xa4), _0x51c82e);
function _0x3a02(_0x5878b2, _0x400e60) {
    const _0x29b6db = _0x4006();
    return _0x3a02 = function (_0x2636a6, _0x13286a) {
        _0x2636a6 = _0x2636a6 - (0x18bd + 0x1f * 0x107 + 0x3821 * -0x1);
        let _0x2a46eb = _0x29b6db[_0x2636a6];
        return _0x2a46eb;
    }, _0x3a02(_0x5878b2, _0x400e60);
}
function _0x4006() {
    const _0x1d0d89 = [
        'type',
        '__importDe',
        'responseTy',
        'value',
        'GET',
        'defineProp',
        'messageDat',
        'data',
        'join',
        'content-ty',
        'default',
        'reply_to',
        '905535FeJAix',
        'received',
        'message',
        'eStream',
        'LnuYJ',
        '2zgceUH',
        'parse',
        'OGrRW',
        'uiyLT',
        'bsukA',
        'createWrit',
        'ENTQf',
        'text',
        'headers',
        'HbSQx',
        'all',
        'sposition',
        'ageId',
        'geService',
        'message_id',
        'erty',
        'LOAD',
        'fault',
        'tenantId',
        'mYPwl',
        'error',
        'pubQK',
        'tedForMess',
        'split',
        '120997KJwYVh',
        'update',
        '1923520SOrNBb',
        'timestamp',
        'finish',
        'pXhuW',
        'url',
        'path',
        '14826300FWcJyT',
        '6nhwdbd',
        'ERROR\x20DONW',
        'zDSNG',
        'Services/C',
        'zXByY',
        '18zzspID',
        '1408168nyqTqb',
        'filename',
        '__esModule',
        'mid',
        'content-di',
        'ZFQnr',
        'attachment',
        '../Message',
        'payload',
        'pipe',
        'GqoEc',
        'parameters',
        'fromMe',
        '736885WaVlYw',
        'method',
        'getTime',
        'axios',
        '../../help',
        'nkyCd',
        'ers/getQuo',
        '414351MXUKjI',
        'stream',
        'map',
        'public',
        'reateMessa'
    ];
    _0x4006 = function () {
        return _0x1d0d89;
    };
    return _0x4006();
}
const path_1 = require(_0x5f5687(0x9a)), axios_1 = __importDefault(require(_0x5f5687(0xb2))), fs_1 = require('fs'), content_disposition_1 = __importDefault(require(_0x5f5687(0xa6) + _0x5f5687(0x86))), CreateMessageService_1 = __importDefault(require(_0x5f5687(0xa9) + _0x5f5687(0x9f) + _0x5f5687(0xba) + _0x5f5687(0x88))), getQuotedForMessageId_1 = __importDefault(require(_0x5f5687(0xb3) + _0x5f5687(0xb5) + _0x5f5687(0x91) + _0x5f5687(0x87))), downloadFile = async (_0x280ffc, _0x3bfb96) => {
        const _0x516bcd = _0x5f5687, _0x1ea052 = {
                'OGrRW': _0x516bcd(0x9d) + _0x516bcd(0x8b),
                'LnuYJ': function (_0x34ef07, _0x265e0b) {
                    return _0x34ef07(_0x265e0b);
                },
                'ENTQf': _0x516bcd(0x97),
                'GqoEc': _0x516bcd(0x8f),
                'uiyLT': _0x516bcd(0xbf),
                'zDSNG': _0x516bcd(0xb7),
                'HbSQx': _0x516bcd(0xa6) + _0x516bcd(0x86),
                'bsukA': _0x516bcd(0xc4) + 'pe',
                'mYPwl': _0x516bcd(0xb9)
            }, _0x114851 = {};
        _0x114851[_0x516bcd(0x99)] = _0x280ffc, _0x114851[_0x516bcd(0xb0)] = _0x1ea052[_0x516bcd(0x7e)], _0x114851[_0x516bcd(0xbd) + 'pe'] = _0x1ea052[_0x516bcd(0x9e)];
        const _0x2a2107 = await (-0x18d9 * 0x1 + -0x19f0 + 0x32c9, axios_1[_0x516bcd(0xc5)])(_0x114851), _0x25b27e = {};
        _0x25b27e[_0x516bcd(0xad)] = {};
        const _0x2c8b26 = _0x2a2107[_0x516bcd(0x83)][_0x1ea052[_0x516bcd(0x84)]] ? content_disposition_1[_0x516bcd(0xc5)][_0x516bcd(0x7c)](_0x2a2107[_0x516bcd(0x83)][_0x1ea052[_0x516bcd(0x84)]] || '') : _0x25b27e;
        let _0x500256 = '';
        const _0x4c63d1 = _0x2c8b26?.[_0x516bcd(0xad)]?.[_0x516bcd(0xa3)];
        if (_0x4c63d1) {
            const _0x2b4877 = _0x2c8b26[_0x516bcd(0xad)][_0x516bcd(0xa3)];
            _0x500256 = new Date()[_0x516bcd(0xb1)]() + '-' + _0x2b4877;
        } else {
            const _0x3b7766 = _0x2a2107[_0x516bcd(0x83)][_0x1ea052[_0x516bcd(0x7f)]], _0x414d4f = _0x3b7766[_0x516bcd(0x92)]('/')[-0x64 * 0x7 + 0x2162 * 0x1 + 0x5 * -0x621];
            _0x500256 = _0x3bfb96 + '-' + new Date()[_0x516bcd(0xb1)]() + '.' + _0x414d4f;
        }
        const _0x367140 = (-0x11a3 + 0x2bd * -0x1 + 0x1460, path_1[_0x516bcd(0xc3)])(__dirname, '..', '..', '..', _0x1ea052[_0x516bcd(0x8e)], _0x500256);
        return await new Promise((_0x20d800, _0x41f2fc) => {
            const _0x56778f = _0x516bcd, _0x220977 = {
                    'nkyCd': _0x1ea052[_0x56778f(0x7d)],
                    'pXhuW': function (_0x2ddf56, _0x5a11b1) {
                        const _0x41ff33 = _0x56778f;
                        return _0x1ea052[_0x41ff33(0x7a)](_0x2ddf56, _0x5a11b1);
                    }
                };
            _0x2a2107[_0x56778f(0xc2)][_0x56778f(0xab)]((0x237d + -0x4bd + -0x1ec0, fs_1[_0x56778f(0x80) + _0x56778f(0x79)])(_0x367140))['on'](_0x1ea052[_0x56778f(0x81)], async () => _0x20d800(_0x500256))['on'](_0x1ea052[_0x56778f(0xac)], _0x39d744 => {
                const _0x5a5ba2 = _0x56778f;
                console[_0x5a5ba2(0x8f)](_0x220977[_0x5a5ba2(0xb4)], _0x39d744), _0x220977[_0x5a5ba2(0x98)](_0x41f2fc, new Error(_0x39d744));
            });
        }), _0x500256;
    }, MessengerVerifyMediaMessage = async (_0xf931ac, _0x29f85a, _0x2947ff, _0x273742) => {
        const _0x1224ce = _0x5f5687, _0x4819cf = {
                'zXByY': function (_0x3d81bd, _0x13d7bb, _0x38f10c) {
                    return _0x3d81bd(_0x13d7bb, _0x38f10c);
                },
                'pubQK': function (_0x522c04, _0x175e0a) {
                    return _0x522c04 > _0x175e0a;
                },
                'ZFQnr': _0x1224ce(0x77)
            };
        let _0x4b6657;
        await Promise[_0x1224ce(0x85)](_0x29f85a[_0x1224ce(0x78)][_0x1224ce(0xa8) + 's'][_0x1224ce(0xb8)](async (_0x79f4fe, _0x1cec61) => {
            const _0x1fcbcc = _0x1224ce, _0x10f0aa = _0x2947ff['id'] + '_' + _0x29f85a[_0x1fcbcc(0x89)];
            _0x4b6657 = await _0x4819cf[_0x1fcbcc(0xa0)](downloadFile, _0x79f4fe[_0x1fcbcc(0xaa)][_0x1fcbcc(0x99)], _0x10f0aa);
            let _0x117364;
            if (_0x29f85a?.[_0x1fcbcc(0x78)]?.[_0x1fcbcc(0x75)]?.[_0x1fcbcc(0xa5)]) {
                const _0xb2787e = await (-0x2 * -0x549 + -0x2 * -0x5ca + 0x1626 * -0x1, getQuotedForMessageId_1[_0x1fcbcc(0xc5)])(_0x29f85a[_0x1fcbcc(0x78)][_0x1fcbcc(0x75)][_0x1fcbcc(0xa5)], _0x2947ff[_0x1fcbcc(0x8d)]);
                _0x117364 = _0xb2787e?.['id'] || undefined;
            }
            const _0x35efdf = {
                'messageId': _0x4819cf[_0x1fcbcc(0x90)](_0x1cec61, -0x1679 + -0x99 * -0x35 + -0x4c * 0x1f) ? _0x29f85a[_0x1fcbcc(0x89)] + '__' + _0x1cec61 : _0x29f85a[_0x1fcbcc(0x89)] || '',
                'ticketId': _0x2947ff['id'],
                'contactId': _0x273742['id'],
                'body': _0x29f85a[_0x1fcbcc(0x78)]?.[_0x1fcbcc(0x82)] || '',
                'fromMe': _0x29f85a[_0x1fcbcc(0xae)],
                'read': ![],
                'mediaUrl': _0x4b6657,
                'mediaType': _0x29f85a[_0x1fcbcc(0xbb)],
                'quotedMsgId': _0x117364,
                'timestamp': +_0x29f85a[_0x1fcbcc(0x96)],
                'status': _0x4819cf[_0x1fcbcc(0xa7)]
            };
            await _0x2947ff[_0x1fcbcc(0x94)]({
                'lastMessage': _0x29f85a[_0x1fcbcc(0x78)]?.[_0x1fcbcc(0x82)] || _0x4b6657 || '',
                'lastMessageAt': new Date()[_0x1fcbcc(0xb1)](),
                'answered': ![]
            });
            const _0x282817 = {};
            _0x282817[_0x1fcbcc(0xc1) + 'a'] = _0x35efdf, _0x282817[_0x1fcbcc(0x8d)] = _0x2947ff[_0x1fcbcc(0x8d)], await (-0x71 * -0x9 + -0x1502 + 0x1109, CreateMessageService_1[_0x1fcbcc(0xc5)])(_0x282817);
        }));
    };
exports[_0x5f5687(0xc5)] = MessengerVerifyMediaMessage;