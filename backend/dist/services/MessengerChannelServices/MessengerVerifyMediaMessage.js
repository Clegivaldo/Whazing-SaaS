'use strict';
function a() {
    const V = [
        'CQKas',
        '39813yjKWJI',
        'IxPDA',
        '12nPwIex',
        'geService',
        'ERROR\x20DONW',
        'ers/getQuo',
        'value',
        'fAVDE',
        '5mzmHaP',
        '55748YBdiZS',
        'pipe',
        'gMkRZ',
        'fromMe',
        'stream',
        'timestamp',
        'mid',
        '__importDe',
        'text',
        'attachment',
        'error',
        'AMxRZ',
        '1981480MNCaQq',
        'type',
        'url',
        'jqPGx',
        'xrWzQ',
        'lDDOE',
        '23710DbyjLn',
        'content-ty',
        'message_id',
        'method',
        'messageDat',
        'dgxix',
        'update',
        'reateMessa',
        'createWrit',
        'mOcmR',
        'xbYvS',
        'tDPlK',
        'QqZaG',
        '1125huFkGG',
        'reply_to',
        'parameters',
        'defineProp',
        'parse',
        'Services/C',
        'headers',
        'NrwvO',
        'map',
        'axios',
        'WItVx',
        'message',
        'fhnvJ',
        'join',
        'bpjsJ',
        'fault',
        'responseTy',
        'YGdSJ',
        'eStream',
        'GIWIc',
        'erty',
        'YjaAN',
        'ywtZK',
        'GET',
        '7623759qGIvBw',
        'sposition',
        'finish',
        'JDHHo',
        'fcSIh',
        'default',
        '../Message',
        'split',
        'getTime',
        'KgjfR',
        'ageId',
        'QIOrG',
        'payload',
        'content-di',
        'nZWat',
        '744HLptUP',
        '2337474JAKCqX',
        'UwZmQ',
        'all',
        'data',
        'path',
        '2qoztOe',
        'MsOhF',
        '../../help',
        'LDbcx',
        'GEuFD',
        'tedForMess',
        'filename',
        'irhog',
        'PfYNW',
        'LOAD',
        'tenantId',
        'public',
        '4077188GaATvF',
        'HmZkY',
        'vOWze',
        'AAwbw',
        '__esModule',
        'received'
    ];
    a = function () {
        return V;
    };
    return a();
}
const D = b, E = b;
(function (c, d) {
    const B = b, C = b, e = c();
    while (!![]) {
        try {
            const f = parseInt(B(0x1b4)) / (0x1 * 0x10b9 + -0x21e9 * 0x1 + 0x1131) + -parseInt(B(0x209)) / (0x2527 * -0x1 + 0x1 * 0x1147 + 0x13e2) * (parseInt(C(0x204)) / (0x1ee5 + 0x1c65 + -0x3b47)) + parseInt(B(0x1ad)) / (0x1 * 0x671 + 0xbfe + -0x126b) * (parseInt(C(0x1bc)) / (-0xe59 + -0x5e5 + 0x1443)) + -parseInt(B(0x203)) / (-0x19b1 + 0x781 + 0x1236) * (parseInt(B(0x1bd)) / (0xc78 + -0x115e + 0x4ed * 0x1)) + parseInt(C(0x1c9)) / (-0x1b1e + -0x5f * 0x3 + 0x1c43) + parseInt(C(0x1dc)) / (0x15be + 0x1eed + -0x1a51 * 0x2) * (parseInt(C(0x1cf)) / (0x24f8 + 0x19a6 + -0x3e94)) + parseInt(C(0x1f4)) / (0x13c3 + -0x1df9 * -0x1 + -0x31b1 * 0x1) * (parseInt(B(0x1b6)) / (0x7f8 + 0x1 * 0x1c2b + -0x2417 * 0x1));
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, -0x98eb2 + 0xf3527 + 0x26e14 * 0x1));
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (-0x114e + -0xba7 + 0x1ea1);
        let h = e[f];
        return h;
    }, b(c, d);
}
var __importDefault = this && this[D(0x1c4) + D(0x1eb)] || function (c) {
    const F = D;
    return c && c[F(0x1b1)] ? c : { 'default': c };
};
const w = {};
w[D(0x1ba)] = !![], Object[D(0x1df) + E(0x1f0)](exports, D(0x1b1), w);
const path_1 = require(E(0x208)), axios_1 = __importDefault(require(D(0x1e5))), fs_1 = require('fs'), content_disposition_1 = __importDefault(require(D(0x201) + D(0x1f5))), CreateMessageService_1 = __importDefault(require(D(0x1fa) + D(0x1e1) + D(0x1d6) + D(0x1b7))), getQuotedForMessageId_1 = __importDefault(require(D(0x20b) + D(0x1b9) + E(0x20e) + E(0x1fe))), downloadFile = async (e, f) => {
        const G = E, H = E, g = {
                'jqPGx': G(0x1d0) + 'pe',
                'AMxRZ': H(0x1b8) + H(0x212),
                'vOWze': function (o, p) {
                    return o(p);
                },
                'nZWat': H(0x1f6),
                'CQKas': G(0x1c7),
                'GIWIc': function (o, p) {
                    return o !== p;
                },
                'WItVx': G(0x1ed),
                'lDDOE': H(0x1f3),
                'dgxix': H(0x1c1),
                'QIOrG': G(0x201) + G(0x1f5),
                'irhog': function (o, p) {
                    return o === p;
                },
                'IxPDA': G(0x1f8),
                'xrWzQ': G(0x20a),
                'fAVDE': function (o, p) {
                    return o !== p;
                },
                'gMkRZ': G(0x1d8),
                'PfYNW': G(0x1f1),
                'QqZaG': G(0x1ac)
            }, h = {};
        h[H(0x1cb)] = e, h[H(0x1d2)] = g[G(0x1ce)], h[H(0x1ec) + 'pe'] = g[H(0x1d4)];
        const i = await (0x155a * -0x1 + 0x1242 + 0x318, axios_1[H(0x1f9)])(h), j = {};
        j[G(0x1de)] = {};
        const k = i[G(0x1e2)][g[H(0x1ff)]] ? content_disposition_1[H(0x1f9)][G(0x1e0)](i[G(0x1e2)][g[H(0x1ff)]] || '') : j;
        let l = '';
        const m = k?.[H(0x1de)]?.[H(0x20f)];
        if (m) {
            if (g[G(0x210)](g[H(0x1b5)], g[G(0x1cd)])) {
                const p = g[H(0x1e2)][g[G(0x1cc)]], q = p[G(0x1fb)]('/')[-0x137 * -0x7 + 0xf69 + -0x17e9];
                h = i + '-' + new j()[G(0x1fc)]() + '.' + q;
            } else {
                const p = k[G(0x1de)][H(0x20f)];
                l = new Date()[H(0x1fc)]() + '-' + p;
            }
        } else {
            if (g[G(0x1bb)](g[H(0x1bf)], g[G(0x211)])) {
                const q = i[G(0x1e2)][g[G(0x1cc)]], r = q[G(0x1fb)]('/')[-0x16f5 + 0x35f + 0x1397];
                l = f + '-' + new Date()[G(0x1fc)]() + '.' + r;
            } else {
                const t = {};
                return t[G(0x1f9)] = j, g && h[G(0x1b1)] ? i : t;
            }
        }
        const n = (0x172d + 0x1ab0 + -0x31dd, path_1[H(0x1e9)])(__dirname, '..', '..', '..', g[H(0x1db)], l);
        return await new Promise((t, u) => {
            const I = G, K = H, v = {
                    'ywtZK': g[I(0x1c8)],
                    'AAwbw': function (x, y) {
                        const J = I;
                        return g[J(0x1af)](x, y);
                    },
                    'GEuFD': g[K(0x202)],
                    'tDPlK': g[I(0x1b3)],
                    'HmZkY': function (z, A) {
                        const L = K;
                        return g[L(0x1ef)](z, A);
                    },
                    'fhnvJ': g[K(0x1e6)]
                };
            i[K(0x207)][K(0x1be)]((0x846 + -0x320 + 0x526 * -0x1, fs_1[K(0x1d7) + I(0x1ee)])(n))['on'](g[I(0x202)], async () => t(l))['on'](g[I(0x1b3)], x => {
                const M = I, O = K, y = {
                        'LDbcx': v[M(0x1f2)],
                        'UwZmQ': function (z, A) {
                            const N = M;
                            return v[N(0x1b0)](z, A);
                        },
                        'xbYvS': v[O(0x20d)],
                        'NrwvO': v[O(0x1da)]
                    };
                v[O(0x1ae)](v[M(0x1e8)], v[M(0x1e8)]) ? k[M(0x207)][O(0x1be)]((0xce4 + -0xe24 + -0x14 * -0x10, l[M(0x1d7) + O(0x1ee)])(m))['on'](y[M(0x1d9)], async () => s(t))['on'](y[O(0x1e3)], A => {
                    const P = M, Q = M;
                    s[P(0x1c7)](y[P(0x20c)], A), y[P(0x205)](t, new u(A));
                }) : (console[O(0x1c7)](v[M(0x1f2)], x), v[M(0x1b0)](u, new Error(x)));
            });
        }), l;
    }, MessengerVerifyMediaMessage = async (c, d, e, f) => {
        const R = E, S = E, g = {
                'KgjfR': function (i, j, k) {
                    return i(j, k);
                },
                'bpjsJ': function (i, j) {
                    return i > j;
                },
                'JDHHo': R(0x1b2)
            };
        let h;
        await Promise[R(0x206)](d[R(0x1e7)][S(0x1c6) + 's'][S(0x1e4)](async (i, j) => {
            const T = R, U = S, k = e['id'] + '_' + d[T(0x1d1)];
            h = await g[U(0x1fd)](downloadFile, i[T(0x200)][U(0x1cb)], k);
            let l;
            if (d?.[U(0x1e7)]?.[U(0x1dd)]?.[U(0x1c3)]) {
                const o = await (0x13e9 * 0x1 + -0x21d3 + 0xdea, getQuotedForMessageId_1[U(0x1f9)])(d[U(0x1e7)][T(0x1dd)][T(0x1c3)], e[T(0x213)]);
                l = o?.['id'] || undefined;
            }
            const m = {
                'messageId': g[T(0x1ea)](j, -0x3 * -0x709 + -0x1 * -0xf0 + 0xab * -0x21) ? d[U(0x1d1)] + '__' + j : d[U(0x1d1)] || '',
                'ticketId': e['id'],
                'contactId': f['id'],
                'body': d[U(0x1e7)]?.[T(0x1c5)] || '',
                'fromMe': d[U(0x1c0)],
                'read': ![],
                'mediaUrl': h,
                'mediaType': d[T(0x1ca)],
                'quotedMsgId': l,
                'timestamp': +d[U(0x1c2)],
                'status': g[T(0x1f7)]
            };
            await e[U(0x1d5)]({
                'lastMessage': d[T(0x1e7)]?.[U(0x1c5)] || h || '',
                'lastMessageAt': new Date()[U(0x1fc)](),
                'answered': ![]
            });
            const n = {};
            n[U(0x1d3) + 'a'] = m, n[T(0x213)] = e[T(0x213)], await (0x5e * 0x1 + 0x1b90 + -0x41 * 0x6e, CreateMessageService_1[T(0x1f9)])(n);
        }));
    };
exports[D(0x1f9)] = MessengerVerifyMediaMessage;