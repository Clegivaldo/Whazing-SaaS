'use strict';const m=b,o=b;function a(){const r=['ERR_SESSION_EXPIRED','tokenVersion','705IwGnGv','RefreshTokenService','31788LTZOqy','300jSHLPu','1526478huwiNh','8677568BEgowC','default','../../errors/AppError','createRefreshToken','44958840jkPWmz','357969lzBIUj','../../helpers/CreateTokens','1095325rTWCoq','325305fCOTpp','35MWNggl','../../config/auth','11UEZiok','jsonwebtoken','defineProperty','__esModule','__importDefault','8dmXDcA','createAccessToken','../UserServices/ShowUserService'];a=function(){return r;};return a();}(function(c,d){const k=b,l=b,e=c();while(!![]){try{const f=-parseInt(k(0xc0))/0x1+parseInt(l(0xaf))/0x2*(parseInt(l(0xbe))/0x3)+parseInt(l(0xb6))/0x4*(parseInt(l(0xb4))/0x5)+-parseInt(l(0xb8))/0x6*(parseInt(k(0xc2))/0x7)+-parseInt(k(0xb9))/0x8+parseInt(l(0xc1))/0x9*(-parseInt(l(0xb7))/0xa)+-parseInt(l(0xaa))/0xb*(-parseInt(k(0xbd))/0xc);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xc5411));var __importDefault=this&&this[m(0xae)]||function(c){const n=m;return c&&c[n(0xad)]?c:{'default':c};};function b(c,d){const e=a();return b=function(f,g){f=f-0xa9;let h=e[f];return h;},b(c,d);}Object[o(0xac)](exports,o(0xad),{'value':!![]}),exports[o(0xb5)]=void 0x0;const jsonwebtoken_1=require(o(0xab)),AppError_1=__importDefault(require(o(0xbb))),ShowUserService_1=__importDefault(require(o(0xb1))),auth_1=__importDefault(require(o(0xa9))),CreateTokens_1=require(m(0xbf)),RefreshTokenService=async c=>{const p=o,q=o;let d;try{d=(0x0,jsonwebtoken_1['verify'])(c,auth_1[p(0xba)]['refreshSecret']);}catch(j){throw new AppError_1[(q(0xba))](q(0xb2),0x191);}const {id:e,tokenVersion:f}=d,g=await(0x0,ShowUserService_1[q(0xba)])(e,0x1);if(g[p(0xb3)]!==f)throw new AppError_1[(q(0xba))]('ERR_SESSION_EXPIRED',0x191);const h=(0x0,CreateTokens_1[q(0xb0)])(g),i=(0x0,CreateTokens_1[p(0xbc)])(g);return{'newToken':h,'refreshToken':i};};exports[m(0xb5)]=RefreshTokenService;