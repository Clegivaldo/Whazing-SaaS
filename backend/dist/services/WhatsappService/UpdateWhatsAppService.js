'use strict';const I=b,N=b;function a(){const W=['boolean','1248550CRKslb','min','72SSVavk','writable','6pyNimM','2540088LQYWFf','2742XZVqwC','xzLyL','configurable','call','../../models/Whatsapp','string','update','OjBFy','get','5905864oAEifW','__esModule','WxhrC','3923457AZciQg','ERR_NO_WAPP_FOUND','__createBinding','shape','3201645iuaWyP','default','getOwnPropertyDescriptor','message','sequelize','4933138YPDewy','lUmqW','../../errors/AppError','prototype','defineProperty','findOne','yup','964Gfkdvu','__importStar','__setModuleDefault','__importDefault'];a=function(){return W;};return a();}(function(c,d){const G=b,H=b,e=c();while(!![]){try{const f=-parseInt(G(0xf8))/0x1*(parseInt(G(0x103))/0x2)+parseInt(H(0xe8))/0x3+parseInt(G(0x10c))/0x4+-parseInt(G(0xec))/0x5+-parseInt(H(0x101))/0x6*(parseInt(H(0xf1))/0x7)+-parseInt(G(0x102))/0x8+parseInt(H(0xff))/0x9*(parseInt(H(0xfd))/0xa);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xc30bb));var __createBinding=this&&this[I(0xea)]||(Object['create']?function(c,d,e,f){const J=I,K=I;if(f===undefined)f=e;var g=Object[J(0xee)](d,e);if(!g||(K(0x10b)in g?!d[J(0xe6)]:g[K(0x100)]||g[K(0x105)])){if(K(0x10a)===K(0x10a))g={'enumerable':!![],'get':function(){const L=J,M=J;if('lUmqW'===L(0xf2))return d[e];else throw new d[(L(0xed))](L(0xe9),0x194);}};else{if(p===q)r=s;var i=t[K(0xee)](u,v);(!i||('get'in i?!w[K(0xe6)]:i[K(0x100)]||i[J(0x105)]))&&(i={'enumerable':!![],'get':function(){return i[F];}}),z[J(0xf5)](A,B,i);}}Object[J(0xf5)](c,f,g);}:function(c,d,e,f){if(f===undefined)f=e;c[f]=d[e];}),__setModuleDefault=this&&this[N(0xfa)]||(Object['create']?function(c,d){const O=I,P=N;Object[O(0xf5)](c,P(0xed),{'enumerable':!![],'value':d});}:function(c,d){const Q=I;c[Q(0xed)]=d;}),__importStar=this&&this[N(0xf9)]||function(c){const R=I,S=N;if(c&&c[R(0xe6)])return c;var d={};if(c!=null){for(var e in c)if(e!=='default'&&Object[R(0xf4)]['hasOwnProperty'][S(0x106)](c,e))__createBinding(d,c,e);}return __setModuleDefault(d,c),d;},__importDefault=this&&this[I(0xfb)]||function(c){const T=N;return c&&c[T(0xe6)]?c:{'default':c};};Object[I(0xf5)](exports,'__esModule',{'value':!![]});function b(c,d){const e=a();return b=function(f,g){f=f-0xe6;let h=e[f];return h;},b(c,d);}const Yup=__importStar(require(N(0xf7))),sequelize_1=require(I(0xf0)),AppError_1=__importDefault(require(I(0xf3))),Whatsapp_1=__importDefault(require(I(0x107))),UpdateWhatsAppService=async({whatsappData:c,whatsappId:d,tenantId:e})=>{const U=N,V=I,f=Yup['object']()[U(0xeb)]({'name':Yup[V(0x108)]()[V(0xfe)](0x2),'isDefault':Yup[V(0xfc)]()}),{name:g,status:h,isDefault:i,session:j,tokenTelegram:k,instagramUser:l,instagramKey:m,isActive:n,type:o,wabaBSP:p,tokenAPI:q,fbPageId:r,farewellMessage:s,chatFlowId:t,is_open_ia:u,queue_transf:v}=c;try{if(V(0x104)!=='LcQju'){await f['validate']({'name':g,'status':h,'isDefault':i});let w=null;i&&(w=await Whatsapp_1[V(0xed)][V(0xf6)]({'where':{'isDefault':!![],'tenantId':e,'id':{[sequelize_1['Op']['not']]:d}}}),w&&await w[V(0x109)]({'isDefault':![]}));const x=await Whatsapp_1[V(0xed)]['findOne']({'where':{'id':d,'tenantId':e}});if(!x)throw new AppError_1['default']('ERR_NO_WAPP_FOUND',0x194);const y={'name':g,'status':h,'session':j,'isDefault':i,'tokenTelegram':k,'instagramUser':l,'isActive':n,'type':o,'wabaBSP':p,'tokenAPI':q,'fbPageId':r,'farewellMessage':s,'chatFlowId':t,'is_open_ia':u,'queue_transf':v};if(m){if(V(0xe7)===V(0xe7))y['instagramKey']=m;else return e[f];}return await x[V(0x109)](y),{'whatsapp':x,'oldDefaultWhatsapp':w};}else{if(k===l)m=n;o[p]=q[r];}}catch(B){throw new AppError_1['default'](B[U(0xef)]);}};exports[N(0xed)]=UpdateWhatsAppService;