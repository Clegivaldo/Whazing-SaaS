'use strict';function b(c,d){const e=a();return b=function(f,g){f=f-0x187;let h=e[f];return h;},b(c,d);}const o=b,p=b;(function(c,d){const m=b,n=b,e=c();while(!![]){try{const f=parseInt(m(0x19f))/0x1+-parseInt(n(0x19c))/0x2*(parseInt(n(0x19d))/0x3)+-parseInt(n(0x187))/0x4+-parseInt(m(0x19a))/0x5+parseInt(n(0x193))/0x6+parseInt(n(0x18b))/0x7+-parseInt(n(0x18a))/0x8*(-parseInt(n(0x18e))/0x9);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x8f41b));var __importDefault=this&&this[o(0x1a0)]||function(c){return c&&c['__esModule']?c:{'default':c};};Object[p(0x190)](exports,o(0x198),{'value':!![]});function a(){const s=['DESC','../../errors/AppError','ERR_NO_TICKET_FOUND','__esModule','createdAt','3560455WnsMJq','queueId','51970OJmREc','111PUkULn','length','597162JzJfMv','__importDefault','../../models/MessageOffLine','2031196hXZkrF','contactId','contact','1940784EqPEGH','3134418zpBheI','reverse','../../models/Message','36YpqZtY','default','defineProperty','../TicketServices/ShowTicketService','findAndCountAll','4516716XgtKxh','quotedMsg'];a=function(){return s;};return a();}const AppError_1=__importDefault(require(p(0x196))),Message_1=__importDefault(require(o(0x18d))),MessageOffLine_1=__importDefault(require(o(0x1a1))),Ticket_1=__importDefault(require('../../models/Ticket')),ShowTicketService_1=__importDefault(require(p(0x191))),ListMessagesService=async({pageNumber:pageNumber='1',ticketId:c,tenantId:d})=>{const q=p,r=o,e=await(0x0,ShowTicketService_1[q(0x18f)])({'id':c,'tenantId':d});if(!e)throw new AppError_1[(q(0x18f))](r(0x197),0x194);const f=0x1e,g=f*(+pageNumber-0x1),{count:h,rows:i}=await Message_1['default'][q(0x192)]({'limit':f,'include':['contact',{'model':Message_1['default'],'as':q(0x194),'include':[r(0x189)]},{'model':Ticket_1['default'],'where':{'queueId':e[q(0x19b)],'contactId':e[q(0x188)],'whatsappId':e['whatsappId'],'id':e['id']},'required':!![]}],'offset':g,'order':[[r(0x199),q(0x195)]]});let j=[];if(+pageNumber===0x1){const {rows:l}=await MessageOffLine_1[r(0x18f)][q(0x192)]({'where':{'ticketId':c},'include':[r(0x189),{'model':Message_1[r(0x18f)],'as':q(0x194),'include':[q(0x189)]}],'order':[['createdAt',q(0x195)]]});j=l;}const k=h>g+i[q(0x19e)];return{'messages':i[q(0x18c)](),'messagesOffLine':j,'ticket':e,'count':h,'hasMore':k};};exports[p(0x18f)]=ListMessagesService;