'use strict';function a(){const s=['createdAt','99hLGyQO','38365PCOJTk','548427ItPNXu','quotedMsg','ERR_NO_TICKET_FOUND','queueId','../TicketServices/ShowTicketService','DESC','../../models/MessageOffLine','102aGWZDB','../../models/Ticket','110lFkCOA','default','length','contact','262744JZoJwK','1018464kUuVJD','2197696gCrVZc','__esModule','defineProperty','findAndCountAll','1976125TbQIfl','../../errors/AppError','30lhVjDA','__importDefault','264929aYogyX'];a=function(){return s;};return a();}const o=b,p=b;function b(c,d){const e=a();return b=function(f,g){f=f-0xe9;let h=e[f];return h;},b(c,d);}(function(c,d){const m=b,n=b,e=c();while(!![]){try{const f=parseInt(m(0xea))/0x1*(parseInt(n(0x100))/0x2)+-parseInt(m(0xf9))/0x3+parseInt(m(0xfa))/0x4+parseInt(n(0xfe))/0x5+-parseInt(m(0xf2))/0x6*(parseInt(n(0x102))/0x7)+-parseInt(n(0xf8))/0x8*(-parseInt(n(0xe9))/0x9)+parseInt(n(0xf4))/0xa*(-parseInt(m(0xeb))/0xb);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x55783));var __importDefault=this&&this[o(0x101)]||function(c){return c&&c['__esModule']?c:{'default':c};};Object[p(0xfc)](exports,p(0xfb),{'value':!![]});const AppError_1=__importDefault(require(p(0xff))),Message_1=__importDefault(require('../../models/Message')),MessageOffLine_1=__importDefault(require(o(0xf1))),Ticket_1=__importDefault(require(p(0xf3))),ShowTicketService_1=__importDefault(require(p(0xef))),ListMessagesService=async({pageNumber:pageNumber='1',ticketId:c,tenantId:d})=>{const q=p,r=o,e=await(0x0,ShowTicketService_1[q(0xf5)])({'id':c,'tenantId':d});if(!e)throw new AppError_1['default'](q(0xed),0x194);const f=0x1e,g=f*(+pageNumber-0x1),{count:h,rows:i}=await Message_1[r(0xf5)][q(0xfd)]({'limit':f,'include':[q(0xf7),{'model':Message_1['default'],'as':'quotedMsg','include':[r(0xf7)]},{'model':Ticket_1[r(0xf5)],'where':{'queueId':e[q(0xee)],'contactId':e['contactId'],'whatsappId':e['whatsappId'],'id':e['id']},'required':!![]}],'offset':g,'order':[[q(0x103),r(0xf0)]]});let j=[];if(+pageNumber===0x1){const {rows:l}=await MessageOffLine_1[r(0xf5)]['findAndCountAll']({'where':{'ticketId':c},'include':[r(0xf7),{'model':Message_1['default'],'as':q(0xec),'include':['contact']}],'order':[[r(0x103),'DESC']]});j=l;}const k=h>g+i[q(0xf6)];return{'messages':i['reverse'](),'messagesOffLine':j,'ticket':e,'count':h,'hasMore':k};};exports['default']=ListMessagesService;