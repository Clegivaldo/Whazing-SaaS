'use strict';const n=b,p=b;(function(c,d){const l=b,m=b,e=c();while(!![]){try{const f=parseInt(l(0x139))/0x1+parseInt(m(0x142))/0x2+parseInt(m(0x145))/0x3+-parseInt(l(0x13f))/0x4+-parseInt(l(0x13b))/0x5+-parseInt(l(0x143))/0x6*(parseInt(l(0x12b))/0x7)+parseInt(m(0x12c))/0x8;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x4cc2b));function a(){const s=['timestamp','447048JGwaSY','6cGQJvO','feed','1015728PwmkBP','../WbotServices/helpers/VerifyBusinessHours','2315726ztiQzB','3194784wpcHCQ','accountLogin','markItemSeen','text','instagram','item_id','__importDefault','__esModule','default','item_type','entity','thread_id','./InstagramVerifyMessage','351571gxhvHz','message','1188410HJHlvv','user_id','../TicketServices/FindOrCreateTicketService','directThread','1720432stGDVc','tenantId'];a=function(){return s;};return a();}function b(c,d){const e=a();return b=function(f,g){f=f-0x12a;let h=e[f];return h;},b(c,d);}var __importDefault=this&&this[n(0x132)]||function(c){const o=n;return c&&c[o(0x133)]?c:{'default':c};};Object['defineProperty'](exports,n(0x133),{'value':!![]});const VerifyStepsChatFlowTicket_1=__importDefault(require('../ChatFlowServices/VerifyStepsChatFlowTicket')),FindOrCreateTicketService_1=__importDefault(require(p(0x13d))),VerifyBusinessHours_1=__importDefault(require(p(0x12a))),ShowWhatsAppService_1=__importDefault(require('../WhatsappService/ShowWhatsAppService')),InstagramVerifyContact_1=__importDefault(require('./InstagramVerifyContact')),InstagramVerifyMediaMessage_1=__importDefault(require('./InstagramVerifyMediaMessage')),InstagramVerifyMessage_1=__importDefault(require(n(0x138))),handleRealtimeReceive=async(c,d)=>{const q=n,r=p,e=await(0x0,ShowWhatsAppService_1[q(0x134)])({'id':d['id']}),f=await d[r(0x144)][r(0x13e)]({'thread_id':c[q(0x13a)][r(0x137)],'oldest_cursor':''})['request'](),g=await(0x0,InstagramVerifyContact_1['default'])(f,d,e[r(0x140)]),h=d?.[r(0x12d)],i=h?.['pk']===c['message'][q(0x13c)],j=await(0x0,FindOrCreateTicketService_1['default'])({'contact':g,'whatsappId':d['id'],'unreadMessages':i?0x0:0x1,'tenantId':e['tenantId'],'msg':{...c[q(0x13a)],'fromMe':i},'channel':q(0x130)});if(j?.['isFarewellMessage'])return;c[q(0x13a)][r(0x135)]!==q(0x12f)?await(0x0,InstagramVerifyMediaMessage_1[r(0x134)])(c,i,j,g):await(0x0,InstagramVerifyMessage_1['default'])(c,i,j,g);const k=await d[r(0x136)]['directThread'](c['message'][q(0x137)]);k[q(0x12e)](c['message'][r(0x131)]),await(0x0,VerifyStepsChatFlowTicket_1[q(0x134)])({'fromMe':i,'body':c[r(0x13a)]?.[q(0x12f)]||''},j),await(0x0,VerifyBusinessHours_1[r(0x134)])({'fromMe':i,'timestamp':c[q(0x13a)][r(0x141)]/0x3e8},j);};exports['default']=handleRealtimeReceive;