'use strict';function b(c,d){const e=a();return b=function(f,g){f=f-0xb6;let h=e[f];return h;},b(c,d);}const q=b,r=b;(function(c,d){const o=b,p=b,e=c();while(!![]){try{const f=parseInt(o(0xd4))/0x1+-parseInt(o(0xbe))/0x2+-parseInt(p(0xcc))/0x3*(parseInt(o(0xd8))/0x4)+parseInt(o(0xc2))/0x5+parseInt(p(0xb7))/0x6*(-parseInt(o(0xba))/0x7)+-parseInt(o(0xce))/0x8*(-parseInt(p(0xd1))/0x9)+-parseInt(p(0xca))/0xa*(-parseInt(o(0xbf))/0xb);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xd4d50));var __importDefault=this&&this['__importDefault']||function(c){return c&&c['__esModule']?c:{'default':c};};Object[q(0xd9)](exports,r(0xc0),{'value':!![]});function a(){const y=['319806gAVuBq','ERR_NO_CONTACT_FOUND','email','tags','332nVkFuX','defineProperty','reload','149580czRNtM','../../helpers/socketEmit','wallets','42dsBeiK','findOne','profilePicUrl','contact:update','3385100zpQGbl','11zJYbDd','__esModule','upsert','6929410caPSae','extraInfo','default','push','name','bulkCreate','../../models/ContactCustomField','forEach','14984680kHcPkL','destroy','55113TgUHqG','all','8276216lueAHi','number','../../models/Contact','9OQLtHI','../../models/ContactWallet','update'];a=function(){return y;};return a();}const AppError_1=__importDefault(require('../../errors/AppError')),socketEmit_1=__importDefault(require(r(0xb8))),Contact_1=__importDefault(require(r(0xd0))),ContactCustomField_1=__importDefault(require(r(0xc8))),ContactWallet_1=__importDefault(require(q(0xd2))),UpdateContactService=async({contactData:c,contactId:d,tenantId:e})=>{const s=r,t=q,{email:f,name:g,number:h,extraInfo:i,wallets:j}=c,k=await Contact_1[s(0xc4)][s(0xbb)]({'where':{'id':d,'tenantId':e},'attributes':['id','name','number',t(0xd6),t(0xbc)],'include':[t(0xc3),s(0xd7),{'association':s(0xb9),'attributes':['id',t(0xc6)]}]});if(!k)throw new AppError_1[(t(0xc4))](s(0xd5),0x194);i&&(await Promise[s(0xcd)](i['map'](async l=>{const u=t,v=s;await ContactCustomField_1[u(0xc4)][u(0xc1)]({...l,'contactId':k['id']});})),await Promise[t(0xcd)](k['extraInfo']['map'](async l=>{const w=s,m=i['findIndex'](n=>n['id']===l['id']);m===-0x1&&await ContactCustomField_1['default'][w(0xcb)]({'where':{'id':l['id']}});})));if(j){await ContactWallet_1[s(0xc4)]['destroy']({'where':{'tenantId':e,'contactId':d}});const l=[];j[t(0xc9)](m=>{const x=s;l[x(0xc5)]({'walletId':!m['id']?m:m['id'],'contactId':d,'tenantId':e});}),await ContactWallet_1[s(0xc4)][s(0xc7)](l);}return await k[t(0xd3)]({'name':g,'number':h,'email':f}),await k[s(0xb6)]({'attributes':['id',t(0xc6),t(0xcf),s(0xd6),'profilePicUrl'],'include':[t(0xc3),'tags',{'association':s(0xb9),'attributes':['id',t(0xc6)]}]}),(0x0,socketEmit_1['default'])({'tenantId':e,'type':t(0xbd),'payload':k}),k;};exports[r(0xc4)]=UpdateContactService;