'use strict';const m=b,n=b;(function(c,d){const k=b,l=b,e=c();while(!![]){try{const f=-parseInt(k(0x18d))/0x1+-parseInt(l(0x18b))/0x2*(-parseInt(k(0x18c))/0x3)+-parseInt(k(0x1a1))/0x4+parseInt(l(0x19c))/0x5*(parseInt(l(0x197))/0x6)+parseInt(k(0x194))/0x7+parseInt(l(0x19b))/0x8+parseInt(l(0x19a))/0x9*(-parseInt(k(0x1a0))/0xa);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x24793));var __importDefault=this&&this[m(0x195)]||function(c){return c&&c['__esModule']?c:{'default':c};};Object[m(0x18e)](exports,n(0x19f),{'value':!![]});const User_1=__importDefault(require(m(0x1a4))),AppError_1=__importDefault(require('../../errors/AppError')),CreateTokens_1=require(m(0x199)),Queue_1=__importDefault(require(n(0x19d))),Tenant_1=__importDefault(require(m(0x18f))),AuthUserService=async({email:c,password:d})=>{const o=n,p=m,e=await User_1[o(0x192)]['findOne']({'where':{'email':c},'include':[{'model':Queue_1[p(0x192)],'as':o(0x191)},{'model':Tenant_1[p(0x192)],'as':'tenant','where':{'status':'active'}}]});if(!e)throw new AppError_1['default'](o(0x190),0x191);if(!await e['checkPassword'](d))throw new AppError_1[(o(0x192))](p(0x190),0x191);const f=(0x0,CreateTokens_1[p(0x193)])(e),g=(0x0,CreateTokens_1[p(0x1a2)])(e);await e['update']({'isOnline':!![],'status':p(0x1a5),'lastLogin':new Date()});const h=await User_1[o(0x192)][p(0x19e)]({'where':{'tenantId':e['tenantId'],'isOnline':!![]},'attributes':['id','email',o(0x196),p(0x1a3),'name',o(0x198)]});return{'user':e,'token':f,'refreshToken':g,'usuariosOnline':h};};function b(c,d){const e=a();return b=function(f,g){f=f-0x18b;let h=e[f];return h;},b(c,d);}function a(){const q=['2470113GkBcto','959200jQUCAf','283030nAEEpa','../../models/Queue','findAll','__esModule','10NYPxQx','944716gINiNC','createRefreshToken','lastOnline','../../models/User','online','20866QLvvck','36HYoRqJ','110496FfoXRb','defineProperty','../../models/Tenant','ERR_INVALID_CREDENTIALS','queues','default','createAccessToken','1696807tcHKyY','__importDefault','status','30Gtppej','lastLogin','../../helpers/CreateTokens'];a=function(){return q;};return a();}exports['default']=AuthUserService;