'use strict';const m=b,o=b;(function(c,d){const k=b,l=b,e=c();while(!![]){try{const f=-parseInt(k(0x88))/0x1+parseInt(k(0x97))/0x2+parseInt(k(0x9d))/0x3*(parseInt(l(0x99))/0x4)+-parseInt(l(0x92))/0x5*(parseInt(l(0x8b))/0x6)+-parseInt(k(0xa0))/0x7*(-parseInt(l(0x93))/0x8)+-parseInt(l(0x98))/0x9*(parseInt(k(0x91))/0xa)+parseInt(l(0x89))/0xb*(-parseInt(k(0x86))/0xc);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xb21f1));function a(){const r=['../../models/CampaignContacts','223980TAcbBD','65857aTNAAU','IO_REDIS_DB_SESSION','2058rkvYHk','__esModule','removeJobs','__importDefault','ERROR_CAMPAIGN_NOT_EXISTS','ERROR:\x20','1610pGtAeI','9335qqZOqs','568cFNUMz','IO_REDIS_PORT','../../errors/AppError','IO_REDIS_PASSWORD','1616902KLrusC','44262qavUaR','112FfsxLm','default','update','canceled','131679aXIMUA','bull','../../models/Campaign','64442ksdzuG','env','612lKcipx'];a=function(){return r;};return a();}var __importDefault=this&&this[m(0x8e)]||function(c){const n=m;return c&&c[n(0x8c)]?c:{'default':c};};function b(c,d){const e=a();return b=function(f,g){f=f-0x86;let h=e[f];return h;},b(c,d);}Object['defineProperty'](exports,m(0x8c),{'value':!![]});const bull_1=__importDefault(require(m(0x9e))),Campaign_1=__importDefault(require(o(0x9f))),AppError_1=__importDefault(require(m(0x95))),CampaignContacts_1=__importDefault(require(o(0x87))),CancelCampaignService=async({campaignId:c,tenantId:d})=>{const p=o,q=m,e=await Campaign_1[p(0x9a)]['findOne']({'where':{'id':c,'tenantId':d}});if(!e)throw new AppError_1[(p(0x9a))](q(0x8f),0x194);try{await(0x0,bull_1['default'])('SendMessageWhatsappCampaign',{'redis':{'port':Number(process['env'][q(0x94)]),'host':process[q(0xa1)]['IO_REDIS_SERVER'],'db':Number(process[q(0xa1)][p(0x8a)])||0x2,'password':process[q(0xa1)][q(0x96)]||undefined}})[p(0x8d)]('campaginId_'+e['id']+'*'),await CampaignContacts_1['default']['update']({'body':null,'mediaName':null,'timestamp':null,'ack':0x0,'messageId':null},{'where':{'campaignId':e['id'],'messageId':null}}),await e[p(0x9b)]({'status':p(0x9c)});}catch(f){throw new AppError_1['default'](q(0x90)+f,0x194);}};exports[o(0x9a)]=CancelCampaignService;