'use strict';
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (-0x12bf + 0xd81 + 0x70c);
        let h = e[f];
        return h;
    }, b(c, d);
}
function a() {
    const a0 = [
        '_contact_',
        'ampaign',
        'ERR_CAMPAI',
        'findAll',
        '20:00',
        'JkTNK',
        'yIjgQ',
        'date-fns-t',
        'delay',
        'o_Paulo',
        'update',
        'oUtc',
        'NfpmO',
        'isAfter',
        'LDNwK',
        'campaignId',
        'message1',
        'ERROR_CAMP',
        'end',
        '../../mode',
        '../../libs',
        'default',
        'lGMMX',
        'where',
        'addDays',
        'gaHvn',
        'eKKxD',
        '__importDe',
        'zrkWd',
        'InSeconds',
        '2165610Wgphqs',
        'dbMPE',
        'random',
        'status',
        'erty',
        '33nWKUuG',
        '4025277UBpEPM',
        'map',
        'sessionId',
        'campaginId',
        '4EOWshi',
        'eDfai',
        'getMinutes',
        'xUXhE',
        'America/Sa',
        'fdZdU',
        '6mPQrVg',
        'isBefore',
        'pTdxD',
        'zonedTimeT',
        'rs/AppErro',
        'MCewm',
        'contact',
        'OHXOM',
        'undQA',
        'InDays',
        'AIGN_NOT_E',
        'difference',
        'dwVwU',
        'getHours',
        'isWithinIn',
        'parse',
        '08:00',
        'NwIGO',
        'XISTS',
        'message2',
        'start',
        'octYw',
        'include',
        'findOne',
        'floor',
        'pYvzd',
        'scheduled',
        'message',
        '3297310qCMpOJ',
        '192766bpOcuZ',
        'add',
        'nContacts',
        'KOmAZ',
        'length',
        'value',
        '9415210JuoZqx',
        '8GvlGwr',
        'GN_CONTACT',
        'jtoTR',
        'S_NOT_EXIS',
        'eWhatsappC',
        '__esModule',
        'addSeconds',
        'LZpzO',
        'wqXXx',
        '274399rrgwKb',
        'fault',
        'LXHVq',
        '/Queue',
        'message3',
        'split',
        'HH:mm',
        'tenantId',
        'defineProp',
        'contactId',
        'Eksae',
        'AfJQN',
        'getTime',
        'ls/Campaig',
        'number',
        '_time_',
        'SendMessag',
        '../../erro',
        'setHours',
        'JxfIy',
        'setMinutes',
        'date-fns',
        'QSfIg',
        'Omwzn',
        'XgrMk',
        'IIuBL',
        'sXUfE',
        '_id_',
        'oLXtX',
        'terval',
        'session',
        '8675245UNikXj',
        'mediaUrl'
    ];
    a = function () {
        return a0;
    };
    return a();
}
const J = b, K = b;
(function (c, d) {
    const H = b, I = b, e = c();
    while (!![]) {
        try {
            const f = -parseInt(H(0x1f8)) / (0x1350 + 0x243c + -0x378b) + parseInt(H(0x1e8)) / (-0x180a + -0xb * -0x27f + -0x9 * 0x61) + -parseInt(H(0x237)) / (0x25d9 + -0x744 * -0x1 + 0xfb * -0x2e) + parseInt(H(0x241)) / (-0x1f93 + 0xc98 + -0x655 * -0x3) * (parseInt(H(0x217)) / (-0x138b * 0x1 + 0xbd2 * -0x3 + -0x1b83 * -0x2)) + -parseInt(H(0x247)) / (-0x5 * 0x646 + -0x3 * 0x35 + -0x95 * -0x37) * (parseInt(I(0x1ee)) / (0x3f5 * -0x1 + 0x648 * 0x4 + 0xf6 * -0x16)) + -parseInt(I(0x1ef)) / (-0x1 * 0x155c + -0x58 * -0xd + -0x2d2 * -0x6) * (-parseInt(I(0x23d)) / (0x26a4 + -0x821 + -0x1e7a)) + -parseInt(I(0x1e7)) / (-0x1 * -0x11d9 + 0xe1e + -0x1fed) * (-parseInt(I(0x23c)) / (0x6b * 0xb + -0x16f7 + 0x1269));
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, 0xa799a + -0x1 * 0xe69e1 + 0x1213ba));
var __importDefault = this && this[J(0x234) + K(0x1f9)] || function (c) {
    const L = K;
    return c && c[L(0x1f4)] ? c : { 'default': c };
};
const G = {};
G[J(0x1ed)] = !![], Object[K(0x200) + K(0x23b)](exports, K(0x1f4), G);
const date_fns_1 = require(K(0x20d)), date_fns_tz_1 = require(K(0x220) + 'z'), Campaign_1 = __importDefault(require(K(0x22c) + K(0x205) + 'n')), AppError_1 = __importDefault(require(K(0x209) + K(0x1cf) + 'r')), CampaignContacts_1 = __importDefault(require(J(0x22c) + K(0x205) + K(0x1ea))), Queue_1 = __importDefault(require(J(0x22d) + J(0x1fb))), cArquivoName = d => {
        const M = J, N = J, e = {};
        e[M(0x1d0)] = function (i, j) {
            return i - j;
        };
        const f = e;
        if (!d)
            return '';
        const g = d[M(0x1fd)]('/'), h = g[f[N(0x1d0)](g[N(0x1ec)], -0x1 * 0x2691 + 0x1 * 0xc9a + 0x19f8)];
        return h;
    }, randomInteger = (d, e) => {
        const O = J, P = K, f = {};
        f[O(0x1e4)] = function (h, i) {
            return h + i;
        }, f[O(0x21e)] = function (h, i) {
            return h * i;
        }, f[P(0x202)] = function (h, i) {
            return h - i;
        };
        const g = f;
        return g[O(0x1e4)](Math[O(0x1e3)](g[O(0x21e)](Math[P(0x239)](), g[O(0x1e4)](g[O(0x202)](e, d), 0x2608 + 0x3ea * 0x6 + -0x3d83))), d);
    }, mountMessageData = (c, d, e) => {
        const Q = K, R = J, f = {
                'IIuBL': function (i, j, k) {
                    return i(j, k);
                },
                'NwIGO': function (i, j) {
                    return i === j;
                },
                'LXHVq': function (i, j) {
                    return i === j;
                },
                'xUXhE': function (i, j) {
                    return i(j);
                }
            }, g = f[Q(0x211)](randomInteger, 0xb78 + -0x1d05 + 0x118e, 0x116 + -0x31d * -0x9 + -0x1d18);
        let h = '';
        if (f[Q(0x1dc)](g, 0x223 * -0x10 + -0x1 * -0x129d + 0xf94))
            h = c[Q(0x229)];
        if (f[Q(0x1fa)](g, -0x206b + -0x1f7f + 0x4 * 0xffb))
            h = c[Q(0x1de)];
        if (f[Q(0x1fa)](g, 0x35 * 0x9f + 0xf6f + -0x3057))
            h = c[R(0x1fc)];
        return {
            'whatsappId': c[R(0x23f)],
            'message': h,
            'number': d[R(0x1d1)][Q(0x206)],
            'mediaUrl': c[Q(0x218)],
            'mediaName': f[R(0x244)](cArquivoName, c[R(0x218)]),
            'messageRandom': Q(0x1e6) + g,
            'campaignContact': d,
            'options': e
        };
    }, nextDayHoursValid = e => {
        const S = J, T = J, f = {};
        f[S(0x1f6)] = T(0x21b) + S(0x1f0) + T(0x1f2) + 'TS', f[S(0x242)] = function (q, r) {
            return q < r;
        }, f[S(0x238)] = function (q, r) {
            return q * r;
        }, f[S(0x214)] = S(0x1db), f[T(0x1eb)] = S(0x1fe), f[S(0x249)] = T(0x21d), f[T(0x246)] = function (q, r) {
            return q && r;
        }, f[S(0x20f)] = function (q, r) {
            return q && r;
        }, f[S(0x20e)] = function (q, r) {
            return q === r;
        }, f[S(0x1e0)] = function (q, r) {
            return q === r;
        }, f[S(0x22f)] = S(0x1d2), f[S(0x225)] = function (q, r) {
            return q > r;
        };
        const g = f;
        let h = e;
        const i = new Date(), j = (0x125 * 0x1 + -0x1e81 + -0xeae * -0x2, date_fns_1[T(0x1d6) + S(0x1d4)])(h, new Date());
        g[T(0x242)](j, 0x16 * 0x71 + 0x3 * -0x4c1 + 0x48d) && (h = (0x16 * 0xd + 0xbe3 * 0x3 + -0x23 * 0x10d, date_fns_1[S(0x231)])(h, g[S(0x238)](j, -(-0x2459 + -0x6aa * -0x4 + 0x9b2))));
        g[T(0x242)](h[T(0x204)](), i[T(0x204)]()) && (h = (-0x1512 + -0x1f88 + -0x2 * -0x1a4d, date_fns_1[T(0x20c)])((0x2255 + 0x7a + -0x85 * 0x43, date_fns_1[S(0x20a)])(h, i[T(0x1d8)]()), i[T(0x243)]()));
        const k = (-0x241b + -0x1382 + -0x1 * -0x379d, date_fns_1[S(0x1da)])(g[T(0x214)], g[S(0x1eb)], h), l = (-0x2e6 * 0x6 + -0x1f * -0xed + -0xf * 0xc1, date_fns_1[T(0x1da)])(g[T(0x249)], g[T(0x1eb)], h), m = {};
        m[S(0x1df)] = k, m[S(0x22b)] = l;
        const n = (0x1dd2 + -0x157a + 0x10b * -0x8, date_fns_1[S(0x1d9) + T(0x215)])(h, m), o = (0x6cc + -0x227a * 0x1 + 0x3 * 0x93a, date_fns_1[S(0x248)])(k, h), p = (0x1d84 + 0x1 * 0x7b9 + -0x253d, date_fns_1[S(0x226)])(l, h);
        g[S(0x246)](!n, o) && (h = (-0x1181 * 0x2 + -0x3 * -0x751 + 0xd0f, date_fns_1[T(0x20c)])((0x235d + 0x525 * -0x2 + -0x1913, date_fns_1[T(0x20a)])(h, 0x1fe + -0x8 * -0x1da + 0x863 * -0x2), 0xb * -0x198 + -0x191b * -0x1 + -0x1 * 0x775));
        if (g[T(0x20f)](!n, p) && g[S(0x20e)](j, -0x5d8 + 0x13 * 0x10d + 0x2d3 * -0x5)) {
            if (g[T(0x1e0)](g[S(0x22f)], g[S(0x22f)]))
                h = (0x1637 + -0x8d2 * 0x1 + -0x9 * 0x17d, date_fns_1[S(0x231)])((-0x6a9 + -0x2 * -0x120d + -0x1d71, date_fns_1[S(0x20a)])(h, -0x456 * 0x5 + -0x126d + 0x89 * 0x4b), 0x185c + 0x84f + -0x25 * 0xe2);
            else
                throw new m[(S(0x22e))](g[T(0x1f6)], 0x560 + 0xe1a + -0x11e6);
        }
        return g[T(0x246)](!n, p) && g[T(0x225)](j, -0xf9d * -0x1 + 0xc09 + -0x1ba6) && (h = (-0x17d + -0x7d9 + -0x956 * -0x1, date_fns_1[T(0x20a)])(h, -0x2 * -0x393 + -0x2 * -0x81e + -0x175a)), h;
    }, calcDelay = (d, e) => {
        const U = J, V = J, f = {};
        f[U(0x1f1)] = function (i, j) {
            return i + j;
        }, f[U(0x235)] = function (i, j) {
            return i * j;
        };
        const g = f, h = (-0xc5 * -0x4 + 0x1 * -0x1853 + 0x153f, date_fns_1[V(0x1d6) + U(0x236)])(d, new Date());
        return g[U(0x1f1)](g[V(0x235)](h, -0x1f7 * 0x8 + -0x5 * 0x5ad + -0x3001 * -0x1), e);
    }, StartCampaignService = async ({
        campaignId: h,
        tenantId: i,
        options: j
    }) => {
        const W = K, X = J, k = {
                'XgrMk': function (v, w) {
                    return v / w;
                },
                'undQA': function (v, w, x, y) {
                    return v(w, x, y);
                },
                'LDNwK': function (v, w, x) {
                    return v(w, x);
                },
                'AfJQN': W(0x216),
                'dwVwU': W(0x22a) + W(0x1d5) + X(0x1dd),
                'wqXXx': X(0x1d1),
                'sXUfE': X(0x21b) + W(0x1f0) + X(0x1f2) + 'TS',
                'eKKxD': function (v, w) {
                    return v * w;
                },
                'yIjgQ': W(0x245) + X(0x222),
                'JxfIy': X(0x208) + W(0x1f3) + X(0x21a),
                'gaHvn': W(0x1e5)
            }, l = {};
        l['id'] = h, l[X(0x1ff)] = i;
        const m = {};
        m[W(0x230)] = l, m[W(0x1e1)] = [k[W(0x203)]];
        const n = await Campaign_1[W(0x22e)][X(0x1e2)](m);
        if (!n)
            throw new AppError_1[(X(0x22e))](k[W(0x1d7)], -0xd99 * -0x1 + 0x26ff + -0x3304);
        const o = {};
        o[W(0x228)] = h;
        const p = {};
        p[X(0x230)] = o, p[X(0x1e1)] = [k[W(0x1f7)]];
        const q = await CampaignContacts_1[W(0x22e)][X(0x21c)](p);
        if (!q)
            throw new AppError_1[(X(0x22e))](k[X(0x212)], 0x16cb + 0x487 * 0x2 + -0x7 * 0x453);
        const r = n[W(0x221)] ? k[W(0x233)](n[X(0x221)], 0xa66 + 0x1d * 0x59 + -0x1093) : -0x74e3 * 0x1 + -0x2 * -0x2df4 + -0x671b * -0x1;
        let s = (0x197 + -0x19c2 + 0x10d * 0x17, date_fns_tz_1[X(0x1ce) + X(0x224)])(n[W(0x1df)], k[X(0x21f)]);
        const t = q[W(0x23e)](v => {
            const Y = W, Z = W;
            return s = (0x2 * 0x12ba + 0xf * -0x6a + -0x1f3e, date_fns_1[Y(0x1f5)])(s, k[Y(0x210)](r, -0xa74 + -0xaf2 + 0x194e)), k[Z(0x1d3)](mountMessageData, n, v, {
                ...j,
                'jobId': Z(0x240) + '_' + n['id'] + Z(0x219) + v[Y(0x201)] + Y(0x213) + v['id'] + Z(0x207) + n[Y(0x1df)][Z(0x204)](),
                'delay': k[Y(0x227)](calcDelay, s, r)
            });
        });
        Queue_1[X(0x22e)][W(0x1e9)](k[X(0x20b)], t);
        const u = {};
        u[X(0x23a)] = k[W(0x232)], await n[X(0x223)](u);
    };
exports[J(0x22e)] = StartCampaignService;