'use strict';const F=b,H=b;function a(){const O=['2270848vLQHFP','15301UyxCqa','substr','6264hQsJno','wGdPn','indexOf','split','__importDefault','../../models/Campaign','default','all','map','length','13907LfvtDj','9NzUsUP','status','ERR_NO_UPDATE_CAMPAIGN_NOT_IN_CANCELED_PENDING','6gWGmvh','4260Kuuyhj','dbIDu','__esModule','6699112eRancC','logger','mimetype','defineProperty','reload','getTime','findOne','720hBbCMw','272461krmdah','pending','3066145ziEHhh','isArray','null','mediaUrl','filename','start','ERR_NO_CAMPAIGN_FOUND'];a=function(){return O;};return a();}(function(c,d){const D=b,E=b,e=c();while(!![]){try{const f=parseInt(D(0x1a5))/0x1+-parseInt(E(0x1be))/0x2+parseInt(E(0x1b4))/0x3*(-parseInt(D(0x19b))/0x4)+parseInt(D(0x1b7))/0x5+-parseInt(E(0x1a9))/0x6*(-parseInt(D(0x1b5))/0x7)+-parseInt(E(0x1ad))/0x8*(-parseInt(E(0x1a6))/0x9)+-parseInt(D(0x1aa))/0xa*(-parseInt(D(0x199))/0xb);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x8ec2e));function b(c,d){const e=a();return b=function(f,g){f=f-0x199;let h=e[f];return h;},b(c,d);}var __importDefault=this&&this[F(0x19f)]||function(c){const G=F;return c&&c[G(0x1ac)]?c:{'default':c};};Object[H(0x1b0)](exports,H(0x1ac),{'value':!![]});const AppError_1=__importDefault(require('../../errors/AppError')),Campaign_1=__importDefault(require(H(0x1a0))),logger_1=require('../../utils/logger'),cArquivoName=c=>{const I=H,J=F;if(!c)return'';const d=c[I(0x19e)]('/'),e=d[d[J(0x1a4)]-0x1];return e;},UpdateCampaignService=async({campaignData:c,medias:d,campaignId:e,tenantId:f})=>{const K=F,L=F;let g,h={...c,'mediaUrl':cArquivoName(c[K(0x1ba)]),'start':c[K(0x1bc)]};const i=await Campaign_1[K(0x1a1)][K(0x1b3)]({'where':{'id':e,'tenantId':f}});if(i?.[L(0x1a7)]!==L(0x1b6)&&i?.[L(0x1a7)]!=='canceled')throw new AppError_1[(K(0x1a1))](K(0x1a8),0x194);if(d&&Array[K(0x1b8)](d)&&d[K(0x1a4)])await Promise[L(0x1a2)](d[L(0x1a3)](async j=>{const M=K,N=K;if('sxaOA'!==M(0x19c))try{if(!j[M(0x1bb)]){const k=j[N(0x1af)][M(0x19e)]('/')[0x1][N(0x19e)](';')[0x0];j[M(0x1bb)]=new Date()['getTime']()+'.'+k;}g=j;}catch(l){if(M(0x1ab)===M(0x1ab))logger_1[M(0x1ae)]['error'](l);else{if(!e)return'';const n=f[N(0x19e)]('/'),o=n[n['length']-0x1];return o;}}else{if(!i[M(0x1bb)]){const o=o[N(0x1af)]['split']('/')[0x1][N(0x19e)](';')[0x0];p[N(0x1bb)]=new q()[N(0x1b2)]()+'.'+o;}m=n;}})),h={...c,'mediaUrl':g?.['filename'],'mediaType':g?.['mimetype'][K(0x19a)](0x0,g[L(0x1af)][L(0x19d)]('/'))};else c[K(0x1ba)]===L(0x1b9)&&(h={...c,'mediaUrl':'','mediaType':''});if(!i)throw new AppError_1[(K(0x1a1))](K(0x1bd),0x194);return await i['update'](h),await i[K(0x1b1)](),i;};exports[H(0x1a1)]=UpdateCampaignService;