'use strict';const n=b,p=b;(function(c,d){const l=b,m=b,e=c();while(!![]){try{const f=-parseInt(l(0x155))/0x1+-parseInt(m(0x152))/0x2+-parseInt(m(0x14d))/0x3+parseInt(m(0x15d))/0x4+-parseInt(l(0x15a))/0x5+-parseInt(m(0x159))/0x6+parseInt(l(0x14b))/0x7;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xaa438));var __importDefault=this&&this[n(0x150)]||function(c){const o=n;return c&&c[o(0x158)]?c:{'default':c};};Object['defineProperty'](exports,'__esModule',{'value':!![]});function b(c,d){const e=a();return b=function(f,g){f=f-0x14a;let h=e[f];return h;},b(c,d);}function a(){const s=['22616300eLbZVi','$create','912840pwiIet','../../helpers/socketEmit','ERR_CREATING_TICKET','__importDefault','default','2639070YczNpS','create','../ContactServices/ShowContactService','615160VZnePD','../../helpers/CheckContactOpenTickets','ticket','__esModule','2297394zddUSd','1972075gLbRvX','./ShowTicketService','./CreateLogTicketService','1931156VEhfzi','../../errors/AppError'];a=function(){return s;};return a();}const AppError_1=__importDefault(require(p(0x14a))),CheckContactOpenTickets_1=__importDefault(require(n(0x156))),GetDefaultWhatsApp_1=__importDefault(require('../../helpers/GetDefaultWhatsApp')),socketEmit_1=__importDefault(require(n(0x14e))),ShowContactService_1=__importDefault(require(p(0x154))),CreateLogTicketService_1=__importDefault(require(p(0x15c))),ShowTicketService_1=__importDefault(require(n(0x15b))),CreateTicketService=async({contactId:c,status:d,userId:e,tenantId:f,channel:g,channelId:channelId=undefined})=>{const q=p,r=p,h=await(0x0,GetDefaultWhatsApp_1[q(0x151)])(f,channelId);if(!g||!['instagram','telegram','whatsapp']['includes'](g))throw new AppError_1['default'](q(0x14f));await(0x0,CheckContactOpenTickets_1[q(0x151)])(c);const {isGroup:i}=await(0x0,ShowContactService_1['default'])({'id':c,'tenantId':f}),{id:j}=await h[r(0x14c)](q(0x157),{'contactId':c,'status':d,'isGroup':i,'userId':e,'isActiveDemand':!![],'channel':g,'tenantId':f}),k=await(0x0,ShowTicketService_1[r(0x151)])({'id':j,'tenantId':f});if(!k)throw new AppError_1[(q(0x151))](r(0x14f));return await(0x0,CreateLogTicketService_1[r(0x151)])({'userId':e,'ticketId':k['id'],'type':q(0x153)}),(0x0,socketEmit_1[q(0x151)])({'tenantId':f,'type':'ticket:update','payload':k}),k;};exports['default']=CreateTicketService;