'use strict';
const av = b, aw = b;
(function (c, d) {
    const at = b, au = b, e = c();
    while (!![]) {
        try {
            const f = parseInt(at(0x151)) / (0x8 * -0x3d9 + -0xd * 0xbe + 0x3ad * 0xb) + parseInt(au(0x1cd)) / (-0x1 * 0x2003 + 0x1 * -0x18be + 0x1 * 0x38c3) * (-parseInt(au(0x185)) / (-0x26e6 + 0x1988 + 0xd61)) + -parseInt(au(0x163)) / (-0x9 * -0x37e + 0x1 * -0xedb + 0x3 * -0x585) * (parseInt(at(0x1bc)) / (-0x259f * 0x1 + 0x1584 + -0x4 * -0x408)) + -parseInt(at(0x15e)) / (-0x2035 + -0x1 * 0x1e6d + 0x3ea8) + -parseInt(au(0x1b2)) / (-0x1 * 0x1a2a + -0x1229 + -0x1 * -0x2c5a) * (-parseInt(at(0x17c)) / (0xf73 * 0x1 + -0x1a87 + 0xb1c)) + -parseInt(au(0x1bd)) / (0x2589 + -0x259 * -0x4 + -0x2ee4) * (parseInt(at(0x195)) / (0x1c5c + -0x137 * -0x6 + -0x239c)) + -parseInt(au(0x19f)) / (0x33f * -0x2 + 0xcaf + -0x626 * 0x1) * (-parseInt(au(0x145)) / (-0xfdc + 0x21be + -0x11d6));
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, -0x7f * 0x7f0 + -0x754b8 + 0x2eece * 0x8));
function a() {
    const aA = [
        'ls/Message',
        'isFarewell',
        'eBrWI',
        'DESC',
        'ate',
        '2947462IubLFs',
        '../WbotSer',
        'JogRm',
        'Emit',
        'tags',
        'ticketId',
        'mHavP',
        'ls/Ticket',
        'ls/Contact',
        'vices/help',
        '5OFqYxZ',
        '63DpkcsE',
        'getWallets',
        './ShowTick',
        'nContacts',
        'status',
        'whatsapp',
        'ContactBai',
        'includes',
        'fromMe',
        'telegram',
        'BzqOl',
        'order',
        'ers/Verify',
        'istSetting',
        'sService',
        'TkYPl',
        '8YksxNW',
        'DxOqx',
        'dmPbA',
        'closed',
        'update',
        'setDataVal',
        'lastMessag',
        'Message',
        'hXQzu',
        'attributes',
        'unreadMess',
        'name',
        'startedAtt',
        '12fqtYnY',
        'DirectTick',
        'updatedAt',
        'UWcpG',
        'ixOGF',
        'JUQRM',
        'sage',
        'FGudt',
        'associatio',
        'findOne',
        'DqeXc',
        '__importDe',
        '903422cbrnGv',
        'getTime',
        'cpHuh',
        'body',
        'leys',
        'hatBotFlow',
        'iJWse',
        'MzTdw',
        'type',
        'etsToWalle',
        'ticket',
        'whatsappId',
        'tenantId',
        '2907798cZGUGt',
        'VLtIy',
        'open',
        'model',
        'enabled',
        '5570428kjMQFi',
        'sequelize',
        '../Setting',
        'vice',
        '../../help',
        'isGroup',
        'VcMEY',
        'isCreated',
        'ROqCv',
        './CreateLo',
        'zvspt',
        'JeLhF',
        'where',
        'getBodyMes',
        'MImsr',
        'sCYAK',
        'wxIYd',
        'ages',
        'lLZMY',
        'user',
        'wallets',
        'create',
        'eVwFG',
        'messageId',
        'extraInfo',
        '24AbGyRm',
        'payload',
        'ls/User',
        'gTicketSer',
        'contactId',
        'JauUw',
        'Welcome',
        'userId',
        'pVsIn',
        '398133ORxNyD',
        'value',
        'Services/L',
        'gcAqG',
        'contact',
        'isDeleted',
        'channel',
        'ers/CheckC',
        'endanceAt',
        '__esModule',
        'key',
        'fault',
        '../../mode',
        'QANOM',
        'NpCQN',
        'defineProp',
        '172530ypLoYB',
        'find',
        'FZfXc',
        'etService',
        'messenger',
        'igqhE',
        'include',
        'NdIXO',
        'jRLzA',
        'default',
        '12775169dYpwHY',
        'Rlljx',
        'MTaJF',
        'SOzfC',
        'IctsI',
        'NwKDb',
        'ers/socket',
        'pending',
        'instagram',
        'erty',
        'ticket:upd',
        'isCampaign',
        'waba',
        'ls/Campaig'
    ];
    a = function () {
        return aA;
    };
    return a();
}
var __importDefault = this && this[av(0x150) + aw(0x190)] || function (c) {
    const ax = av;
    return c && c[ax(0x18e)] ? c : { 'default': c };
};
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (0x13eb + 0x2f9 * 0xb + 0x1 * -0x3362);
        let h = e[f];
        return h;
    }, b(c, d);
}
const m = {};
m[av(0x186)] = !![], Object[av(0x194) + av(0x1a8)](exports, av(0x18e), m);
const sequelize_1 = require(av(0x164)), Contact_1 = __importDefault(require(av(0x191) + aw(0x1ba))), Ticket_1 = __importDefault(require(av(0x191) + av(0x1b9))), User_1 = __importDefault(require(av(0x191) + aw(0x17e))), ShowTicketService_1 = __importDefault(require(aw(0x1bf) + aw(0x198))), CampaignContacts_1 = __importDefault(require(aw(0x191) + av(0x1ac) + aw(0x1c0))), socketEmit_1 = __importDefault(require(av(0x167) + aw(0x1a5) + aw(0x1b5))), CheckChatBotFlowWelcome_1 = __importDefault(require(av(0x167) + av(0x18c) + aw(0x156) + aw(0x182))), CreateLogTicketService_1 = __importDefault(require(aw(0x16c) + aw(0x17f) + aw(0x166))), Message_1 = __importDefault(require(av(0x191) + aw(0x1ad))), ListSettingsService_1 = __importDefault(require(aw(0x165) + av(0x187) + aw(0x1ca) + av(0x1cb))), VerifyContactBaileys_1 = require(av(0x1b3) + av(0x1bb) + av(0x1c9) + aw(0x1c3) + av(0x155)), FindOrCreateTicketService = async ({
        contact: E,
        whatsappId: F,
        unreadMessages: G,
        tenantId: H,
        groupContact: I,
        msg: J,
        isSync: K,
        channel: L
    }) => {
        const ay = aw, az = av, M = {};
        M[ay(0x184)] = az(0x160), M[az(0x179)] = function (a3, a4) {
            return a3 === a4;
        }, M[ay(0x19c)] = az(0x1a7), M[az(0x1c7)] = ay(0x1c2), M[ay(0x197)] = az(0x1cc), M[ay(0x193)] = ay(0x16d), M[ay(0x192)] = az(0x172), M[az(0x173)] = az(0x15b), M[az(0x1b4)] = az(0x1d0), M[ay(0x140)] = function (a3, a4) {
            return a3 === a4;
        }, M[az(0x16e)] = function (a3, a4) {
            return a3 !== a4;
        }, M[az(0x19d)] = ay(0x1af), M[ay(0x14f)] = ay(0x1a6), M[az(0x14a)] = az(0x189), M[ay(0x148)] = az(0x17b), M[ay(0x158)] = az(0x1b6), M[az(0x188)] = ay(0x177), M[ay(0x169)] = az(0x143), M[az(0x14c)] = az(0x176), M[az(0x1cf)] = ay(0x18a), M[ay(0x15f)] = az(0x1c6), M[ay(0x16b)] = ay(0x1ab), M[az(0x157)] = az(0x199), M[az(0x1b8)] = function (a3, a4) {
            return a3 > a4;
        }, M[az(0x1a1)] = ay(0x1a9) + ay(0x1b1), M[ay(0x1a3)] = ay(0x147), M[az(0x171)] = az(0x1b0), M[ay(0x1ce)] = ay(0x162), M[ay(0x1a0)] = function (a3, a4) {
            return a3 !== a4;
        }, M[az(0x175)] = az(0x181), M[az(0x1a2)] = az(0x178), M[ay(0x1a4)] = function (a3, a4) {
            return a3 && a4;
        }, M[ay(0x149)] = az(0x19a), M[ay(0x153)] = az(0x16a);
        const N = M;
        let O;
        N[ay(0x179)](L, N[ay(0x19c)]) ? O = J[ay(0x1c5)] : O = J[ay(0x18f)][ay(0x1c5)];
        if (N[ay(0x179)](L, N[az(0x1c7)]) && J && O) {
            if (N[az(0x179)](N[az(0x197)], N[ay(0x197)])) {
                const a3 = {};
                a3[ay(0x180)] = E['id'], a3[ay(0x17a)] = J[ay(0x18f)]?.['id'];
                const a4 = {};
                a4[ay(0x16f)] = a3;
                const a5 = await CampaignContacts_1[ay(0x19e)][ay(0x14e)](a4);
                if (a5?.['id']) {
                    if (N[ay(0x179)](N[ay(0x193)], N[ay(0x192)])) {
                        const a7 = {};
                        return a7[ay(0x1aa) + ay(0x13f)] = !![], a7;
                    } else {
                        const a7 = {};
                        return a7[ay(0x1aa) + ay(0x13f)] = !![], a7;
                    }
                }
            } else
                h[az(0x1c1)] = N[az(0x184)], P[az(0x183)] = Q[-0x1 * 0x26a9 + -0xd90 + 0x3439]['id'], R[ay(0x144) + az(0x18d)] = new S()[az(0x152)]();
        }
        if (J && J[az(0x1c5)]) {
            const a9 = {};
            a9[ay(0x17a)] = J[az(0x18f)]?.['id'];
            const aa = {};
            aa[ay(0x16f)] = a9, aa[az(0x19b)] = [N[ay(0x173)]];
            const ab = await Message_1[az(0x19e)][az(0x14e)](aa);
            if (N[az(0x179)](ab?.[ay(0x15b)]?.[ay(0x1c1)], N[ay(0x1b4)]) && N[az(0x140)](ab?.[az(0x15b)][az(0x13e) + 'e'], J[az(0x154)])) {
                if (N[ay(0x16e)](N[az(0x19d)], N[az(0x19d)]))
                    e = f[az(0x1c5)];
                else {
                    const ad = ab[az(0x15b)];
                    return ad[ay(0x1ae) + ay(0x13f)] = !![], ad;
                }
            }
        }
        const P = {
                [sequelize_1['Op']['or']]: [
                    N[ay(0x184)],
                    N[ay(0x14f)]
                ]
            }, Q = {};
        Q[az(0x1c1)] = P, Q[az(0x15d)] = H, Q[az(0x15c)] = F, Q[ay(0x180)] = I ? I['id'] : E['id'];
        const R = {};
        R[ay(0x161)] = Contact_1[az(0x19e)], R['as'] = N[az(0x14a)], R[ay(0x19b)] = [
            N[ay(0x148)],
            N[az(0x158)],
            {
                'association': N[ay(0x188)],
                'attributes': [
                    'id',
                    N[ay(0x169)]
                ]
            }
        ];
        const S = {};
        S[az(0x161)] = User_1[ay(0x19e)], S['as'] = N[az(0x14c)], S[az(0x141)] = [
            'id',
            N[az(0x169)]
        ];
        const T = {};
        T[ay(0x14d) + 'n'] = N[az(0x1c7)], T[az(0x141)] = [
            'id',
            N[az(0x169)],
            N[ay(0x1cf)]
        ];
        const U = {};
        U[ay(0x16f)] = Q, U[ay(0x19b)] = [
            R,
            S,
            T
        ];
        let V = await Ticket_1[az(0x19e)][az(0x14e)](U);
        if (V) {
            G = [
                N[az(0x15f)],
                N[ay(0x16b)],
                N[ay(0x19c)],
                N[ay(0x157)]
            ][az(0x1c4)](L) && N[az(0x1b8)](G, 0x3 * -0x59e + 0xa0a * 0x3 + -0x2 * 0x6a2) ? G += V[ay(0x142) + az(0x174)] : G;
            const ae = {};
            ae[ay(0x142) + ay(0x174)] = G, await V[ay(0x13c)](ae);
            const af = {};
            return af[ay(0x15d)] = H, af[az(0x159)] = N[az(0x1a1)], af[ay(0x17d)] = V, (0x21a9 + 0x5e6 + 0x1 * -0x278f, socketEmit_1[az(0x19e)])(af), V;
        }
        if (I) {
            const ag = {};
            ag[ay(0x180)] = I['id'], ag[az(0x15d)] = H, ag[ay(0x15c)] = F;
            const ah = {};
            ah[az(0x16f)] = ag, ah[ay(0x1c8)] = [[
                    N[az(0x1a3)],
                    N[az(0x171)]
                ]], ah[ay(0x19b)] = [
                {
                    'model': Contact_1[ay(0x19e)],
                    'as': N[ay(0x14a)],
                    'include': [
                        N[az(0x148)],
                        N[ay(0x158)],
                        {
                            'association': N[az(0x188)],
                            'attributes': [
                                'id',
                                N[az(0x169)]
                            ]
                        }
                    ]
                },
                {
                    'model': User_1[ay(0x19e)],
                    'as': N[ay(0x14c)],
                    'attributes': [
                        'id',
                        N[az(0x169)]
                    ]
                },
                {
                    'association': N[az(0x1c7)],
                    'attributes': [
                        'id',
                        N[ay(0x169)],
                        N[az(0x1cf)]
                    ]
                }
            ], V = await Ticket_1[ay(0x19e)][ay(0x14e)](ah);
            if (V) {
                const ai = {};
                ai[az(0x1c1)] = N[ay(0x14f)], ai[ay(0x183)] = null, ai[az(0x142) + ay(0x174)] = G, await V[ay(0x13c)](ai);
                const aj = {};
                return aj[az(0x15d)] = H, aj[az(0x159)] = N[ay(0x1a1)], aj[ay(0x17d)] = V, (0x1 * 0x15d1 + 0x293 * -0xe + 0x14b * 0xb, socketEmit_1[ay(0x19e)])(aj), V;
            }
        } else {
            const ak = {
                    [sequelize_1['Op']['in']]: [
                        N[ay(0x184)],
                        N[az(0x14f)]
                    ]
                }, al = {};
            al[az(0x1c1)] = ak, al[ay(0x15d)] = H, al[ay(0x15c)] = F, al[az(0x180)] = E['id'];
            const am = {};
            am[ay(0x16f)] = al, am[az(0x1c8)] = [[
                    N[ay(0x1a3)],
                    N[az(0x171)]
                ]], am[az(0x19b)] = [
                {
                    'model': Contact_1[ay(0x19e)],
                    'as': N[ay(0x14a)],
                    'include': [
                        N[az(0x148)],
                        N[ay(0x158)],
                        {
                            'association': N[az(0x188)],
                            'attributes': [
                                'id',
                                N[ay(0x169)]
                            ]
                        }
                    ]
                },
                {
                    'model': User_1[ay(0x19e)],
                    'as': N[ay(0x14c)],
                    'attributes': [
                        'id',
                        N[ay(0x169)]
                    ]
                },
                {
                    'association': N[az(0x1c7)],
                    'attributes': [
                        'id',
                        N[ay(0x169)],
                        N[az(0x1cf)]
                    ]
                }
            ], V = await Ticket_1[az(0x19e)][az(0x14e)](am);
            if (V) {
                const an = {};
                an[ay(0x1c1)] = N[az(0x14f)], an[az(0x183)] = null, an[az(0x142) + az(0x174)] = G, await V[az(0x13c)](an);
                const ao = {};
                return ao[ay(0x15d)] = H, ao[az(0x159)] = N[az(0x1a1)], ao[ay(0x17d)] = V, (0x1ea9 + -0x565 + 0x1 * -0x1944, socketEmit_1[az(0x19e)])(ao), V;
            }
        }
        const W = N[ay(0x179)]((await (0x4c7 * 0x5 + 0x1ffb + -0x37de, ListSettingsService_1[ay(0x19e)])(H))?.[ay(0x196)](ap => ap[az(0x18f)] === az(0x146) + az(0x15a) + 'ts')?.[ay(0x186)], N[ay(0x1ce)]) || ![], X = {};
        X[az(0x180)] = I ? I['id'] : E['id'], X[az(0x1c1)] = N[ay(0x14f)], X[ay(0x168)] = !!I, X[az(0x142) + ay(0x174)] = G, X[az(0x15c)] = F, X[az(0x15d)] = H, X[ay(0x18b)] = L;
        const Y = X;
        if (W && E['id']) {
            const ap = E, aq = await ap[az(0x1be)]();
            aq && aq[0x29c * -0x1 + -0x1c91 * -0x1 + 0x8a7 * -0x3]?.['id'] && (Y[az(0x1c1)] = N[az(0x184)], Y[az(0x183)] = aq[0xfff + 0x29 * 0xd4 + -0x13 * 0x2a1]['id'], Y[az(0x144) + az(0x18d)] = new Date()[ay(0x152)]());
        }
        if (J) {
            if (N[ay(0x1a0)](N[az(0x175)], N[az(0x175)])) {
                const as = d[ay(0x15b)];
                return as[ay(0x1ae) + ay(0x13f)] = !![], as;
            } else
                Y[az(0x13e) + 'e'] = await (-0x685 * 0x1 + -0x2e6 + 0x96b, VerifyContactBaileys_1[az(0x170) + az(0x14b)])(J);
        }
        const Z = await Ticket_1[ay(0x19e)][az(0x178)](Y), a0 = {};
        a0[ay(0x1b7)] = Z['id'], a0[ay(0x159)] = N[az(0x1a2)], await (-0x15d6 + 0x2a4 + -0x1332 * -0x1, CreateLogTicketService_1[az(0x19e)])(a0);
        (N[ay(0x1a4)](J, !O) || !Z[az(0x183)] || K) && (N[az(0x16e)](N[ay(0x149)], N[ay(0x149)]) ? e = f[ay(0x18f)][az(0x1c5)] : await (-0x2602 + 0x22cb + -0x337 * -0x1, CheckChatBotFlowWelcome_1[ay(0x19e)])(Z));
        const a1 = {};
        a1['id'] = Z['id'], a1[ay(0x15d)] = H, V = await (0x1 * -0x1e4f + -0xe8 * 0x4 + 0x21ef, ShowTicketService_1[az(0x19e)])(a1), V[az(0x13d) + 'ue'](N[az(0x153)], !![]);
        const a2 = {};
        return a2[ay(0x15d)] = H, a2[az(0x159)] = N[ay(0x1a1)], a2[ay(0x17d)] = V, (-0x4d0 + -0x68c + 0x1 * 0xb5c, socketEmit_1[az(0x19e)])(a2), V;
    };
exports[aw(0x19e)] = FindOrCreateTicketService;