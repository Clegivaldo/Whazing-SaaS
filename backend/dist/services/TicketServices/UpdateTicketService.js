'use strict';
const a3 = b, a4 = b;
(function (c, d) {
    const a1 = b, a2 = b, e = c();
    while (!![]) {
        try {
            const f = -parseInt(a1(0x176)) / (-0x185e + -0x335 * -0x7 + 0x1ec) * (parseInt(a2(0x198)) / (-0xa0b + -0x22a9 + 0x2cb6)) + parseInt(a1(0x18d)) / (0x202f + -0x3 * 0xc2 + -0x1de6) + -parseInt(a2(0x180)) / (0x21e4 * 0x1 + 0x6e3 + -0x1 * 0x28c3) + parseInt(a2(0x182)) / (0xdc * -0x17 + -0x29 * 0x27 + 0x341 * 0x8) + parseInt(a1(0x1c3)) / (0x2 * 0xad + -0x1 * 0xf97 + 0x3 * 0x4c1) * (parseInt(a2(0x1a3)) / (-0x2381 + -0x3 * 0xcb3 + 0x49a1)) + parseInt(a2(0x18b)) / (-0x39d + 0x2 * 0x133d + -0x22d5) + -parseInt(a2(0x169)) / (-0xd99 + -0x1c58 + 0x29fa);
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, -0x8a32a + 0x3aba1 * 0x1 + 0xf9c * 0xd3));
var __importDefault = this && this[a3(0x178) + a3(0x14d)] || function (c) {
    const a5 = a3;
    return c && c[a5(0x18e)] ? c : { 'default': c };
};
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (0x73a * 0x1 + -0x49 * 0x5a + 0x13b9);
        let h = e[f];
        return h;
    }, b(c, d);
}
const k = {};
k[a3(0x14c)] = !![], Object[a3(0x1a6) + a3(0x154)](exports, a4(0x18e), k);
function a() {
    const a8 = [
        'whatsapp',
        'gTicketSer',
        'BJUBn',
        'ontactOpen',
        'pending',
        'CxIfN',
        '38850MNbXDw',
        'model',
        'closedAt',
        'caLFn',
        '../../mode',
        'stepAutoRe',
        'queueId',
        'userId',
        'value',
        'fault',
        'associatio',
        'plyId',
        'Tickets',
        'tags',
        'ticket',
        'ticket:upd',
        'erty',
        'name',
        'receivedTr',
        'ence',
        'pWnVM',
        'attributes',
        'findOne',
        'oldUserId',
        'ERR_NO_TIC',
        '../../erro',
        'ansfer',
        'ers/CheckC',
        'startedAtt',
        'pVeNc',
        'rs/AppErro',
        'ers/SetTic',
        'KET_FOUND',
        'KWZZl',
        'YOpuO',
        'alMqC',
        'endanceAt',
        '7990209qTjsJJ',
        'MQhyY',
        'wallets',
        'HpUJT',
        'lacwM',
        'setDataVal',
        'default',
        'IHQts',
        'xWGFl',
        'hrafm',
        'closed',
        './CreateLo',
        'extraInfo',
        '4feKjNN',
        'transfered',
        '__importDe',
        'on:new',
        'dHsfA',
        'PdNST',
        'ls/Ticket',
        'AKWbI',
        'dXDiG',
        'close',
        '984848YgmIAi',
        'notificati',
        '4279520qNJUZn',
        'cqRdV',
        'reload',
        'include',
        'RRBhw',
        'Eoxvk',
        'XNxjs',
        'oldStatus',
        'Emit',
        '7691288SLVWrZ',
        'roEPw',
        '77289JrswTC',
        '__esModule',
        'open',
        'getTime',
        'ketMessage',
        'vice',
        'wxwBL',
        'isTransfer',
        'contact',
        'NHDEr',
        'update',
        '115136CVpdiA',
        'eobKU',
        'status',
        'ticketId',
        '../../help',
        'payload',
        'nxrFz',
        'hUvtL',
        'ate',
        'UhbrX',
        'isDeleted',
        '42kCooyt',
        'ls/User',
        'UIvlR',
        'defineProp',
        'lmQjN',
        'autoReplyI',
        'toBsd',
        'ls/Contact',
        'NNeAF',
        'tenantId',
        'NPFkq',
        'ers/socket',
        'uDWIf',
        'upNhf',
        'where',
        'EZSIw',
        'tKsup',
        'sAsRead',
        'xFgdq',
        'Azikv',
        'rpgZH',
        'type',
        'user',
        'WGvqs',
        'NlJcA',
        'pRkaD'
    ];
    a = function () {
        return a8;
    };
    return a();
}
const AppError_1 = __importDefault(require(a3(0x15d) + a3(0x162) + 'r')), CheckContactOpenTickets_1 = __importDefault(require(a3(0x19c) + a3(0x15f) + a4(0x1c0) + a3(0x150))), SetTicketMessagesAsRead_1 = __importDefault(require(a3(0x19c) + a4(0x163) + a3(0x191) + a3(0x1b4))), Contact_1 = __importDefault(require(a4(0x1c7) + a3(0x1aa))), Ticket_1 = __importDefault(require(a3(0x1c7) + a3(0x17c))), User_1 = __importDefault(require(a3(0x1c7) + a4(0x1a4))), socketEmit_1 = __importDefault(require(a4(0x19c) + a3(0x1ae) + a3(0x18a))), CreateLogTicketService_1 = __importDefault(require(a4(0x174) + a3(0x1be) + a4(0x192))), UpdateTicketService = async ({
        ticketData: s,
        ticketId: t,
        isTransference: u,
        userIdRequest: v
    }) => {
        const a6 = a4, a7 = a4, w = {};
        w[a6(0x1a5)] = a7(0x181) + a7(0x179), w[a6(0x1ab)] = a7(0x15c) + a7(0x164), w[a7(0x1a1)] = a6(0x195), w[a6(0x16d)] = a6(0x175), w[a6(0x16c)] = a7(0x151), w[a6(0x16a)] = a7(0x16b), w[a6(0x1bc)] = a6(0x155), w[a7(0x19f)] = a7(0x1b9), w[a6(0x1b7)] = a7(0x1bd), w[a7(0x17b)] = a7(0x1a2), w[a6(0x1bb)] = function (Q, R) {
            return Q !== R;
        }, w[a7(0x170)] = a7(0x1b5), w[a6(0x1ad)] = a6(0x158), w[a6(0x18c)] = function (Q, R) {
            return Q !== R;
        }, w[a6(0x1b3)] = a7(0x1c1), w[a7(0x19e)] = function (Q, R) {
            return Q === R;
        }, w[a7(0x1a7)] = function (Q, R) {
            return Q === R;
        }, w[a6(0x188)] = a7(0x173), w[a7(0x161)] = function (Q, R) {
            return Q === R;
        }, w[a7(0x1b6)] = a6(0x187), w[a6(0x1a9)] = a7(0x17f), w[a7(0x1c2)] = function (Q, R) {
            return Q === R;
        }, w[a7(0x17a)] = a7(0x196), w[a6(0x1c6)] = a7(0x166), w[a7(0x1b0)] = function (Q, R) {
            return Q === R;
        }, w[a6(0x1ba)] = a7(0x18f), w[a7(0x172)] = a7(0x17e), w[a6(0x17d)] = function (Q, R) {
            return Q === R;
        }, w[a7(0x1bf)] = a6(0x1af), w[a7(0x1b2)] = a7(0x199), w[a6(0x165)] = function (Q, R) {
            return Q === R;
        }, w[a6(0x193)] = function (Q, R) {
            return Q === R;
        }, w[a7(0x186)] = a7(0x177), w[a6(0x171)] = a6(0x156) + a7(0x15e), w[a6(0x183)] = a6(0x194) + a7(0x157), w[a6(0x167)] = a7(0x153) + a7(0x1a0);
        const x = w, {
                status: y,
                userId: z,
                tenantId: A,
                queueId: B
            } = s, C = {};
        C['id'] = t, C[a6(0x1ac)] = A;
        const D = {};
        D[a7(0x1c4)] = Contact_1[a6(0x16f)], D['as'] = x[a7(0x1a1)], D[a6(0x185)] = [
            x[a6(0x16d)],
            x[a6(0x16c)],
            {
                'association': x[a6(0x16a)],
                'attributes': [
                    'id',
                    x[a7(0x1bc)]
                ]
            }
        ];
        const E = {};
        E[a6(0x1c4)] = User_1[a6(0x16f)], E['as'] = x[a6(0x19f)], E[a7(0x159)] = [
            'id',
            x[a7(0x1bc)]
        ];
        const F = {};
        F[a6(0x14e) + 'n'] = x[a7(0x1b7)], F[a7(0x159)] = [
            'id',
            x[a6(0x1bc)],
            x[a7(0x17b)]
        ];
        const G = {};
        G[a6(0x1b1)] = C, G[a7(0x185)] = [
            D,
            E,
            F
        ];
        const H = await Ticket_1[a7(0x16f)][a7(0x15a)](G);
        if (!H) {
            if (x[a6(0x1bb)](x[a6(0x170)], x[a6(0x1ad)]))
                throw new AppError_1[(a6(0x16f))](x[a7(0x1ab)], -0xd44 * 0x1 + -0x175 * 0x5 + 0x1621 * 0x1);
            else
                D[a7(0x1c5)] = new E()[a7(0x190)]();
        }
        await (-0x826 + 0x19e0 + -0x11ba, SetTicketMessagesAsRead_1[a7(0x16f)])(H);
        const I = x[a7(0x18c)](H[a7(0x19a)], x[a6(0x1b3)]) && x[a6(0x19e)](s[a7(0x19a)], x[a6(0x1b3)]), J = H[a6(0x19a)], K = H[a6(0x1b9)]?.['id'];
        if (x[a6(0x1a7)](J, x[a7(0x188)])) {
            if (x[a6(0x161)](x[a6(0x1b6)], x[a7(0x1b6)]))
                await (0x26c1 * 0x1 + 0x2 * -0xc1a + -0xe8d * 0x1, CheckContactOpenTickets_1[a6(0x16f)])(H[a6(0x195)]['id']);
            else {
                const S = {};
                return S[a7(0x16f)] = j, F && G[a7(0x18e)] ? S : S;
            }
        }
        const L = x[a6(0x161)](y, x[a7(0x1a9)]) ? x[a6(0x188)] : y, M = {};
        M[a6(0x19a)] = L, M[a6(0x14a)] = B, M[a7(0x14b)] = z;
        const N = M;
        if (x[a6(0x1c2)](L, x[a6(0x188)])) {
            if (x[a6(0x1c2)](x[a7(0x17a)], x[a7(0x1c6)])) {
                const T = {};
                T[a6(0x1ac)] = F, T[a7(0x1b8)] = x[a7(0x1a5)], T[a6(0x19d)] = G, (-0x1d8 * -0x5 + 0x123 * 0x22 + -0x2fde, E[a6(0x16f)])(T);
            } else
                N[a7(0x1c5)] = new Date()[a7(0x190)]();
        }
        x[a7(0x1b0)](J, x[a6(0x1b3)]) && x[a7(0x161)](L, x[a6(0x1ba)]) && (x[a7(0x1c2)](x[a6(0x172)], x[a7(0x172)]) ? (N[a6(0x1a8) + 'd'] = null, N[a7(0x149) + a7(0x14f)] = null, N[a7(0x160) + a7(0x168)] = new Date()[a6(0x190)]()) : (F[a7(0x1a8) + 'd'] = null, G[a6(0x149) + a7(0x14f)] = null, M[a6(0x160) + a7(0x168)] = new j()[a6(0x190)]()));
        await H[a6(0x197)](N);
        if (x[a6(0x17d)](J, x[a7(0x1b3)]) && x[a7(0x1c2)](L, x[a7(0x1ba)])) {
            if (x[a7(0x1bb)](x[a6(0x1bf)], x[a6(0x1b2)])) {
                const U = {};
                U[a7(0x14b)] = v, U[a7(0x19b)] = t, U[a6(0x1b8)] = x[a6(0x1ba)], await (-0xcc7 + 0x638 + 0x68f, CreateLogTicketService_1[a7(0x16f)])(U);
            } else
                throw new C[(a6(0x16f))](x[a7(0x1ab)], -0x1 * 0x16b7 + 0x19ea * -0x1 + 0x3235);
        }
        if (x[a7(0x165)](L, x[a6(0x188)])) {
            const W = {};
            W[a6(0x14b)] = v, W[a7(0x19b)] = t, W[a6(0x1b8)] = x[a7(0x188)], await (0x1 * 0x2e + -0x177a + 0x174c, CreateLogTicketService_1[a6(0x16f)])(W);
        }
        if (x[a6(0x193)](J, x[a6(0x1ba)]) && x[a7(0x1a7)](L, x[a6(0x1b3)])) {
            const X = {};
            X[a6(0x14b)] = v, X[a6(0x19b)] = t, X[a6(0x1b8)] = x[a7(0x1b3)], await (-0x1fbc + 0xd4c + -0x24e * -0x8, CreateLogTicketService_1[a7(0x16f)])(X);
        }
        if (u) {
            const Y = {};
            Y[a7(0x14b)] = v, Y[a7(0x19b)] = t, Y[a7(0x1b8)] = x[a6(0x186)], await (0x6 * 0x8f + 0x1c74 + -0x1fce, CreateLogTicketService_1[a7(0x16f)])(Y);
            if (z) {
                const Z = {};
                Z[a6(0x14b)] = z, Z[a6(0x19b)] = t, Z[a6(0x1b8)] = x[a6(0x171)], await (0x1961 * 0x1 + -0x321 + 0x2c8 * -0x8, CreateLogTicketService_1[a6(0x16f)])(Z);
            }
        }
        await H[a6(0x184)]();
        u && await H[a7(0x16e) + 'ue'](x[a6(0x183)], !![]);
        if (I) {
            const a0 = {};
            a0[a7(0x1ac)] = A, a0[a6(0x1b8)] = x[a6(0x1a5)], a0[a7(0x19d)] = H, (-0xb08 + -0x265b + 0x1 * 0x3163, socketEmit_1[a6(0x16f)])(a0);
        }
        const O = {};
        O[a7(0x1ac)] = A, O[a6(0x1b8)] = x[a6(0x167)], O[a6(0x19d)] = H, (-0x4 * 0x151 + 0x1 * -0x11e7 + 0x1 * 0x172b, socketEmit_1[a7(0x16f)])(O);
        const P = {};
        return P[a7(0x152)] = H, P[a7(0x189)] = J, P[a6(0x15b)] = K, P;
    };
exports[a3(0x16f)] = UpdateTicketService;