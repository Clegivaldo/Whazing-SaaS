'use strict';
const E = b, F = b;
(function (c, d) {
    const C = b, D = b, e = c();
    while (!![]) {
        try {
            const f = parseInt(C(0x1e1)) / (0x23ca + 0x18fd + -0x3 * 0x1442) + parseInt(C(0x1c7)) / (0xbfd + -0x2388 + -0x1 * -0x178d) + parseInt(D(0x1c6)) / (0x9 * 0x18 + 0xbaa * -0x1 + 0x3b * 0x2f) * (parseInt(D(0x18c)) / (0x198e + -0x51c + -0x146e)) + -parseInt(D(0x1bc)) / (-0x1e64 + -0xa4d + 0x28b6) * (parseInt(C(0x1b0)) / (-0x29a + -0x21 * -0x33 + 0x3f3 * -0x1)) + -parseInt(C(0x1c5)) / (-0xe22 + 0x1 * -0xdfb + -0x709 * -0x4) + -parseInt(C(0x1ae)) / (-0x1f7 * 0x4 + 0x1ea2 + -0x16be) + -parseInt(D(0x1dc)) / (-0x3a7 + 0x1ff * 0xb + -0x1245) * (parseInt(D(0x1f7)) / (0x21c8 + -0x639 + -0x581 * 0x5));
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, -0x4f85f + 0x42fde + 0xc2e25));
var __importDefault = this && this[E(0x1a4) + F(0x1a1)] || function (c) {
    const G = E;
    return c && c[G(0x1cb)] ? c : { 'default': c };
};
function a() {
    const S = [
        'tedForMess',
        'defineProp',
        'fileId',
        'ERROR\x20DONW',
        'video',
        'sticker',
        'HaLWb',
        '341255tCDWnB',
        'public',
        'fWUVK',
        'getTime',
        'BWvMF',
        'pnzRM',
        'messageDat',
        'wcAqk',
        '../../util',
        '3035606useEMS',
        '462szQpnf',
        '901174oxZCJe',
        'data',
        'ERR_DOWNLO',
        'HtZUr',
        '__esModule',
        'JSmuz',
        'ksykX',
        'eSTYr',
        'ObJrb',
        'AD_MEDIA::',
        'type',
        'file_id',
        'update',
        'reply_to_m',
        'essage',
        'geService',
        'edited_mes',
        'hDZVh',
        'default',
        'LOAD',
        'tpAlM',
        '9xfyCTU',
        '\x20ID:\x20',
        'fileName',
        'sage',
        'audio',
        '1184879WMhLKa',
        'split',
        'tenantId',
        'sended',
        'lDamK',
        'oJGjr',
        'promisify',
        'file_name',
        'lQKgf',
        'telegram',
        'image/png',
        'axios',
        'SAS',
        'path',
        'VfRcm',
        'message',
        's/logger',
        'writeFile',
        'caption',
        'JhGxP',
        'createWrit',
        'erty',
        '2098070gWCkwg',
        'util',
        'ageId',
        'is_animate',
        'getFileLin',
        'image/webp',
        '../../help',
        'document',
        'text',
        'qMkHj',
        '../Message',
        '12928HcxbIs',
        'message_id',
        'uwXQo',
        'join',
        'photo',
        'ers/getQuo',
        'pipe',
        'SAD',
        'ezWTB',
        'error',
        'date',
        'tYMAN',
        'Services/C',
        'QMtEc',
        'WffBP',
        'SMUEE',
        'DqFDQ',
        'length',
        'toString',
        'QzXvU',
        'SAV',
        'fault',
        'logger',
        'getFile',
        '__importDe',
        'geYqU',
        'stream',
        'EIQVr',
        'mime_type',
        'GET',
        'reateMessa',
        'finish',
        'Uxoxr',
        'mimeType',
        '1574440wYKuBS',
        'XTBfb',
        '48OHbxLy',
        'received',
        'voice',
        'value',
        'eStream'
    ];
    a = function () {
        return S;
    };
    return a();
}
const u = {};
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (-0x2 * 0x12dc + 0x17 * -0x4c + 0x2e18);
        let h = e[f];
        return h;
    }, b(c, d);
}
u[F(0x1b3)] = !![], Object[F(0x1b6) + F(0x1f6)](exports, E(0x1cb), u);
const path_1 = require(E(0x1ee)), util_1 = require(F(0x1f8)), fs_1 = require('fs'), axios_1 = __importDefault(require(F(0x1ec))), CreateMessageService_1 = __importDefault(require(F(0x201) + F(0x198) + E(0x1aa) + E(0x1d6))), logger_1 = require(F(0x1c4) + F(0x1f1)), getQuotedForMessageId_1 = __importDefault(require(F(0x1fd) + F(0x191) + E(0x1b5) + F(0x1f9))), writeFileAsync = (-0xf0f + -0x1fc4 + -0x1 * -0x2ed3, util_1[F(0x1e7)])(fs_1[F(0x1f2)]), getMediaInfo = j => {
        const H = F, I = F, k = {};
        k[H(0x1d8)] = I(0x190), k[H(0x1a7)] = H(0x1b9), k[I(0x1cd)] = H(0x1e0), k[I(0x1f4)] = H(0x1b2), k[H(0x1ac)] = H(0x1ba), k[I(0x200)] = I(0x1fe), k[I(0x1c1)] = function (w, z) {
            return w - z;
        }, k[I(0x1c0)] = function (w, z) {
            return w == z;
        }, k[H(0x1cf)] = I(0x1eb), k[H(0x1e9)] = H(0x1fc);
        const l = k, m = j[H(0x190)] ? l[I(0x1d8)] : j[H(0x1b9)] ? l[H(0x1a7)] : j[H(0x1e0)] ? l[H(0x1cd)] : j[I(0x1b2)] ? l[I(0x1f4)] : j[I(0x1ba)] && !j[H(0x1ba)][I(0x1fa) + 'd'] ? l[I(0x1ac)] : l[H(0x200)], n = j[m], [o, p, q, r, s, t, v] = [
                m,
                n[H(0x1a8)] ? n[H(0x1a8)] : '',
                ![],
                null,
                n[I(0x1d2)] ? n[H(0x1d2)] : n[l[H(0x1c1)](n[H(0x19d)], 0x3b3 + 0x1cef + -0x20a1 * 0x1)][I(0x1d2)],
                j[H(0x1f3)] ? j[I(0x1f3)] : '',
                l[H(0x1c0)](m, l[H(0x1f4)])
            ];
        switch (m) {
        case l[H(0x1d8)]:
            const w = {};
            w[I(0x1d1)] = o, w[H(0x1ad)] = l[H(0x1cf)], w[H(0x193)] = q, w[I(0x1de)] = r, w[I(0x1b7)] = s, w[I(0x1f3)] = t, w[I(0x1a0)] = v;
            return w;
            break;
        case l[I(0x1a7)]:
            const x = {};
            x[H(0x1d1)] = o, x[I(0x1ad)] = p, x[I(0x193)] = q, x[H(0x1de)] = r, x[I(0x1b7)] = s, x[H(0x1f3)] = t, x[H(0x1a0)] = v;
            return x;
            break;
        case l[I(0x1cd)]:
            const y = {};
            y[H(0x1d1)] = o, y[H(0x1ad)] = p, y[I(0x193)] = q, y[H(0x1de)] = r, y[H(0x1b7)] = s, y[H(0x1f3)] = t, y[H(0x1a0)] = v;
            return y;
            break;
        case l[H(0x1f4)]:
            const z = {};
            z[H(0x1d1)] = o, z[I(0x1ad)] = p, z[H(0x193)] = q, z[I(0x1de)] = r, z[I(0x1b7)] = s, z[H(0x1f3)] = t, z[I(0x1a0)] = v;
            return z;
            break;
        case l[I(0x1ac)]:
            const A = {};
            A[I(0x1d1)] = o, A[H(0x1ad)] = l[I(0x1e9)], A[I(0x193)] = q, A[I(0x1de)] = r, A[H(0x1b7)] = s, A[H(0x1f3)] = t, A[H(0x1a0)] = v, A[H(0x1ed)] = !![];
            return A;
            break;
        default:
            const B = {};
            B[I(0x1d1)] = o, B[H(0x1ad)] = p, B[H(0x193)] = !![], B[H(0x1de)] = n[I(0x1e8)] ? n[I(0x1e8)] : null, B[I(0x1b7)] = s, B[H(0x1f3)] = t, B[H(0x1a0)] = v;
            return B;
            break;
        }
    }, downloadFile = async (c, d) => {
        const J = F, K = E, e = {
                'eSTYr': J(0x1b8) + K(0x1da),
                'VfRcm': function (g, h) {
                    return g(h);
                },
                'QMtEc': function (g, h) {
                    return g === h;
                },
                'tpAlM': K(0x1be),
                'XTBfb': J(0x1ab),
                'uwXQo': K(0x195),
                'tYMAN': K(0x1a9),
                'WffBP': J(0x1a6)
            }, f = await (-0x59 * 0x17 + -0xa7 + -0x36 * -0x29, axios_1[J(0x1d9)])({
                'url': c[K(0x19e)](),
                'method': e[K(0x197)],
                'responseType': e[K(0x19a)]
            });
        await new Promise((g, h) => {
            const L = K, N = K, i = {
                    'SMUEE': e[L(0x1ce)],
                    'ezWTB': function (j, k) {
                        const M = L;
                        return e[M(0x1ef)](j, k);
                    }
                };
            e[N(0x199)](e[N(0x1db)], e[L(0x1db)]) ? f[L(0x1c8)][L(0x192)]((-0x1218 + 0x1 * 0x2279 + -0x1061, fs_1[N(0x1f5) + N(0x1b4)])(d))['on'](e[L(0x1af)], async () => g(!![]))['on'](e[L(0x18e)], j => {
                const O = N, P = L;
                console[O(0x195)](i[O(0x19b)], j), i[P(0x194)](h, new Error(j));
            }) : e = f?.[L(0x1d7) + N(0x1df)];
        });
    }, VerifyMediaMessage = async (d, e, f, g) => {
        const Q = F, R = E, h = {
                'JSmuz': function (v, w) {
                    return v && w;
                },
                'QzXvU': function (v, w) {
                    return v(w);
                },
                'HtZUr': Q(0x1bd),
                'geYqU': function (v, w, x) {
                    return v(w, x);
                },
                'lDamK': function (v, w) {
                    return v(w);
                },
                'oJGjr': function (v, w) {
                    return v * w;
                },
                'DqFDQ': R(0x1e4),
                'HaLWb': R(0x1b1),
                'wcAqk': function (v, w) {
                    return v || w;
                }
            };
        let i, j = {};
        i = d?.[Q(0x1f0)], j = d?.[Q(0x1d3)];
        h[Q(0x1cc)](!i, j) && (i = j?.[Q(0x1d7) + R(0x1df)]);
        const k = await h[Q(0x19f)](getMediaInfo, i), l = await d[R(0x1ea)][R(0x1a3)](k[Q(0x1b7)]);
        if (!l) {
            logger_1[Q(0x1a2)][R(0x195)](R(0x1c9) + R(0x1d0) + R(0x1dd) + i[R(0x18d)]);
            return;
        }
        const m = k[R(0x1ad)][R(0x1e2)]('/')[0x241c + 0x135e + 0xb * -0x50b][R(0x1e2)](';')[0xf81 + -0x18c6 + 0x945], n = l[R(0x1d2)] + '_' + new Date()[Q(0x1bf)]() + '.' + m, o = (0x1 * -0x364 + -0xffe + 0x1 * 0x1362, path_1[R(0x18f)])(__dirname, '..', '..', '..', h[R(0x1ca)], n), p = await d[R(0x1ea)][R(0x1fb) + 'k'](k[Q(0x1b7)]);
        await h[R(0x1a5)](downloadFile, p, o);
        let q;
        if (i?.[R(0x1d4) + Q(0x1d5)]?.[Q(0x18d)]) {
            const v = await (0x1 * 0xd55 + -0xa1 + 0xc * -0x10f, getQuotedForMessageId_1[Q(0x1d9)])(i[R(0x1d4) + Q(0x1d5)][R(0x18d)], f[R(0x1e3)]);
            q = v?.['id'] || undefined;
        }
        const r = {
            'messageId': h[R(0x1e5)](String, i?.[Q(0x18d)]),
            'ticketId': f['id'],
            'contactId': e ? undefined : g['id'],
            'body': i[R(0x1ff)] || i[Q(0x1f3)] || n,
            'fromMe': e,
            'read': e,
            'mediaUrl': n,
            'mediaType': k[R(0x1ad)][Q(0x1e2)]('/')[0x4 * 0xaf + 0x28 * 0x9b + -0x1af4],
            'quotedMsgId': q,
            'timestamp': h[R(0x1e6)](+i[Q(0x196)], 0x1730 + 0x2 * -0x3d + -0x12ce),
            'status': e ? h[R(0x19c)] : h[R(0x1bb)]
        };
        await f[Q(0x1d3)]({
            'lastMessage': i[Q(0x1ff)] || i[R(0x1f3)] || n,
            'lastMessageAt': new Date()[Q(0x1bf)](),
            'answered': h[R(0x1c3)](e, ![])
        });
        const s = {};
        s[Q(0x1c2) + 'a'] = r, s[Q(0x1e3)] = f[Q(0x1e3)];
        const t = await (-0x191 * -0xe + -0x19b2 + 0x3c4, CreateMessageService_1[Q(0x1d9)])(s);
        return t;
    };
exports[F(0x1d9)] = VerifyMediaMessage;