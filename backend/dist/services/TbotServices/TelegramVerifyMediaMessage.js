'use strict';
function _0x3de2(_0x52e015, _0x2ba38d) {
    const _0xb98c7f = _0x11d9();
    return _0x3de2 = function (_0x392452, _0x221ace) {
        _0x392452 = _0x392452 - (0x1043 + 0x2 * -0xa3 + -0xdd8);
        let _0x37afff = _0xb98c7f[_0x392452];
        return _0x37afff;
    }, _0x3de2(_0x52e015, _0x2ba38d);
}
const _0x502194 = _0x3de2;
(function (_0x1519f3, _0x1f50dc) {
    const _0x17d25d = _0x3de2, _0x4f1e86 = _0x1519f3();
    while (!![]) {
        try {
            const _0x3c38b8 = -parseInt(_0x17d25d(0x17f)) / (0x106d * 0x1 + 0x1 * 0x1b9d + -0x2c09) * (parseInt(_0x17d25d(0x189)) / (0x1164 + 0x3 * -0x885 + -0x1 * -0x82d)) + -parseInt(_0x17d25d(0x175)) / (-0x23f4 + -0x2fb * 0x4 + 0x2fe3) * (parseInt(_0x17d25d(0x16d)) / (-0xd1e * -0x1 + -0x126b + -0x551 * -0x1)) + parseInt(_0x17d25d(0x162)) / (-0x288 * -0x6 + 0x2 * 0x885 + -0x2035) + parseInt(_0x17d25d(0x187)) / (-0x10e6 + -0x20 * -0x10 + 0xbf * 0x14) + parseInt(_0x17d25d(0x151)) / (-0x25f6 + -0xf71 + 0x356e * 0x1) * (-parseInt(_0x17d25d(0x130)) / (0x1991 + 0x1dd5 + -0x375e)) + parseInt(_0x17d25d(0x140)) / (0xa85 + -0x1319 + 0x13b * 0x7) + -parseInt(_0x17d25d(0x132)) / (0xada + -0x1521 + 0xa51);
            if (_0x3c38b8 === _0x1f50dc)
                break;
            else
                _0x4f1e86['push'](_0x4f1e86['shift']());
        } catch (_0x40a247) {
            _0x4f1e86['push'](_0x4f1e86['shift']());
        }
    }
}(_0x11d9, 0x3 * -0x3f457 + -0x1 * -0x46f84 + 0xf0a72));
var __importDefault = this && this[_0x502194(0x17a) + _0x502194(0x18c)] || function (_0x2b2797) {
    const _0x17d53e = _0x502194;
    return _0x2b2797 && _0x2b2797[_0x17d53e(0x170)] ? _0x2b2797 : { 'default': _0x2b2797 };
};
const _0x22e007 = {};
_0x22e007[_0x502194(0x17d)] = !![], Object[_0x502194(0x13d) + _0x502194(0x135)](exports, _0x502194(0x170), _0x22e007);
function _0x11d9() {
    const _0x432c1a = [
        'length',
        'fileName',
        'sended',
        'defineProp',
        'cElWP',
        'kKhbf',
        '5217984fkEzrg',
        'getTime',
        'SCPyB',
        'sticker',
        'type',
        'tedForMess',
        'BXXAX',
        'SYeQj',
        'is_animate',
        'GET',
        'photo',
        'caption',
        'WWtGa',
        'mime_type',
        'geService',
        'stream',
        'createWrit',
        '11998xqBiQG',
        'tenantId',
        'path',
        'toString',
        'yvvCx',
        'reateMessa',
        '../../help',
        'writeFile',
        'file_id',
        'SAS',
        'WSFvG',
        'mDZpk',
        'eStream',
        'reply_to_m',
        'promisify',
        'document',
        'finish',
        '4967425WHnJCR',
        'ageId',
        'received',
        'pipe',
        'update',
        'uKuaG',
        'public',
        'default',
        'yfbOc',
        'Services/C',
        'SAV',
        '872kOdKTG',
        'fileId',
        'TQBXl',
        '__esModule',
        'XrNkT',
        'image/webp',
        'getFile',
        'ERR_DOWNLO',
        '12417YzJxxX',
        'AD_MEDIA::',
        'telegram',
        'essage',
        'jZnPg',
        '__importDe',
        'join',
        'kRGuh',
        'value',
        'ZLQnb',
        '409753wfQcvV',
        'axios',
        's/logger',
        'UEBZX',
        'sage',
        'util',
        'SAD',
        'messageDat',
        '5325294JspSzz',
        'QhpBC',
        '2tixUzk',
        'edited_mes',
        'logger',
        'fault',
        'error',
        '\x20ID:\x20',
        'mimeType',
        'gGNJt',
        'message_id',
        'ifwVk',
        'ERROR\x20DONW',
        'voice',
        'jcVfL',
        'video',
        'file_name',
        'yZsNF',
        'fiyYG',
        'Edlcd',
        'image/png',
        'LOAD',
        'ihtRo',
        'dEIqS',
        'split',
        '../Message',
        'message',
        '../../util',
        '872fFTBAU',
        'getFileLin',
        '4630000KDYKXX',
        'data',
        'date',
        'erty',
        'text',
        'audio',
        'ers/getQuo',
        'JBxOT'
    ];
    _0x11d9 = function () {
        return _0x432c1a;
    };
    return _0x11d9();
}
const path_1 = require(_0x502194(0x153)), util_1 = require(_0x502194(0x184)), fs_1 = require('fs'), axios_1 = __importDefault(require(_0x502194(0x180))), CreateMessageService_1 = __importDefault(require(_0x502194(0x12d) + _0x502194(0x16b) + _0x502194(0x156) + _0x502194(0x14e))), logger_1 = require(_0x502194(0x12f) + _0x502194(0x181)), getQuotedForMessageId_1 = __importDefault(require(_0x502194(0x157) + _0x502194(0x138) + _0x502194(0x145) + _0x502194(0x163))), writeFileAsync = (0x51 * -0x5e + -0x15e4 * -0x1 + 0x7da, util_1[_0x502194(0x15f)])(fs_1[_0x502194(0x158)]), getMediaInfo = _0x20f64a => {
        const _0x2dd6e9 = _0x502194, _0x5e4c74 = {};
        _0x5e4c74[_0x2dd6e9(0x13f)] = _0x2dd6e9(0x14a), _0x5e4c74[_0x2dd6e9(0x142)] = _0x2dd6e9(0x196), _0x5e4c74[_0x2dd6e9(0x171)] = _0x2dd6e9(0x137), _0x5e4c74[_0x2dd6e9(0x13e)] = _0x2dd6e9(0x194), _0x5e4c74[_0x2dd6e9(0x139)] = _0x2dd6e9(0x143), _0x5e4c74[_0x2dd6e9(0x126)] = _0x2dd6e9(0x160), _0x5e4c74[_0x2dd6e9(0x14c)] = function (_0x2f66a6, _0xea7a91) {
            return _0x2f66a6 - _0xea7a91;
        }, _0x5e4c74[_0x2dd6e9(0x155)] = function (_0x5b8834, _0x3460b5) {
            return _0x5b8834 == _0x3460b5;
        }, _0x5e4c74[_0x2dd6e9(0x17e)] = _0x2dd6e9(0x128), _0x5e4c74[_0x2dd6e9(0x192)] = _0x2dd6e9(0x172);
        const _0xbb450 = _0x5e4c74, _0x10801c = _0x20f64a[_0x2dd6e9(0x14a)] ? _0xbb450[_0x2dd6e9(0x13f)] : _0x20f64a[_0x2dd6e9(0x196)] ? _0xbb450[_0x2dd6e9(0x142)] : _0x20f64a[_0x2dd6e9(0x137)] ? _0xbb450[_0x2dd6e9(0x171)] : _0x20f64a[_0x2dd6e9(0x194)] ? _0xbb450[_0x2dd6e9(0x13e)] : _0x20f64a[_0x2dd6e9(0x143)] && !_0x20f64a[_0x2dd6e9(0x143)][_0x2dd6e9(0x148) + 'd'] ? _0xbb450[_0x2dd6e9(0x139)] : _0xbb450[_0x2dd6e9(0x126)], _0x12009c = _0x20f64a[_0x10801c], [_0x487a24, _0x2f26fe, _0x5935ea, _0x1e9e54, _0x338a5e, _0x3d58af, _0x16a6c2] = [
                _0x10801c,
                _0x12009c[_0x2dd6e9(0x14d)] ? _0x12009c[_0x2dd6e9(0x14d)] : '',
                ![],
                null,
                _0x12009c[_0x2dd6e9(0x159)] ? _0x12009c[_0x2dd6e9(0x159)] : _0x12009c[_0xbb450[_0x2dd6e9(0x14c)](_0x12009c[_0x2dd6e9(0x13a)], 0x85c + -0x1b2 + -0x37 * 0x1f)][_0x2dd6e9(0x159)],
                _0x20f64a[_0x2dd6e9(0x14b)] ? _0x20f64a[_0x2dd6e9(0x14b)] : '',
                _0xbb450[_0x2dd6e9(0x155)](_0x10801c, _0xbb450[_0x2dd6e9(0x13e)])
            ];
        switch (_0x10801c) {
        case _0xbb450[_0x2dd6e9(0x13f)]:
            const _0x28393d = {};
            _0x28393d[_0x2dd6e9(0x144)] = _0x487a24, _0x28393d[_0x2dd6e9(0x18f)] = _0xbb450[_0x2dd6e9(0x17e)], _0x28393d[_0x2dd6e9(0x185)] = _0x5935ea, _0x28393d[_0x2dd6e9(0x13b)] = _0x1e9e54, _0x28393d[_0x2dd6e9(0x16e)] = _0x338a5e, _0x28393d[_0x2dd6e9(0x14b)] = _0x3d58af, _0x28393d[_0x2dd6e9(0x16c)] = _0x16a6c2;
            return _0x28393d;
            break;
        case _0xbb450[_0x2dd6e9(0x142)]:
            const _0x19aa45 = {};
            _0x19aa45[_0x2dd6e9(0x144)] = _0x487a24, _0x19aa45[_0x2dd6e9(0x18f)] = _0x2f26fe, _0x19aa45[_0x2dd6e9(0x185)] = _0x5935ea, _0x19aa45[_0x2dd6e9(0x13b)] = _0x1e9e54, _0x19aa45[_0x2dd6e9(0x16e)] = _0x338a5e, _0x19aa45[_0x2dd6e9(0x14b)] = _0x3d58af, _0x19aa45[_0x2dd6e9(0x16c)] = _0x16a6c2;
            return _0x19aa45;
            break;
        case _0xbb450[_0x2dd6e9(0x171)]:
            const _0x7a4e7e = {};
            _0x7a4e7e[_0x2dd6e9(0x144)] = _0x487a24, _0x7a4e7e[_0x2dd6e9(0x18f)] = _0x2f26fe, _0x7a4e7e[_0x2dd6e9(0x185)] = _0x5935ea, _0x7a4e7e[_0x2dd6e9(0x13b)] = _0x1e9e54, _0x7a4e7e[_0x2dd6e9(0x16e)] = _0x338a5e, _0x7a4e7e[_0x2dd6e9(0x14b)] = _0x3d58af, _0x7a4e7e[_0x2dd6e9(0x16c)] = _0x16a6c2;
            return _0x7a4e7e;
            break;
        case _0xbb450[_0x2dd6e9(0x13e)]:
            const _0x410f2a = {};
            _0x410f2a[_0x2dd6e9(0x144)] = _0x487a24, _0x410f2a[_0x2dd6e9(0x18f)] = _0x2f26fe, _0x410f2a[_0x2dd6e9(0x185)] = _0x5935ea, _0x410f2a[_0x2dd6e9(0x13b)] = _0x1e9e54, _0x410f2a[_0x2dd6e9(0x16e)] = _0x338a5e, _0x410f2a[_0x2dd6e9(0x14b)] = _0x3d58af, _0x410f2a[_0x2dd6e9(0x16c)] = _0x16a6c2;
            return _0x410f2a;
            break;
        case _0xbb450[_0x2dd6e9(0x139)]:
            const _0xb85790 = {};
            _0xb85790[_0x2dd6e9(0x144)] = _0x487a24, _0xb85790[_0x2dd6e9(0x18f)] = _0xbb450[_0x2dd6e9(0x192)], _0xb85790[_0x2dd6e9(0x185)] = _0x5935ea, _0xb85790[_0x2dd6e9(0x13b)] = _0x1e9e54, _0xb85790[_0x2dd6e9(0x16e)] = _0x338a5e, _0xb85790[_0x2dd6e9(0x14b)] = _0x3d58af, _0xb85790[_0x2dd6e9(0x16c)] = _0x16a6c2, _0xb85790[_0x2dd6e9(0x15a)] = !![];
            return _0xb85790;
            break;
        default:
            const _0x330fb4 = {};
            _0x330fb4[_0x2dd6e9(0x144)] = _0x487a24, _0x330fb4[_0x2dd6e9(0x18f)] = _0x2f26fe, _0x330fb4[_0x2dd6e9(0x185)] = !![], _0x330fb4[_0x2dd6e9(0x13b)] = _0x12009c[_0x2dd6e9(0x197)] ? _0x12009c[_0x2dd6e9(0x197)] : null, _0x330fb4[_0x2dd6e9(0x16e)] = _0x338a5e, _0x330fb4[_0x2dd6e9(0x14b)] = _0x3d58af, _0x330fb4[_0x2dd6e9(0x16c)] = _0x16a6c2;
            return _0x330fb4;
            break;
        }
    }, downloadFile = async (_0x4affbe, _0x3736b5) => {
        const _0x3956f7 = _0x502194, _0x1d45df = {
                'gGNJt': _0x3956f7(0x193) + _0x3956f7(0x129),
                'yfbOc': function (_0x1578df, _0x42bb14) {
                    return _0x1578df(_0x42bb14);
                },
                'TQBXl': _0x3956f7(0x161),
                'ihtRo': _0x3956f7(0x18d),
                'UEBZX': _0x3956f7(0x149),
                'jZnPg': _0x3956f7(0x14f)
            }, _0x5ba8d2 = await (0x1594 + 0x1 * 0x4ff + 0x1 * -0x1a93, axios_1[_0x3956f7(0x169)])({
                'url': _0x4affbe[_0x3956f7(0x154)](),
                'method': _0x1d45df[_0x3956f7(0x182)],
                'responseType': _0x1d45df[_0x3956f7(0x179)]
            });
        await new Promise((_0x54f1df, _0x30bd94) => {
            const _0x5970f3 = _0x3956f7, _0x2e3e1b = {
                    'dEIqS': _0x1d45df[_0x5970f3(0x190)],
                    'uKuaG': function (_0x52eda0, _0x12bbb8) {
                        const _0x331ec3 = _0x5970f3;
                        return _0x1d45df[_0x331ec3(0x16a)](_0x52eda0, _0x12bbb8);
                    }
                };
            _0x5ba8d2[_0x5970f3(0x133)][_0x5970f3(0x165)]((-0x2280 + -0x1670 + 0x71e * 0x8, fs_1[_0x5970f3(0x150) + _0x5970f3(0x15d)])(_0x3736b5))['on'](_0x1d45df[_0x5970f3(0x16f)], async () => _0x54f1df(!![]))['on'](_0x1d45df[_0x5970f3(0x12a)], _0x898dc => {
                const _0x18c149 = _0x5970f3;
                console[_0x18c149(0x18d)](_0x2e3e1b[_0x18c149(0x12b)], _0x898dc), _0x2e3e1b[_0x18c149(0x167)](_0x30bd94, new Error(_0x898dc));
            });
        });
    }, VerifyMediaMessage = async (_0xdca4d2, _0x1a4ecc, _0x95d4f6, _0x59fe5a) => {
        const _0xb01df9 = _0x502194, _0x508ec9 = {
                'QhpBC': function (_0x409631, _0x4d857b) {
                    return _0x409631 && _0x4d857b;
                },
                'WSFvG': function (_0x15f86e, _0xc462b4) {
                    return _0x15f86e(_0xc462b4);
                },
                'BXXAX': _0xb01df9(0x168),
                'yZsNF': function (_0x35f1d1, _0x35b211, _0x11bcd9) {
                    return _0x35f1d1(_0x35b211, _0x11bcd9);
                },
                'kRGuh': function (_0x26f357, _0xc75795) {
                    return _0x26f357(_0xc75795);
                },
                'Edlcd': function (_0x1d134c, _0x109efa) {
                    return _0x1d134c * _0x109efa;
                },
                'mDZpk': _0xb01df9(0x13c),
                'jcVfL': _0xb01df9(0x164),
                'SYeQj': function (_0x270b6c, _0x40a329) {
                    return _0x270b6c || _0x40a329;
                }
            };
        let _0x18b249, _0x2f75d3 = {};
        _0x18b249 = _0xdca4d2?.[_0xb01df9(0x12e)], _0x2f75d3 = _0xdca4d2?.[_0xb01df9(0x166)];
        _0x508ec9[_0xb01df9(0x188)](!_0x18b249, _0x2f75d3) && (_0x18b249 = _0x2f75d3?.[_0xb01df9(0x18a) + _0xb01df9(0x183)]);
        const _0x3082fc = await _0x508ec9[_0xb01df9(0x15b)](getMediaInfo, _0x18b249), _0x5ca2a2 = await _0xdca4d2[_0xb01df9(0x177)][_0xb01df9(0x173)](_0x3082fc[_0xb01df9(0x16e)]);
        if (!_0x5ca2a2) {
            logger_1[_0xb01df9(0x18b)][_0xb01df9(0x18d)](_0xb01df9(0x174) + _0xb01df9(0x176) + _0xb01df9(0x18e) + _0x18b249[_0xb01df9(0x191)]);
            return;
        }
        const _0x4e5979 = _0x3082fc[_0xb01df9(0x18f)][_0xb01df9(0x12c)]('/')[-0x1 * 0x453 + -0x2033 * -0x1 + -0x1bdf][_0xb01df9(0x12c)](';')[0x1 * 0x1ad5 + 0xe * 0xc2 + 0x429 * -0x9], _0x448b76 = _0x5ca2a2[_0xb01df9(0x159)] + '_' + new Date()[_0xb01df9(0x141)]() + '.' + _0x4e5979, _0x5efb05 = (0x2063 + -0x43 * -0x75 + -0x3f02, path_1[_0xb01df9(0x17b)])(__dirname, '..', '..', '..', _0x508ec9[_0xb01df9(0x146)], _0x448b76), _0x48628a = await _0xdca4d2[_0xb01df9(0x177)][_0xb01df9(0x131) + 'k'](_0x3082fc[_0xb01df9(0x16e)]);
        await _0x508ec9[_0xb01df9(0x125)](downloadFile, _0x48628a, _0x5efb05);
        let _0x41ca70;
        if (_0x18b249?.[_0xb01df9(0x15e) + _0xb01df9(0x178)]?.[_0xb01df9(0x191)]) {
            const _0x162a17 = await (0x1 * 0x38a + -0x9 * 0x83 + 0x15 * 0xd, getQuotedForMessageId_1[_0xb01df9(0x169)])(_0x18b249[_0xb01df9(0x15e) + _0xb01df9(0x178)][_0xb01df9(0x191)], _0x95d4f6[_0xb01df9(0x152)]);
            _0x41ca70 = _0x162a17?.['id'] || undefined;
        }
        const _0x4159ab = {
            'messageId': _0x508ec9[_0xb01df9(0x17c)](String, _0x18b249?.[_0xb01df9(0x191)]),
            'ticketId': _0x95d4f6['id'],
            'contactId': _0x1a4ecc ? undefined : _0x59fe5a['id'],
            'body': _0x18b249[_0xb01df9(0x136)] || _0x18b249[_0xb01df9(0x14b)] || _0x448b76,
            'fromMe': _0x1a4ecc,
            'read': _0x1a4ecc,
            'mediaUrl': _0x448b76,
            'mediaType': _0x3082fc[_0xb01df9(0x18f)][_0xb01df9(0x12c)]('/')[-0xd6e + 0x3 * -0x9e5 + -0x27 * -0x11b],
            'quotedMsgId': _0x41ca70,
            'timestamp': _0x508ec9[_0xb01df9(0x127)](+_0x18b249[_0xb01df9(0x134)], -0x6a * 0x39 + -0x1c9f * 0x1 + 0x3821),
            'status': _0x1a4ecc ? _0x508ec9[_0xb01df9(0x15c)] : _0x508ec9[_0xb01df9(0x195)]
        };
        await _0x95d4f6[_0xb01df9(0x166)]({
            'lastMessage': _0x18b249[_0xb01df9(0x136)] || _0x18b249[_0xb01df9(0x14b)] || _0x448b76,
            'lastMessageAt': new Date()[_0xb01df9(0x141)](),
            'answered': _0x508ec9[_0xb01df9(0x147)](_0x1a4ecc, ![])
        });
        const _0x29daea = {};
        _0x29daea[_0xb01df9(0x186) + 'a'] = _0x4159ab, _0x29daea[_0xb01df9(0x152)] = _0x95d4f6[_0xb01df9(0x152)];
        const _0x4f53f2 = await (-0x4 * 0x872 + 0xb19 + 0x16af, CreateMessageService_1[_0xb01df9(0x169)])(_0x29daea);
        return _0x4f53f2;
    };
exports[_0x502194(0x169)] = VerifyMediaMessage;