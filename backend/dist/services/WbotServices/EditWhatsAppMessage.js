'use strict';const v=b,w=b;(function(c,d){const t=b,u=b,e=c();while(!![]){try{const f=parseInt(t(0x124))/0x1+parseInt(t(0x13c))/0x2+-parseInt(t(0x143))/0x3*(parseInt(u(0x12a))/0x4)+-parseInt(u(0x12f))/0x5*(-parseInt(u(0x122))/0x6)+-parseInt(t(0x142))/0x7*(parseInt(u(0x127))/0x8)+parseInt(u(0x125))/0x9+-parseInt(u(0x130))/0xa;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xeae61));function b(c,d){const e=a();return b=function(f,g){f=f-0x121;let h=e[f];return h;},b(c,d);}function a(){const z=['vRPsd','147DDFMoc','333159PXceJD','quotedMsg','getTime','dataJson','update','createdAt','findOne','648kvrOGQ','ERR_EDITING_WAPP_MSG','774377DqjuMc','10947150GPDsWD','contact','42568QjIamt','No\x20message\x20found\x20with\x20this\x20ID.','__importDefault','64okFXSZ','FfTDJ','../../errors/AppError','__esModule','../../models/Message','18210mIaGku','1949550BsCfxW','fvyjx','default','ERR_FINDING_MSG','../../helpers/GetTicketWbotBaileys','../../models/Ticket','key','edited','defineProperty','chat:update','../../helpers/socketEmit','SAvit','1323252jQePIi','parse','ticket','sendMessage','ticketId'];a=function(){return z;};return a();}var __importDefault=this&&this[v(0x129)]||function(c){return c&&c['__esModule']?c:{'default':c};};Object[v(0x138)](exports,v(0x12d),{'value':!![]});const AppError_1=__importDefault(require(v(0x12c))),GetTicketWbotBaileys_1=__importDefault(require(w(0x134))),Message_1=__importDefault(require(v(0x12e))),Ticket_1=__importDefault(require(v(0x135))),socketEmit_1=__importDefault(require(v(0x13a))),EditWhatsAppMessage=async({messageId:c,tenantId:d,body:e})=>{const x=v,y=v;let f;try{if('bEMei'===x(0x141))return g&&h['__esModule']?i:{'default':j};else{f=await Message_1[y(0x132)][y(0x121)]({'where':{'messageId':c,'tenantId':d},'include':[{'model':Ticket_1[y(0x132)],'as':'ticket','include':[y(0x126)]}]});if(!f)throw new AppError_1[(x(0x132))]('No\x20message\x20found\x20with\x20this\x20ID.');}}catch(l){if(y(0x13b)===x(0x13b))throw new AppError_1['default']('ERR_FINDING_MSG');else throw new d['default'](x(0x123));}const {ticket:g}=f,h=await(0x0,GetTicketWbotBaileys_1['default'])(g),i=JSON[x(0x13d)](f[y(0x146)]),j=i[x(0x136)]['remoteJid'];try{if(x(0x12b)!=='FfTDJ')throw new d[(y(0x132))](y(0x133));else{await h[y(0x13f)](j,{'text':e,'edit':i['key']},{});const o=(new Date()[x(0x145)]()-new Date(f[x(0x148)])['getTime']())/0xea60;if(o>0xa){if(x(0x131)===x(0x131))throw new AppError_1[(y(0x132))](y(0x123));else throw new d['default'](x(0x128));}if(f[y(0x137)]!==null)throw new AppError_1[(y(0x132))](x(0x123));await f[x(0x147)]({'edited':e});const {ticket:p}=f;(0x0,socketEmit_1['default'])({'tenantId':p['tenantId'],'type':x(0x139),'payload':f});const q=await Message_1[x(0x132)][x(0x121)]({'where':{'messageId':c,'tenantId':d},'include':[{'model':Ticket_1['default'],'as':y(0x13e),'include':['contact']},{'model':Message_1['default'],'as':x(0x144),'include':['contact'],'where':{'tenantId':d},'required':![]}]});return{'ticketId':q[x(0x140)],'message':q};}}catch(s){throw new AppError_1[(y(0x132))](y(0x123));}};exports['default']=EditWhatsAppMessage;