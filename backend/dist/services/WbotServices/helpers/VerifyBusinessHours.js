'use strict';function b(c,d){const e=a();return b=function(f,g){f=f-0x14a;let h=e[f];return h;},b(c,d);}const q=b,r=b;(function(c,d){const o=b,p=b,e=c();while(!![]){try{const f=parseInt(o(0x14b))/0x1+parseInt(p(0x15c))/0x2*(-parseInt(o(0x169))/0x3)+-parseInt(o(0x153))/0x4*(-parseInt(p(0x14c))/0x5)+parseInt(o(0x163))/0x6*(parseInt(o(0x16d))/0x7)+parseInt(o(0x154))/0x8*(parseInt(o(0x157))/0x9)+parseInt(p(0x166))/0xa+-parseInt(o(0x162))/0xb;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x80c0a));var __importDefault=this&&this[q(0x161)]||function(c){return c&&c['__esModule']?c:{'default':c};};Object['defineProperty'](exports,r(0x15f),{'value':!![]});const date_fns_1=require(r(0x15b)),ShowBusinessHoursAndMessageService_1=__importDefault(require(r(0x16e))),CreateMessageSystemService_1=__importDefault(require('../../MessageServices/CreateMessageSystemService')),database_1=__importDefault(require('../../../database')),sequelize_1=require(q(0x167)),verifyBusinessHours=async(c,d)=>{const s=q,t=r;let e=!![];if(d[s(0x15d)]!==t(0x155)&&!c['fromMe']&&!d[t(0x14d)]){const f=await(0x0,ShowBusinessHoursAndMessageService_1[s(0x14f)])({'tenantId':d[t(0x150)]}),g=(0x0,date_fns_1['fromUnixTime'])(c[s(0x158)]),h=f[s(0x15e)][t(0x170)](k=>k[t(0x151)]===g[t(0x16a)]());if(!h)return e;if(h[t(0x14e)]==='O')return e;const i=(0x0,date_fns_1[s(0x159)])(g,{'start':(0x0,date_fns_1['parse'])(h['hr1'],'HH:mm',new Date()),'end':(0x0,date_fns_1[t(0x168)])(h[s(0x14a)],s(0x16c),new Date())}),j=(0x0,date_fns_1[s(0x159)])(g,{'start':(0x0,date_fns_1[t(0x168)])(h[t(0x160)],'HH:mm',new Date()),'end':(0x0,date_fns_1[t(0x168)])(h[s(0x164)],'HH:mm',new Date())});if(h[s(0x14e)]==='C'||!i&&!j){let k=t(0x15a)+d['id']+s(0x16f)+d['id']+'\x20and\x20\x22fromMe\x22\x20=\x20true\x20)';const l=await database_1[s(0x14f)][s(0x172)](k,{'type':sequelize_1['QueryTypes']['SELECT']}),m=''+f[t(0x16b)];if(l[t(0x173)]>0x0&&l[0x0][s(0x165)]==m)return![];e=![];const n={'body':f[s(0x16b)],'fromMe':!![],'read':!![],'sendType':t(0x152),'tenantId':d[s(0x150)]};await(0x0,CreateMessageSystemService_1[s(0x14f)])({'msg':n,'tenantId':d['tenantId'],'ticket':d,'sendType':n[s(0x171)],'status':t(0x156)});}}return e;};exports[r(0x14f)]=verifyBusinessHours;function a(){const u=['status','businessHours','__esModule','hr3','__importDefault','18035941DebOPT','5670UsDzGV','hr4','body','7901090nVEgVa','sequelize','parse','109128xxKaFa','getDay','messageBusinessHours','HH:mm','539cebWsn','../../TenantServices/ShowBusinessHoursAndMessageService','\x0a\x20\x20\x20\x20\x20\x20and\x20m.\x22fromMe\x22\x20=\x20true\x20\x0a\x20\x20\x20\x20\x20\x20and\x20m.\x22createdAt\x22\x20=\x20(select\x20max(m2.\x22createdAt\x22)\x20from\x20\x22Messages\x22\x20m2\x20where\x20m2.\x22ticketId\x22\x20=\x20','find','sendType','query','length','hr2','692284gmwTaj','1280cNAESe','isGroup','type','default','tenantId','day','bot','12032RVgyqS','72geLztC','closed','pending','605691eHGWZl','messageTimestamp','isWithinInterval','select\x20m.body,\x20m.\x22createdAt\x22\x20,\x20m.\x22updatedAt\x22\x20,\x20m.\x22ticketId\x22\x0a\x20\x20\x20\x20\x20\x20from\x20\x22Messages\x22\x20m,\x20\x22Tickets\x22\x20t\x20\x0a\x20\x20\x20\x20\x20\x20where\x20t.id\x20=\x20m.\x22ticketId\x22\x20\x0a\x20\x20\x20\x20\x20\x20and\x20t.id\x20=\x20','date-fns','42geXRZn'];a=function(){return u;};return a();}