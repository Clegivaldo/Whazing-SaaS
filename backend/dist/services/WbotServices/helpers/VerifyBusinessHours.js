'use strict';const q=b,s=b;(function(c,d){const o=b,p=b,e=c();while(!![]){try{const f=-parseInt(o(0x9b))/0x1+-parseInt(o(0x94))/0x2*(parseInt(o(0x92))/0x3)+-parseInt(o(0x83))/0x4*(parseInt(p(0x9d))/0x5)+parseInt(o(0x97))/0x6+-parseInt(o(0x8e))/0x7*(-parseInt(o(0x84))/0x8)+-parseInt(o(0x77))/0x9+-parseInt(o(0x9f))/0xa*(-parseInt(o(0x8a))/0xb);if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xe8fe9));function b(c,d){const e=a();return b=function(f,g){f=f-0x76;let h=e[f];return h;},b(c,d);}function a(){const v=['body','businessHours','default','date-fns','hr3','fromUnixTime','select\x20m.body,\x20m.\x22createdAt\x22\x20,\x20m.\x22updatedAt\x22\x20,\x20m.\x22ticketId\x22\x0a\x20\x20\x20\x20\x20\x20from\x20\x22Messages\x22\x20m,\x20\x22Tickets\x22\x20t\x20\x0a\x20\x20\x20\x20\x20\x20where\x20t.id\x20=\x20m.\x22ticketId\x22\x20\x0a\x20\x20\x20\x20\x20\x20and\x20t.id\x20=\x20','994248kiZkeE','8HxcDxL','messageTimestamp','getDay','messageBusinessHours','hr2','SELECT','1330835InWZLO','tenantId','\x0a\x20\x20\x20\x20\x20\x20and\x20m.\x22fromMe\x22\x20=\x20true\x20\x0a\x20\x20\x20\x20\x20\x20and\x20m.\x22createdAt\x22\x20=\x20(select\x20max(m2.\x22createdAt\x22)\x20from\x20\x22Messages\x22\x20m2\x20where\x20m2.\x22ticketId\x22\x20=\x20','isGroup','13219773IQnCUr','\x20and\x20\x22fromMe\x22\x20=\x20true\x20)','query','sequelize','539643byEHbc','__esModule','2uKiIUc','bot','length','52746HxCGqy','isWithinInterval','type','fromMe','1727344DCePGh','defineProperty','25sRwdmm','HH:mm','310YwoYmr','__importDefault','../../MessageServices/CreateMessageSystemService','status','13891365oHYVyr','QueryTypes','../../TenantServices/ShowBusinessHoursAndMessageService','parse','pending'];a=function(){return v;};return a();}var __importDefault=this&&this[q(0xa0)]||function(c){const r=q;return c&&c[r(0x93)]?c:{'default':c};};Object[q(0x9c)](exports,q(0x93),{'value':!![]});const date_fns_1=require(q(0x7f)),ShowBusinessHoursAndMessageService_1=__importDefault(require(q(0x79))),CreateMessageSystemService_1=__importDefault(require(q(0xa1))),database_1=__importDefault(require('../../../database')),sequelize_1=require(q(0x91)),verifyBusinessHours=async(c,d)=>{const t=q,u=q;let e=!![];if(d[t(0x76)]!=='closed'&&!c[u(0x9a)]&&!d[t(0x8d)]){const f=await(0x0,ShowBusinessHoursAndMessageService_1[t(0x7e)])({'tenantId':d[u(0x8b)]}),g=(0x0,date_fns_1[u(0x81)])(c[t(0x85)]),h=f[t(0x7d)]['find'](k=>k['day']===g[t(0x86)]());if(!h)return e;if(h[t(0x99)]==='O')return e;const i=(0x0,date_fns_1[t(0x98)])(g,{'start':(0x0,date_fns_1['parse'])(h['hr1'],u(0x9e),new Date()),'end':(0x0,date_fns_1[t(0x7a)])(h[u(0x88)],u(0x9e),new Date())}),j=(0x0,date_fns_1[u(0x98)])(g,{'start':(0x0,date_fns_1['parse'])(h[t(0x80)],t(0x9e),new Date()),'end':(0x0,date_fns_1[t(0x7a)])(h['hr4'],'HH:mm',new Date())});if(h[u(0x99)]==='C'||!i&&!j){let k=t(0x82)+d['id']+t(0x8c)+d['id']+u(0x8f);const l=await database_1['default'][u(0x90)](k,{'type':sequelize_1[t(0x78)][t(0x89)]}),m=''+f[t(0x87)];if(l[t(0x96)]>0x0&&l[0x0][u(0x7c)]==m)return![];e=![];const n={'body':f[u(0x87)],'fromMe':!![],'read':!![],'sendType':t(0x95),'tenantId':d['tenantId']};await(0x0,CreateMessageSystemService_1['default'])({'msg':n,'tenantId':d['tenantId'],'ticket':d,'sendType':n['sendType'],'status':u(0x7b)});}}return e;};exports[s(0x7e)]=verifyBusinessHours;