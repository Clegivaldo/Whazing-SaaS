'use strict';const o=b,p=b;function a(){const s=['error','9554136IlMKXw','__importDefault','isCampaignMessage','29024kxHtUN','text','isFarewellMessage','3683385lzrJap','./VerifyMessage360','579FlnqDz','logger','2010330ERrULL','messages','contacts','waba','1902523FLoZkG','../WhatsappService/ShowWhatsAppService','default','../../utils/logger','28056ZXglMC','./VerifyContactWaba360','7756980CBnbzI','../TicketServices/FindOrCreateTicketService','53CaPAzU'];a=function(){return s;};return a();}(function(c,d){const m=b,n=b,e=c();while(!![]){try{const f=parseInt(m(0x93))/0x1*(parseInt(m(0x8f))/0x2)+-parseInt(n(0x9d))/0x3*(parseInt(m(0x98))/0x4)+-parseInt(n(0x9f))/0x5+parseInt(n(0x91))/0x6+-parseInt(n(0x8b))/0x7+parseInt(m(0x95))/0x8+-parseInt(m(0x9b))/0x9;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0xb662d));function b(c,d){const e=a();return b=function(f,g){f=f-0x8b;let h=e[f];return h;},b(c,d);}var __importDefault=this&&this[o(0x96)]||function(c){return c&&c['__esModule']?c:{'default':c};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const logger_1=require(p(0x8e)),FindOrCreateTicketService_1=__importDefault(require(p(0x92))),ShowWhatsAppService_1=__importDefault(require(p(0x8c))),VerifyContactWaba360_1=__importDefault(require(p(0x90))),VerifyMediaMessage360_1=__importDefault(require('./VerifyMediaMessage360')),VerifyMessage360_1=__importDefault(require(p(0x9c))),HandleMessage360=async(c,d)=>{return new Promise((e,f)=>{((async()=>{const q=b,r=b;let g,h;const i=0x1;try{g=await(0x0,ShowWhatsAppService_1[q(0x8d)])({'id':d}),h=await(0x0,VerifyContactWaba360_1[q(0x8d)])(c[r(0xa1)][0x0],g['tenantId']);const j={...c[r(0xa0)][0x0],'fromMe':![],'message_id':c[r(0xa0)][0x0]['id']},k=await(0x0,FindOrCreateTicketService_1[q(0x8d)])({'contact':h,'whatsappId':g['id'],'unreadMessages':i,'tenantId':g['tenantId'],'msg':j,'channel':r(0xa2)});if(k?.[q(0x97)]){e();return;}if(k?.[r(0x9a)]){e();return;}j['type']!==q(0x99)?await(0x0,VerifyMediaMessage360_1[q(0x8d)])(g,j,k,h):await(0x0,VerifyMessage360_1['default'])(j,k,h),e();}catch(l){logger_1[q(0x9e)][r(0x94)](l),f(l);}})());});};exports['default']=HandleMessage360;