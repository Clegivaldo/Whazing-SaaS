'use strict';function a(){const t=['default','2057356QjfjOw','update','../../errors/AppError','../../utils/logger','__esModule','5iZGhhs','UrlWabaWebHook','1751442YrJVpP','StartWaba360','env','./Waba360SendMessagesSystem','3BSxSCj','ERROR_CONNECT_WABA_360:\x20','tenantId','emit','3612174TxljAU','./SetWebHookUrl','getIO','ConexÃ£o\x20Waba\x20360\x20iniciada\x20|\x20Empresa:\x20','11688849XNNhfy','tokenAPI','2357092DFomYp','CONNECTED','ERROR:\x20checkMessages\x20Tenant:\x20','5170136UZbXOR','logger','OPENING','CHECK_INTERVAL','39242GnmCUA','__importDefault'];a=function(){return t;};return a();}const m=b,o=b;function b(c,d){const e=a();return b=function(f,g){f=f-0xaa;let h=e[f];return h;},b(c,d);}(function(c,d){const k=b,l=b,e=c();while(!![]){try{const f=-parseInt(k(0xaf))/0x1*(-parseInt(l(0xc0))/0x2)+parseInt(l(0xab))/0x3+-parseInt(k(0xb9))/0x4+-parseInt(l(0xc8))/0x5*(parseInt(l(0xb3))/0x6)+parseInt(k(0xc3))/0x7+-parseInt(l(0xbc))/0x8+parseInt(l(0xb7))/0x9;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x611d1));var __importDefault=this&&this[m(0xc1)]||function(c){const n=m;return c&&c[n(0xc7)]?c:{'default':c};};Object['defineProperty'](exports,m(0xc7),{'value':!![]}),exports[o(0xac)]=void 0x0;const AppError_1=__importDefault(require(o(0xc5))),socket_1=require('../../libs/socket'),logger_1=require(o(0xc6)),SetWebHookUrl_1=__importDefault(require(m(0xb4))),Waba360SendMessagesSystem_1=__importDefault(require(m(0xae))),checkingWaba360={},checkMessagesWaba360=async c=>{const p=o,q=o;if(checkingWaba360[c['tenantId']])return;checkingWaba360[c[p(0xb1)]]=!![];try{await(0x0,Waba360SendMessagesSystem_1[q(0xc2)])(c);}catch(d){logger_1[p(0xbd)]['error'](p(0xbb)+c[p(0xb1)]+'::',d);}checkingWaba360[c['tenantId']]=![];},StartWaba360=async c=>{const r=m,s=m,d=(0x0,socket_1[r(0xb5)])();await c[r(0xc4)]({'status':r(0xbe)}),d[s(0xb2)](c[r(0xb1)]+':whatsappSession',{'action':'update','session':c});try{await(0x0,SetWebHookUrl_1[s(0xc2)])({'url':c[s(0xaa)]||'','apiKey':c[s(0xb8)]});const e='';logger_1['logger']['info'](r(0xb6)+c[s(0xb1)]),await c['update']({'status':r(0xba),'number':e}),setInterval(checkMessagesWaba360,+(process[s(0xad)][s(0xbf)]||0x1388),c),d[r(0xb2)](c[r(0xb1)]+':whatsappSession',{'action':r(0xc4),'session':c});}catch(f){logger_1[r(0xbd)]['error']('SetWebHookUrl\x20360\x20|\x20Error:\x20'+f),await c['update']({'status':'DISCONNECTED'}),d[s(0xb2)](c[r(0xb1)]+':whatsappSession',{'action':r(0xc4),'session':c});throw new AppError_1[(r(0xc2))](r(0xb0)+f,0x194);}};exports[o(0xac)]=StartWaba360;