'use strict';function b(c,d){const e=a();return b=function(f,g){f=f-0x1d1;let h=e[f];return h;},b(c,d);}const m=b,o=b;(function(c,d){const k=b,l=b,e=c();while(!![]){try{const f=parseInt(k(0x1e4))/0x1+-parseInt(l(0x1f0))/0x2+parseInt(l(0x1d1))/0x3+parseInt(l(0x1e7))/0x4*(-parseInt(k(0x1e5))/0x5)+-parseInt(k(0x1d7))/0x6+-parseInt(k(0x1d4))/0x7*(parseInt(l(0x1da))/0x8)+parseInt(l(0x1eb))/0x9;if(f===d)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(a,0x9dc24));function a(){const t=['CHECK_INTERVAL','../../errors/AppError','../../utils/logger','CONNECTED','1717842CsMKHT','UrlWabaWebHook','ERROR_CONNECT_WABA_360:\x20','__importDefault','emit','2311407vKMneL','../../libs/socket','env','33733aUccTB','ConexÃ£o\x20Waba\x20360\x20iniciada\x20|\x20Empresa:\x20','OPENING','4959456KnBIHn','StartWaba360','ERROR:\x20checkMessages\x20Tenant:\x20','1496jFgqjH','logger','__esModule','defineProperty',':whatsappSession','./Waba360SendMessagesSystem','DISCONNECTED','SetWebHookUrl\x20360\x20|\x20Error:\x20','update','error','633704qFeulH','2776805lIjInB','default','8hHBKKS','tokenAPI','info','tenantId','26454411vtptGC'];a=function(){return t;};return a();}var __importDefault=this&&this[m(0x1f3)]||function(c){const n=m;return c&&c[n(0x1dc)]?c:{'default':c};};Object[o(0x1dd)](exports,'__esModule',{'value':!![]}),exports['StartWaba360']=void 0x0;const AppError_1=__importDefault(require(o(0x1ed))),socket_1=require(o(0x1d2)),logger_1=require(m(0x1ee)),SetWebHookUrl_1=__importDefault(require('./SetWebHookUrl')),Waba360SendMessagesSystem_1=__importDefault(require(m(0x1df))),checkingWaba360={},checkMessagesWaba360=async c=>{const p=o,q=o;if(checkingWaba360[c[p(0x1ea)]])return;checkingWaba360[c[p(0x1ea)]]=!![];try{await(0x0,Waba360SendMessagesSystem_1[p(0x1e6)])(c);}catch(d){logger_1[p(0x1db)][p(0x1e3)](p(0x1d9)+c[p(0x1ea)]+'::',d);}checkingWaba360[c[p(0x1ea)]]=![];},StartWaba360=async c=>{const r=m,s=m,d=(0x0,socket_1['getIO'])();await c[r(0x1e2)]({'status':s(0x1d6)}),d[r(0x1f4)](c['tenantId']+s(0x1de),{'action':s(0x1e2),'session':c});try{await(0x0,SetWebHookUrl_1[r(0x1e6)])({'url':c[s(0x1f1)]||'','apiKey':c[s(0x1e8)]});const e='';logger_1[r(0x1db)][s(0x1e9)](r(0x1d5)+c[s(0x1ea)]),await c[s(0x1e2)]({'status':s(0x1ef),'number':e}),setInterval(checkMessagesWaba360,+(process[r(0x1d3)][s(0x1ec)]||0x1388),c),d['emit'](c[s(0x1ea)]+':whatsappSession',{'action':r(0x1e2),'session':c});}catch(f){logger_1['logger'][s(0x1e3)](r(0x1e1)+f),await c['update']({'status':s(0x1e0)}),d['emit'](c['tenantId']+r(0x1de),{'action':'update','session':c});throw new AppError_1['default'](r(0x1f2)+f,0x194);}};exports[o(0x1d8)]=StartWaba360;